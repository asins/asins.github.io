<!DOCTYPE html><html lang="en"><head><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="Description" content="A single-page Rust resource for people who like high information density."><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=2"><title>Rust 语言备忘清单</title><link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEVklEQVR4AWJwL/AZUDzqgFEHAKgrxwB3ni2I1s+2bdu2bdu2bdu2bds21rY9THLf3EzWu+9vfThJptNddcb/PQGagTRhG1CIf4tb0VXejArm3xtQfDM2J/nLBNRNaMXFXKpshYewAT2kTXAVN+FyxAaM57GILcgvrEUdlvpTBJwnIYVWUsp6KJKJ6/GOC4V1+GnYCJLWxkdchRfqGggRK7CajxQflT8kIC5HRmkVXDlYCw1RV4MYYbmFJbExLNMRFsLJsBhfhUW4+XsE9OLFmCLNxyBhMYJMkWULYhMxLw6zdaS5IFoIEmfjjTwLfTnnNwnwodcWudMiDozDLAsz4jAtBlN1RA3S1oiTcfpXC8gz0MMwF7OEGXDSfscLFabEYGIcJlgYb2EcyKCNS2PxwDAFs5QxqPHLAlOwXLdOODCKMQkwMj7icE1iFIhGg9SRaJKoAF/p4aNQSRmJuXJigcxQkDyEAzmcty0MBBkt/wmDLQxk9DFxAALUfuil9kHhBAX4tpFG4gUHR4Uyg2MHmqblp5cLutC66kkopC9IGsDhSchrTVfa3DwPuXXTx4S+sZF6g6i/JtMHaxI9BWbDQXqg2b5fbMQeoC8rBtAnO1cTkqehvTX00Hut0tJ3G0dT3ZYdaGpRTbKPPpeRuuso/Lsb/EM7o2CCAnxo1J74yIvZVuwZGw4j7XtYuUxUtGwFAkCLSulj+6qCchUqRizVKx+I+Ch0ttBJR+kAMnSE0dAJ16R2KBlLQO6GclzOYb7tQeGdLSFdYmAZ+9QE1DSTzrulw8lh32LyaJmEeuUCddD41DiJuUxsHw1vB7UGebUAkSajdoCn1B4DowSkjpjH4WonfDtfAQcuV4KXW3NY8eTwdogKfN8IdL0a6H7tpOSzZ7bJ1TOUPAIlo/WeJfSufhIz1k2i1/i10tfJ7RF4pzq2HS+Lp6HtcI9zYwnwg0ez2s6HKKgNOh8ujf1aURNjBzxh84c14fSwDhTb+iDXvkVNX66cJhuPCPppF0AOrsEUJBnpy/Ft5Ncxg3kveS6vYRm5A0StsPOxMkkmnquEnlrHd618f4K3IUtofHlQA+V4AV8w2p68D2sL16AWkHw3jydHe0+Tlateztg4BpC7dyhFGIkcnt5R/bpmNXo3hxzQGu6c5d8KbTYWRJ4jZTBUE2nLYxGdkSXBu4Df5yxBHbHuYEmU2l0UWXlyRDusDmqJEO+xtcnmxmXTD8dgipRwcA0lJx/ZfCoCT6wKcG2anFggsBXmRBZFZmnZp5ROaPCL7wK+JpSOaBhzjPfEsR6CucB2YityPLnNaG3va7T6bOXnfnEfOUxqQXyKrOrD07oxesXNVDqjpsaYX/Uy4tMR81aJ5H0t1PpUB1c/N0zl6nB0o+QbrJDjT9vvH9vlW/6lMnZ9qYv/rfSsJYM8NjPf+TDIgQo7qrQJLy2bIP789eczD5+9u3H22n1LUNSNtorJxaMOGHUAAL89B017ixdoAAAAAElFTkSuQmCC"><style>@font-face{font-family:Open Sans;src:url(/fonts/OpenSans-Light.woff2) format("woff2");font-weight:300;font-style:normal;font-display:swap}@font-face{font-family:Open Sans;src:url(/fonts/OpenSans-LightItalic.woff2) format("woff2");font-weight:300;font-style:italic;font-display:swap}@font-face{font-family:Open Sans;src:url(/fonts/OpenSans-Regular.woff2) format("woff2");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:Open Sans;src:url(/fonts/OpenSans-Italic.woff2) format("woff2");font-weight:400;font-style:italic;font-display:swap}@font-face{font-family:Open Sans;src:url(/fonts/OpenSans-Semibold.woff2) format("woff2");font-weight:600;font-style:normal;font-display:swap}@font-face{font-family:Open Sans;src:url(/fonts/OpenSans-SemiboldItalic.woff2) format("woff2");font-weight:600;font-style:italic;font-display:swap}@font-face{font-family:Open Sans;src:url(/fonts/OpenSans-Bold.woff2) format("woff2");font-weight:700;font-style:normal;font-display:swap}@font-face{font-family:Open Sans;src:url(/fonts/OpenSans-BoldItalic.woff2) format("woff2");font-weight:700;font-style:italic;font-display:swap}@font-face{font-family:Open Sans;src:url(/fonts/OpenSans-ExtraBold.woff2) format("woff2");font-weight:800;font-style:normal;font-display:swap}@font-face{font-family:Open Sans;src:url(/fonts/OpenSans-ExtraBoldItalic.woff2) format("woff2");font-weight:800;font-style:italic;font-display:swap}@font-face{font-family:Fira Code;src:url(fonts/FiraCode-Light.woff2) format("woff2");font-weight:300;font-style:normal}@font-face{font-family:Fira Code;src:url(fonts/FiraCode-Regular.woff2) format("woff2");font-weight:400;font-style:normal}@font-face{font-family:Fira Code;src:url(fonts/FiraCode-Medium.woff2) format("woff2");font-weight:500;font-style:normal}@font-face{font-family:Fira Code;src:url(fonts/FiraCode-SemiBold.woff2) format("woff2");font-weight:600;font-style:normal}@font-face{font-family:Fira Code;src:url(fonts/FiraCode-Bold.woff2) format("woff2");font-weight:700;font-style:normal}@font-face{font-family:Fira Code VF;src:url(fonts/FiraCode-VF.woff2) format("woff2-variations");font-weight:300 700;font-style:normal}/*! normalize.css v7.0.0 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15}body{margin:0}article,aside,footer,header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figcaption,figure,main{display:block}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent;-webkit-text-decoration-skip:objects}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}dfn{font-style:italic}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{display:inline-block;vertical-align:baseline}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details,menu{display:block}summary{display:list-item}canvas{display:inline-block}[hidden],template{display:none}*{box-sizing:border-box}body,html{height:100%}body{text-rendering:optimizeLegibility;font-family:Open Sans,sans-serif}@media (prefers-color-scheme:light){body{background-color:#fff;color:#000}}@media (prefers-color-scheme:dark){body{background-color:#222;color:#fff}}body.day-mode{background-color:#fff;color:#000}body.night-mode{background-color:#222;color:#fff}h1,h2{margin-bottom:10px}h1,h2,h3{margin-top:30px}h3{margin-bottom:5px}footer{text-align:center;color:grey;font-size:9px}footer:after{content:" ";display:block;width:1px;height:20px}.page{padding-bottom:20px}.page__content{font-size:1.6rem;word-wrap:break-word;line-height:1.5;position:relative;left:0;max-width:800px;margin:0 auto;padding:0 15px 40px}.page__content a{color:#4183c4;text-decoration:none}.page__content a:hover{text-decoration:underline}.page__content hr{height:1px;padding:0;margin:.4em 0 2.4em;overflow:hidden;background-color:#e7e7e7;border:none}.page__content pre{padding:1rem;font-size:14px}.page__content pre span{white-space:pre-wrap}.page__content blockquote{margin:0 0 .85em;padding:10px 10px 1px;border-radius:3px}.page__content code{display:inline-block;vertical-align:middle;padding:.1em .3em;border-radius:3px;color:#6e6b5e;background:#f1f1f1;font-family:Fira Code,Consolas,Ubuntu Mono,Menlo,DejaVu Sans Mono,monospace;font-size:80%}.page__content iframe{border:0}.page__content table{width:100%;margin:0 auto;border-collapse:collapse;border-color:#ccc}.page__content table thead th{font-weight:700;border-bottom:1px solid #bababa}.page__content table thead td{font-weight:700;border:none}.page__content table td{padding:3px 5px 3px 20px}.page__content p{margin-top:0;margin-bottom:.85em}.day-mode .page__content{color:#333}.day-mode .page__content blockquote{background-color:#e1f3ff;border:1px solid #d1e3ef}.day-mode .page__content table thead{background:#ccc}.day-mode .page__content table tbody tr:nth-child(2n){background:#f7f7f7}.night-mode .page__content{color:#ccc}.night-mode .page__content blockquote{background-color:#00243b;border:1px solid #00344b}.night-mode .page__content table thead{background:#333}.night-mode .page__content table tbody tr:nth-child(2n){background:#2e2e2e}@media screen and (max-width:600px){.page{width:100%;left:0}.hide_on_small{display:none}}@media screen and (max-width:650px){html{font-size:7px}.cheats>table tr td:first-child{width:150px}}@media screen and (min-width:650px) and (max-width:1050px){html{font-size:9px}fixed-2-column>table tr td:first-child,fixed-3-column>table tr td:first-child{width:235px}fixed-2-column.extra-wide>table tr td:first-child,fixed-3-column.extra-wide>table tr td:first-child{width:300px}fixed-3-column>table tr td:nth-child(2){text-align:left;width:40px;padding-left:5px}}@media screen and (min-width:1050px){html{font-size:9px}.book-content{transition:0s;transform:scale(1.05);transform-origin:top left}fixed-2-column>table tr td:first-child,fixed-3-column>table tr td:first-child{width:235px}fixed-2-column.extra-wide>table tr td:first-child,fixed-3-column.extra-wide>table tr td:first-child{width:300px}fixed-3-column>table tr td:nth-child(2){text-align:left;width:40px;padding-left:5px}}@media print{html{font-size:7px}.target,feedback,noprint{display:none}}tabs{font-size:0;margin:5px 0;display:block}tabs>tab{display:inline}tabs>tab>panel{display:inline-block;overflow:hidden;position:relative;height:0;width:0}tabs>tab>panel>div{box-sizing:border-box;display:block;padding:20px;border-radius:0 5px 5px 5px;float:left;font-size:10pt;margin-top:-1px;width:100%}tabs>tab>label{display:inline-block;font-size:1.3rem;left:1px;margin-left:-1px;padding:10px;position:relative;vertical-align:bottom;cursor:pointer;border-radius:8px 3px 0 0}tabs>tab>label .token.class-name,tabs>tab>label .token.keyword{color:#000}tabs>tab>input[type=radio]{clip:rect(0 0 0 0);height:1px;opacity:0;position:fixed;width:1px;z-index:-1}tabs>tab>input[type=radio]:checked+label{border-bottom-width:0;padding-bottom:11px;z-index:1}tabs>tab>input[type=radio]:checked~panel{display:inline}.day-mode tabs>tab>panel>div{background-color:#fff;border:1px solid #ccc}.day-mode tabs>tab>label{background:#eee;border:1px solid #ccc}.day-mode tabs>tab>label code span.token.class-name{color:inherit}.day-mode tabs>tab>input[type=radio]:checked+label{background:#fff}.night-mode tabs>tab>panel>div{background-color:#222;border:1px solid #333}.night-mode tabs>tab>label{background:#333;border:1px solid #333}.night-mode tabs>tab>label code span.token.class-name{color:inherit}.night-mode tabs>tab>input[type=radio]:checked+label{background:#666}tabs:after{clear:both;content:"";display:table}zoo-xxx{font-size:0;margin:5px 0;display:block;background-color:red}zoo-xxx>tab{display:inline}zoo-xxx>tab>panel{display:inline;display:inline-block;overflow:hidden;position:relative;height:0;width:0}zoo-xxx>tab>panel>div{box-sizing:border-box;display:block;padding:20px;float:left;font-size:10pt;margin-top:-1px;width:100%}zoo-xxx>tab>label{display:inline-block;font-size:1.3rem;left:1px;margin-left:-1px;padding:10px;position:relative;vertical-align:bottom;cursor:pointer}zoo-xxx>tab>label .token.class-name,zoo-xxx>tab>label .token.keyword{color:#000}zoo-xxx>tab>input[type=radio]{clip:rect(0 0 0 0);height:1px;opacity:0;position:fixed;width:1px;z-index:-1}zoo-xxx>tab>input[type=radio]:checked+label{border-bottom-width:0;padding-bottom:11px;z-index:1}zoo-xxx>tab>input[type=radio]:checked~panel{display:inline}zoo-xxx:after{clear:both;content:"";display:table}datum{box-sizing:border-box;display:inline-block;border-collapse:collapse;vertical-align:top;margin-bottom:25px;font-size:14px}datum name{font-size:15px;text-align:left;display:block}datum .nogrow{position:absolute}datum .hidden{visibility:hidden}datum visual{text-align:center;background-color:#f2f2f2;border:1px solid #a9a9a9;border-radius:5px;display:block;padding:5px}datum visual payload{display:inline-block;width:80px;background-color:#f5f5f5;border:1px dashed #000;border-radius:5px}datum visual.zst{opacity:.4;border-style:dashed}datum visual.unsafe{position:relative;top:-3px;border:3px solid red}datum note{font-size:9px;display:inline-block}datum byte{width:15px}datum byte,datum word{display:inline-block;border:1px dashed #000;border-radius:5px;height:28px}datum word{width:30px}datum zoom{display:block;border:1px solid grey;position:relative;text-align:center;width:106%;left:-3%;top:-2px;z-index:-100;font-size:12px}datum description{display:block;word-wrap:break-word;font-size:10px}datum bitgroup{border:1px solid #000;padding:2px}datum bitgroup bit{margin:0;padding:0}datum memory-entry{display:inline-block;vertical-align:top;position:relative;width:80px}datum memory-entry memory{display:inline-block;padding:5px 5px 14px;font-size:120%;text-align:center;position:relative;border-radius:5px;border:1px dashed grey;width:80%;left:5%;top:5px;z-index:100;margin-bottom:10px;opacity:.4}datum memory-entry memory.extrapadding{padding-bottom:15px}datum memory-entry memory.heap{background-color:#c6dbe7}datum memory-entry memory.anymem{background-color:#fdecdc}datum memory-entry memory.static,datum memory-entry memory.static-vtable{background-color:#deb887}datum memory-entry memory.anymem:after{content:"(任意内存)";display:block;position:absolute;bottom:0;right:2px;font-size:9px}datum memory-entry memory.heap:after{content:"栈(heap)";display:block;position:absolute;bottom:0;right:2px;font-size:9px}datum memory-entry memory.static:after{content:"(静态)";display:block;position:absolute;bottom:0;right:2px;font-size:9px}datum memory-entry memory.static-vtable:after{content:"(静态虚表)";display:block;position:absolute;bottom:0;right:2px;font-size:9px}datum memory-entry memory-link{display:block;position:absolute;top:-8px;height:7px;font-size:10px;border-width:1px;border-color:grey;z-index:-50}datum memory-entry.double{width:180px}datum memory-entry.quad{width:300px;left:0}datum framed{display:inline-block;border:1px solid #000;padding-bottom:1px}datum pad{background-color:#90ee90;border-radius:0;border:1px dotted #000;padding-bottom:2px}datum andor{display:block;text-align:center;font-size:10px}datum capacity{position:absolute;width:100%;left:-4px;bottom:-4px}datum ptr{background-color:#87cefa}datum ptr,datum sized{display:inline-block;width:80px}datum sized{background-color:#0ff}datum .bytes{background-color:#90ee90}datum .char{background-color:#f4a460}datum .sized{background-color:#0ff}datum .atomic{background-color:#3cb371}datum .float{background-color:orchid}datum .ptr{background-color:#87cefa}datum .any{background-color:salmon}datum .cell{background-color:gold}datum .platformdefined{background-color:#d3d3d3;border:2px dashed #00008b}datum .celled{box-sizing:border-box;border:4px solid gold}datum .atomicx{box-sizing:border-box;border:4px solid #3cb371}datum .enum{background-color:#fafad2}datum .t{background-color:salmon;width:30px}datum .unsized:before{content:" ←";padding-left:2px}datum .unsized:after{content:"→ ";padding-right:2px}datum code{display:table-column;background-color:inherit!important;text-align:center!important;vertical-align:middle;text-shadow:0 0!important}datum sub{font-size:50%}datum tr.vtable{border:1px solid #f2f2f2;background:inherit!important}datum.spaced{margin-right:30px}.day-mode datum bitgroup code span.token.class-name,.day-mode datum framed .token.class-name,.day-mode datum framed .token.keyword,.day-mode datum pad code span.token.class-name{color:#000}.day-mode datum zoom{background-color:#fff8dc}.night-mode datum framed .token.class-name,.night-mode datum framed .token.keyword{color:#000}.night-mode datum .platformdefined,.night-mode datum .platformdefined code,.night-mode datum .platformdefined code span,.night-mode datum byte,.night-mode datum byte code,.night-mode datum byte code span,.night-mode datum framed,.night-mode datum framed code,.night-mode datum framed code span,.night-mode datum memory,.night-mode datum memory code,.night-mode datum memory code span,.night-mode datum pad,.night-mode datum pad code,.night-mode datum pad code span,.night-mode datum payload,.night-mode datum payload code,.night-mode datum payload code span,.night-mode datum ptr,.night-mode datum ptr code,.night-mode datum ptr code span,.night-mode datum sized,.night-mode datum sized code,.night-mode datum sized code span{color:#333!important}.night-mode datum note{color:#000}.night-mode datum zoom{background-color:#222}spacer{display:inline-block;width:15px;height:10px}lifetime-section explanation{display:none}lifetime-example{display:inline-block;width:99%;margin-bottom:0}lifetime-example section-header{width:100%;display:none;font-weight:700;margin-bottom:10px;background-color:#f1ebf1}lifetime-example section-header.arrowed{margin-bottom:15px}lifetime-example memory-row{width:100%;position:relative}lifetime-example memory-row memory-backdrop{width:100%;overflow-x:hidden;white-space:nowrap;display:block;user-select:none}lifetime-example memory-row memory-backdrop.past{height:5px;opacity:.25}lifetime-example memory-row arrows{position:relative;display:block;height:0;top:-8px}lifetime-example memory-row arrows arrow{border-bottom-width:1px;border-spacing:inherit;border-left:1px solid #87cefa;border-bottom-color:#87cefa;border-right:1px solid #87cefa;border-top:1px solid #87cefa;box-sizing:border-box;display:inline-block;position:relative}lifetime-example memory-row arrows arrow tip{position:absolute;line-height:7px;font-size:7px;color:#87cefa;top:2px;left:-4px}lifetime-example memory-row values{position:relative;display:block;height:0;top:-30px}lifetime-example memory-row values denied{display:inline-block;position:relative}lifetime-example memory-row values failed{display:inline-block;position:relative;top:-30px}lifetime-example memory-row values failed value{transform:rotate(-20deg)}lifetime-example memory-row values drop{display:inline-block;position:relative;top:10px}lifetime-example memory-row values drop droparrow{display:inline-block;position:relative;bottom:-12px;font-size:10px}lifetime-example memory-row values value{display:inline-block;position:relative;text-align:center;font-size:.8em;font-family:Fira Code,Consolas,Ubuntu Mono,Menlo,DejaVu Sans Mono,monospace;line-height:22px;border-width:1px;border-style:solid;border-spacing:inherit;box-sizing:border-box;border-radius:5px}lifetime-example memory-row values value.unsafe{border-color:red;border-width:2px}lifetime-example memory-row labels{position:relative;display:block;height:0}lifetime-example memory-row labels label{display:inline-block;position:relative;text-align:center}lifetime-example memory-row subtext{position:relative;display:block;width:100%;text-align:right;top:0;font-weight:700}lifetime-example memory-row subtext:after{margin-left:.3em;content:" ↕️";font-size:.9em}lifetime-example memory-row .byte2{width:32px;height:22px}lifetime-example memory-row .byte4{width:70px;height:22px}lifetime-example memory-row:hover{cursor:pointer}lifetime-example byte{display:inline-block;border:1px solid #aaa;border-radius:5px;width:15px;height:28px}lifetime-example byte.borrowed{border-color:#000;border-width:2px}lifetime-example byte.maybe-borrowed{border:2px dotted #000}lifetime-example .hide{visibility:hidden}lifetime-example meta-lane{width:100%;overflow-x:hidden;white-space:nowrap;display:block;position:absolute;height:100px}lifetime-example empty{display:inline-block;width:15px;height:28px;position:relative}lifetime-example label2{display:inline-block;box-sizing:border-box;border-radius:5px;font-family:Fira Code,Consolas,Ubuntu Mono,Menlo,DejaVu Sans Mono,monospace;width:30px;height:22px;top:30px;left:2px;position:absolute;text-align:center}.day-mode lifetime-example subtext{color:#640475}.day-mode lifetime-example byte{background-color:#fdecdc}.day-mode lifetime-example .t{background-color:salmon}.day-mode lifetime-example .ptr{background-color:#87cefa}.day-mode lifetime-example .atomic{background-color:#3cb371}.day-mode lifetime-example value{color:#000}.night-mode lifetime-example subtext{color:#a943bb}.night-mode lifetime-example byte{background-color:#47423c}.night-mode lifetime-example .t{background-color:salmon}.night-mode lifetime-example .ptr{background-color:#87cefa}.night-mode lifetime-example .atomic{background-color:#3cb371}.night-mode lifetime-example value{color:#000}lifetime-example.not-first{margin-top:40px}.ticktock.ticked .tick{visibility:inherit}.ticktock.ticked .tick.nodisplay{display:inherit}.ticktock.tocked .tick{visibility:hidden}.ticktock.tocked .tick.nodisplay{display:none}.ticktock.ticked .tock{visibility:hidden}.ticktock.ticked .tock.nodisplay{display:none}.ticktock.tocked .tock{visibility:inherit}.ticktock.tocked .tock.nodisplay{display:inherit}zoo{width:100%;height:575px;display:inline-block;border:1px solid #ccc;border-radius:20px;position:relative}zoo entry{position:absolute}zoo region{border:1px solid #ccc;border-radius:20px;width:98%;left:1%;top:5px;position:relative;display:block;margin-bottom:8px}zoo region-label{margin-right:10px;margin-bottom:10px;color:grey;font-size:9pt;text-align:right;display:block;vertical-align:top}zoo group{position:absolute;height:100%}mini-zoo,zoo group{display:inline-block}mini-zoo{position:relative;margin-top:10px}mini-zoo entry{vertical-align:top}mini-zoo person{display:inline-block}mini-zoo subtitle{font-size:80%}.zoo entry{display:inline-block;width:80px;font-size:10pt}.zoo entry type{display:block;border:1px solid #000;border-radius:4px;padding:0;margin-bottom:1px;text-align:center}.zoo entry type code,.zoo entry type code span{color:#000!important}.zoo entry impl{font-size:80%;display:block;background-color:#32cd32;border:1px solid #000;border-radius:4px;padding:2px;color:#fff}.zoo entry impl code span{color:#000!important}.zoo entry function{font-size:90%;display:block;background-color:#e6e6fa;border:1px solid #000;border-radius:4px;padding:2px;color:#fff}.zoo entry function code,.zoo entry function code span{color:#000!important}.zoo entry trait-impl{font-size:85%;display:block;background-color:#32cd32;position:relative;border:1px solid #000;border-radius:4px;padding:2px;z-index:2;color:#000}.zoo entry trait-impl code span{color:#000!important}.zoo entry machine{padding:0;margin-bottom:1px;background-color:orange;text-align:center;color:#000!important}.zoo entry machine,.zoo entry macro{display:block;border:1px solid #000;border-radius:4px}.zoo entry macro{font-size:85%;background-color:linen;position:relative;padding:2px;z-index:2}.zoo entry macro code span{color:#000!important}.zoo entry associated-type{font-size:70%;width:75%;left:20%;z-index:1;position:relative;top:-3px;display:block;background-color:grey;border:1px solid #000;border-radius:4px;padding:2px}.zoo entry associated-type code span{color:#f0f0f0!important}.zoo entry.wide{width:115px}.zoo note{font-size:7pt;color:#aaa;line-height:1.3;display:inline-block;margin-top:2px}.zoo narrow-entry{display:inline-block;font-size:10pt}.zoo label{display:inline-block;position:absolute;color:grey;font-size:9pt;font-weight:700}.zoo .grayed{opacity:.5}.zoo machine.bad{background-color:coral}.zoo machine.good{background-color:#8fbc8f}.zoo .primitive{background-color:#add8e6}.zoo .composed{background-color:salmon}.zoo .zero{background-color:#d3d3d3;border-style:dashed;width:20px}.zoo .generic{background-color:#cfa5e9}.zoo .dotted{border:1px dashed grey;box-sizing:border-box}#trait-authoring-examples entry{width:110px}generics-section{display:block;margin-bottom:15px}generics-section header{font-size:14px;font-weight:bolder;cursor:pointer}generics-section description{display:none}mini-table{display:block;text-align:center;width:100%;margin-top:10px}mini-table table{margin:auto;width:75%!important;border:1px dashed grey}mini-table subtitle{font-size:80%}.day-mode zoo{background-color:#f4f4f4}.day-mode zoo region.your-crate{background-color:#f4faf4;border-color:green}.day-mode generics-section header{background-color:#f1e9e0}.day-mode mini-table table tr.subheader{background-color:#eee}.night-mode zoo{background-color:#3a3131}.night-mode zoo region.your-crate{background-color:#343a34;border-color:green}.night-mode generics-section header{background-color:#52452f}.night-mode mini-table table tr.subheader{background-color:#584c4c}.day-mode code[class*=language-],.day-mode pre[class*=language-]{color:#000;background:none;font-family:Fira Code,Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-variant-ligatures:none;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}.day-mode code[class*=language-]::-moz-selection,.day-mode code[class*=language-] ::-moz-selection,.day-mode pre[class*=language-]::-moz-selection,.day-mode pre[class*=language-] ::-moz-selection{text-shadow:none;background:#b3d4fc}.day-mode code[class*=language-]::selection,.day-mode code[class*=language-] ::selection,.day-mode pre[class*=language-]::selection,.day-mode pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{.day-mode code[class*=language-],.day-mode pre[class*=language-]{text-shadow:none}}.day-mode pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;background:#fafafa}.day-mode blockquote code[class*=language-],.day-mode pre[class*=language-]{background:#fafafa;border-radius:2px;border:1px solid #f1f1f1}.day-mode :not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.day-mode .token.cdata,.day-mode .token.comment,.day-mode .token.doctype,.day-mode .token.prolog{color:#708090}.day-mode .token.punctuation{color:#999}.day-mode .token.namespace{opacity:.7}.day-mode .token.boolean,.day-mode .token.constant,.day-mode .token.deleted,.day-mode .token.number,.day-mode .token.property,.day-mode .token.symbol,.day-mode .token.tag{color:#905}.day-mode .token.attr-name,.day-mode .token.builtin,.day-mode .token.char,.day-mode .token.inserted,.day-mode .token.selector,.day-mode .token.string{color:#690}.day-mode .language-css .token.string,.day-mode .style .token.string,.day-mode .token.entity,.day-mode .token.operator,.day-mode .token.url{color:#9a6e3a}.day-mode .token.atrule,.day-mode .token.attr-value,.day-mode .token.keyword{color:#07a}.day-mode .token.class-name,.day-mode .token.function{color:#ac3b51}.day-mode .token.important,.day-mode .token.regex,.day-mode .token.variable{color:#e90}.day-mode .token.bold,.day-mode .token.important{font-weight:700}.day-mode .token.italic{font-style:italic}.day-mode .token.entity{cursor:help}.night-mode code[class*=language-],.night-mode pre[class*=language-]{color:#fff;background:none;font-family:Fira Code,Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-variant-ligatures:none;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}.night-mode code[class*=language-]::-moz-selection,.night-mode code[class*=language-] ::-moz-selection,.night-mode pre[class*=language-]::-moz-selection,.night-mode pre[class*=language-] ::-moz-selection{text-shadow:none;background:#b3d4fc}.night-mode code[class*=language-]::selection,.night-mode code[class*=language-] ::selection,.night-mode pre[class*=language-]::selection,.night-mode pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{.night-mode code[class*=language-],.night-mode pre[class*=language-]{text-shadow:none}}.night-mode pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;background:#313131}.night-mode blockquote code[class*=language-],.night-mode pre[class*=language-]{background:#313131;border-radius:2px;border:1px solid #414141}.night-mode :not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.night-mode .token.cdata,.night-mode .token.comment,.night-mode .token.doctype,.night-mode .token.prolog{color:#998066}.night-mode .token.namespace,.night-mode .token.punctuation{opacity:.7}.night-mode .token.boolean,.night-mode .token.constant,.night-mode .token.number,.night-mode .token.property,.night-mode .token.symbol,.night-mode .token.tag{color:#ceecf8}.night-mode .token.attr-name,.night-mode .token.builtin,.night-mode .token.char,.night-mode .token.inserted,.night-mode .token.selector,.night-mode .token.string{color:#bde052}.night-mode .language-css .token.string,.night-mode .style .token.string,.night-mode .token.entity,.night-mode .token.operator,.night-mode .token.url,.night-mode .token.variable{color:#f5b83d}.night-mode .token.atrule,.night-mode .token.attr-value,.night-mode .token.keyword{color:#e09fd9}.night-mode .token.important,.night-mode .token.regex{color:#e90}.night-mode .token.bold,.night-mode .token.important{font-weight:700}.night-mode .token.italic{font-style:italic}.night-mode .token.entity{cursor:help}.night-mode .token.deleted{color:red}img#logo{position:relative;top:40px}pagetitle{font-weight:700;font-size:40px}pagetitle,subtitle{text-align:center;display:block}subtitle{margin-bottom:40px}subtitle span{cursor:pointer}page-controls{display:block;font-size:9px}page-controls a{margin-right:15px}flip{display:inline-block;transform:scaleY(-1);background-color:#ff0}symbol-legend{display:block}symbol-legend.long{display:none}legend-symbol{display:inline-block;width:50px}toc{display:flex;margin-top:40px;display:block}toc column{vertical-align:top;width:49%;display:inline-block}twocolumn{display:flex;display:block}twocolumn column{vertical-align:top;width:49%;display:inline-block}feedback{position:relative;display:none}feedback,feedback button-row{float:right}feedback button-row feedback-button{text-align:right;position:relative;opacity:.4}feedback button-row feedback-feedback{visibility:hidden;position:absolute;top:-.5em;left:.7em;opacity:.5;transition:top .5s,opacity .3s}feedback button-row feedback-button:hover{opacity:1}feedback feedback-form{position:absolute;display:none;z-index:1000;width:200px;height:120px;top:1.5em;right:0;background-color:#fafafa;border-radius:3px;border:1px solid #aaa;padding:5px 2px}feedback feedback-form hint{font-size:8px;padding-left:3px;color:grey;display:block;opacity:.5;margin-bottom:5px}feedback feedback-form textarea{height:70px;width:100%;margin:0;border-color:#eee;border-style:solid;font-size:13px;font-family:Open Sans,sans-serif;resize:none}feedback feedback-form textarea:focus::placeholder{color:transparent}feedback feedback-form controls{display:block;height:15px;width:100%;padding-right:2px;font-size:12px;text-align:right}feedback feedback-form controls result{margin-right:40px;position:relative;float:left;left:0;opacity:1;transition:left .5s,opacity .5s}feedback-button:hover{cursor:pointer}sup.target{top:-10px;left:3px;font-size:40%;display:none}h4#numeric-types-ref sup.target,h4#textual-types-ref sup.target{font-size:60%;top:-6px}h1:hover feedback,h1:hover sup.target,h2:hover feedback,h2:hover sup.target,h3:hover feedback,h3:hover sup.target,h4:hover feedback,h4:hover sup.target{display:inline}footnotes{margin-top:5px;font-size:80%;display:block}.night-mode .color-header th{color:#000}.color-header.std-green th{background-color:#d4f7f4}.color-header.red th{background-color:#eb9ca2;border-color:#c87e8c}.color-header.blue th{background-color:#80bad1;border-color:#6292b4}.color-header.green th{background-color:#a4cea4;border-color:#8cb482}.color-header.orange th{background-color:#f1ce9f;border-color:#dcb478}.color-header.magenta th{background-color:#d8a2e2}.color-header.lemongrass th{background-color:#d3e79d}.color-header.undefined-color-3 th{background-color:#9de7cb;border-color:#78d2b4}.color-header.lobstercrabs th{background-color:#e7a493}.color-header.lavender th{background-color:#afa1d4;border-color:#908cbe}.color-header.tooling th{background-color:#a1d4c5;border-color:#86ca97}.color-header.cross-compilation th{background-color:#a8d483}.color-header.one-liners th{background-color:#c2d483;border-color:#aeca6f}.color-header.sized th{background-color:#abccdf;border-color:#97c5c8}.color-header.abstract-machine th{background-color:#abd6cb;border-color:#97c8b4}.color-header.std-traits th{background-color:#e9ebcc}.color-header.std-traits th:first-child{width:130px}.color-header.language-sugar th{background-color:#d2f0d6;border-color:#c8bee6}.color-header.api-stability th{background-color:#ddd5b3;border-color:#c8be96}.color-header.number th{background-color:#eff8ab;border-color:#d2dc96}.color-header.special_example th{background-color:#f1e9e0;border-color:#ddd5cc}.color-header.quality_crate th{background-color:#f1e9e0}.color-header.variance th{background-color:#d697b0;border-color:#c88696}.stringconversion th{background-color:#afa1d4;border-color:#968fc8}.stringconversion th:first-child{width:250px}.stringconversion-other th{background-color:#c3c9de}table.sendsync th{background-color:#d4f7f4;border-bottom:1px solid #c8dcdc!important}table.sendsync th .token.class-name,table.sendsync th .token.keyword{color:#000}table.sendsync td:first-child{background-color:#d4f7f4;text-align:left;font-weight:700;color:#000}table.sendsync td:first-child .token.class-name,table.sendsync td:first-child .token.keyword{color:#000}table.sendsync th:first-child{width:130px}table.sendsync th:nth-child(2),table.sendsync th:nth-child(3){width:300px}.day-mode table.sendsync,.day-mode table.sendsync th{color:#000}.night-mode table.sendsync{color:#fff}.night-mode table.sendsync th{color:#000}.day-mode blockquote.legend .expander{opacity:.5}.day-mode span.good{color:green}.day-mode span.bad{color:#8b0000}.day-mode span.cargo-prefix{border:1px solid #c8c8c8}.day-mode sup{font-size:65%}.day-mode sup.entry{color:#006e00}.day-mode sup.mid{color:#8f5d01}.day-mode sup.expert{color:#b80000}.night-mode blockquote.legend .expander{opacity:1}.night-mode span.good{color:#90ee90}.night-mode span.bad{color:red}.night-mode span.cargo-prefix{border:1px solid #c8c8c8}.night-mode sup{font-size:65%}.night-mode sup.entry{color:#08ce08}.night-mode sup.mid{color:#bd8215}.night-mode sup.expert{color:#cf1b1b}magic{display:block;background-image:url(data:image/png;base64,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);padding:5px;background-size:150px;background-repeat:no-repeat;background-position:100% 0}.force-code-color.same-black code[class*=language-rust],.force-code-color.same-black pre[class*=language-rust],.force-code-color.same-black span[class*="token number"]{color:#555}.force-code-color.same-red code[class*=language-rust],.force-code-color.same-red pre[class*=language-rust],.force-code-color.same-red span[class*="token number"]{color:red}div#helloctrl{text-align:right}div#helloinfo{float:left;font-size:9px;display:none}</style></head><body>  <noprint> <div class="hide_on_small"> <a class="noprint" href="https://nootn.com/rust-language-cheat-sheet/"><img style="position:absolute;top:0;right:0;border:0" src="data:image/png;base64,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" alt="Fork me on GitHub"></a> </div> </noprint> <div class="page"> <div class="page__content"> <div class="book-content"> <h1></h1> <p><img id="logo" class="hide_on_small" src="data:image/png;base64,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" alt="Ferris holding a cheat sheet."> <pagetitle>Rust 语言备忘清单</pagetitle> <subtitle><span id="subtitle" onclick="advance_subtitle()">2022-03-02</span></subtitle></p> <blockquote class="legend"> <symbol-legend class="short"> <p>参考书： <strong>Rust 程序设计语言</strong> <a href="https://kaisery.github.io/trpl-zh-cn/"><sup class="entry">BK</sup></a> （中文）, <strong>通过例子学 Rust</strong> <a href="https://rustwiki.org/zh-CN/rust-by-example/"><sup class="entry">EX</sup></a>（中文）, <strong>标准库文档</strong> <a href="https://doc.rust-lang.org/std"><sup class="mid">STD</sup></a>, <strong>Rust 死灵书</strong> <a href="https://nomicon.purewhite.io/"><sup class="expert">NOM</sup></a>（中文）, <strong>Rust 参考手册</strong> <a href="https://rustwiki.org/zh-CN/reference/"><sup class="expert">REF</sup></a>（中文）.</p> </symbol-legend> <symbol-legend class="long"> <twocolumn> <column> <p><strong>可点击的符号</strong> <br> <br> <legend-symbol> <a href="https://kaisery.github.io/trpl-zh-cn/"><sup class="entry">BK</sup></a> </legend-symbol> <strong>Rust 程序设计语言</strong>。 <br> <legend-symbol> <a href="https://rustwiki.org/zh-CN/rust-by-example/"><sup class="entry">EX</sup></a> </legend-symbol> <strong>通过例子学 Rust</strong>。 <br> <legend-symbol> <a href="https://doc.rust-lang.org/std"><sup class="mid">STD</sup></a> </legend-symbol> <strong>标准库文档</strong>。 <br> <legend-symbol> <a href="https://nomicon.purewhite.io/"><sup class="expert">NOM</sup></a> </legend-symbol> <strong>Rust 死灵书</strong>。 <br> <legend-symbol> <a href="https://rustwiki.org/zh-CN/reference/"><sup class="expert">REF</sup></a> </legend-symbol> <strong>Rust 参考手册</strong>。 <br> <legend-symbol> <a href="https://rust-lang.github.io/rfcs/"><sup class="expert">RFC</sup></a> </legend-symbol> 官方 <strong>RFC</strong> 文档。 <br> <legend-symbol> <a href="https:&#x2F;&#x2F;cheats.rs"><sup>🔗</sup></a> </legend-symbol> 互联网。 <br> <legend-symbol> <a href="#"><sup>↑</sup></a> </legend-symbol>在这个页面上，<strong>上面</strong>。 <br> <legend-symbol> <a href="#"><sup>↓</sup></a> </legend-symbol> 在这个页面上，<strong>下面</strong>。</p> </column> <column> <p><strong>其它符号</strong> <br> <br> <legend-symbol> <sup>🗑️</sup> </legend-symbol>很大程度上<strong>已废弃</strong>。 <br> <legend-symbol> <sup>&#x27;18</sup> </legend-symbol>有<strong>最低版本</strong>要求。 <br> <legend-symbol> <sup>🚧</sup> </legend-symbol>需要<strong>Rust nightly</strong>（或不完整）。 <br> <legend-symbol> <sup>🛑</sup> </legend-symbol>故意的<strong>错误示例</strong>或<strong>陷阱</strong>。 <br> <legend-symbol> <sup style="font-size:100%;position:relative;top:-4px">🝖</sup> </legend-symbol>略显<strong>深奥</strong>，很少使用或高级。 <br> <legend-symbol> <sup>🔥</sup> </legend-symbol>具有<strong>出色实用性</strong>的东西。 <br> <legend-symbol> <sup>?</sup> </legend-symbol><strong>缺少好的链接</strong>或说明。 <br> <legend-symbol> <sup>💬</sup> </legend-symbol> <strong>固执己见的</strong>。</p> </column> </twocolumn> </symbol-legend> <div style="text-align:right;height:1px"> <span class="expander" style="font-size:10px;position:relative;top:-20px"> <a href="javascript:toggle_legend();">➕</a> </span> </div> </blockquote> <noprint> <page-controls>  <a id="toggle_ligatures" href="javascript:toggle_ligatures()">字体连字 (<code>..=, =></code>)</a> <a id="expand_everything" class="hide_on_small" href="javascript:toggle_expand_all()">展开所有内容？</a> <a href="javascript:toggle_night_mode()">夜间模式 &#x1f4a1;</a> </page-controls> </noprint> <noprint> <toc><column> <p><strong>语言结构</strong></p> <ul> <li><a href="https://nootn.com/rust-language-cheat-sheet/#data-structures">数据结构</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#references-pointers">引用 &amp; 指针</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#functions-behavior">函数 &amp; 行为</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#control-flow">控制流程</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#organizing-code">代码组织</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#type-aliases-and-casts">类型别名和转换</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#macros-attributes">宏 &amp; 属性</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#pattern-matching">模式匹配</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#generics-constraints">泛型 &amp; 约束</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#higher-ranked-items">Higher-Ranked Items</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#strings-chars">字符串 &amp; 字符</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#documentation">注释</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#miscellaneous">其他</a></li> </ul> <p><strong>Behind the Scenes</strong></p> <ul> <li><a href="https://nootn.com/rust-language-cheat-sheet/#the-abstract-machine">机器抽象</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#language-sugar">语法糖</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#memory-lifetimes">内存 &amp; 生命周期</a></li> </ul> <p><strong>数据布局</strong></p> <ul> <li><a href="https://nootn.com/rust-language-cheat-sheet/#basic-types">基本类型</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#custom-types">自定义类型</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#references-pointers-ui">引用 &amp; 指针</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#closures-data">闭包</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#standard-library-types">标准库类型</a></li> </ul> <p><strong>附录</strong></p> <ul> <li><a href="https://nootn.com/rust-language-cheat-sheet/#links-services">外链 &amp; 服务</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#printing-pdf">打印 &amp; PDF</a></li> </ul> </column> <column> <p><strong>标准库</strong></p> <ul> <li><a href="https://nootn.com/rust-language-cheat-sheet/#one-liners">One-Liners</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#thread-safety">线程安全</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#iterators">迭代器</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#number-conversions">数字转换</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#string-conversions">字符串转换</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#string-output">字符串输出</a></li> </ul> <p><strong>工具</strong></p> <ul> <li><a href="https://nootn.com/rust-language-cheat-sheet/#project-anatomy">项目结构</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#cargo">Cargo</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#cross-compilation">交叉编译</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#tooling-directives">工具指令</a></li> </ul> <p><strong>使用类型</strong></p> <ul> <li><a href="https://nootn.com/rust-language-cheat-sheet/#types-traits-generics">类型、特征、泛型</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#type-zoo">类型乐园</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#type-conversions">类型转换</a></li> </ul> <p><strong>编码指南</strong></p> <ul> <li><a href="https://nootn.com/rust-language-cheat-sheet/#idiomatic-rust">Rust 惯用法</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#async-await-101">Async-Await 101</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#closures-in-apis">闭包 API</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#unsafe-unsound-undefined">Unsafe, Unsound, Undefined</a></li> <li><a href="https://nootn.com/rust-language-cheat-sheet/#api-stability">API 稳定性</a></li> </ul> </column> </toc> </noprint> <noprint> <h2 id="ni-hao-rust">你好，Rust!<sup id="target-ni-hao-rust" class="target"><a href="#ni-hao-rust">url</a></sup></h2> <p>如果你是 Rust 新手，或者你想试点什么，可以在下面尝试运行一下：</p> <tabs>  <tab> <input type="radio" id="tab-hello-1" name="tab-hello" checked> <label for="tab-hello-1"><b>Hello World</b></label> <panel><div> <div id="hellostatic"> <pre data-lang="rust" class="language-rust"><code class="language-rust" data-lang="rust">fn main() {
    println!(&quot;Hello, world!&quot;);
}
</code></pre> </div> <div id="helloplay"></div> <div id="helloinfo">服务由 <a href="https://play.rust-lang.org/" target="_blank" rel="noopener">play.rust-lang.org <sup>🔗</sup></a> 提供</div> <div id="helloctrl"><a href="javascript:show_playground(true);">▶️ 编辑 & 运行</a></div> </div></panel></tab>  <tab> <input type="radio" id="tab-hello-3" name="tab-hello"> <label for="tab-hello-3"><b>优势</b></label> <panel><div> <p><strong>Rust 做得非常好</strong></p> <ul> <li>编译后的代码性能与 C/C++ <a href="https://benchmarksgame-team.pages.debian.net/benchmarksgame/box-plot-summary-charts.html">差不多</a>，而且<a href="https://dl.acm.org/doi/10.1145/3136014.3136031">内存和能源效率</a>非常出色。</li> <li>可以避免 C/C++中存在的<a href="https://www.chromium.org/Home/chromium-security/memory-safety">70%的安全问题</a>，以及大多数内存问题。</li> <li>强类型系统可防止<a href="https://doc.rust-lang.org/nomicon/races.html">数据竞争</a>，带来“<a href="https://blog.rust-lang.org/2015/04/10/Fearless-Concurrency.html">无畏并发</a>”（等等）。</li> <li>无缝的 C 互操作，以及<a href="https://doc.rust-lang.org/rustc/platform-support.html">数十个支持的平台</a>（基于 LLVM）。</li> <li>连续 6 年“<a href="https://insights.stackoverflow.com/survey/2021#technology-most-loved-dreaded-and-wanted">最喜爱的语言</a>”。</li> <li>现代工具：cargo（构建只是工作），clippy（450+ 代码质量 Lints），rustup（简单的工具链管理）。</li> </ul> </div></panel></tab>  <tab> <input type="radio" id="tab-hello-4" name="tab-hello"> <label for="tab-hello-4"><b>弱点</b></label> <panel><div> <p><strong>你可能会遇到的点</strong></p> <ul> <li>陡峭的学习曲<sup>1</sup>；编译器强制执行（特别是内存）规则，这在其他地方是“最佳实践”。</li> <li>在某些领域、目标平台（尤其是嵌入式）、IDE 功能中缺少 Rust 原生库<sup>1</sup>。</li> <li>与其他语言中的“类似”代码相比，编译时间更长<sup>1</sup>。</li> <li>没有正式的语言规范，可能会阻止在某些领域（航空、医疗等）合法使用。</li> <li>Careless (use of <code>unsafe</code> in) libraries can secretly break safety guarantees.</li> </ul> <p><sup>1</sup> Compare <a href="https://blog.rust-lang.org/2020/04/17/Rust-survey-2019.html#why-not-use-rust">Rust Survey</a>.</p> </div></panel></tab>  <tab> <input type="radio" id="tab-hello-5" name="tab-hello"> <label for="tab-hello-5"><b>安装</b></label> <panel><div> <p><strong>下载</strong></p> <ul> <li>从 <a href="https://rustup.rs/"><strong>rustup.rs</strong></a> 获取安装程序（强烈推荐用于任何平台）</li> </ul> <p><strong>IDE 编辑器</strong></p> <ul> <li><a href="https://www.jetbrains.com/idea/">IntelliJ</a> （免费）或者 带有 <a href="https://intellij-rust.github.io/"><strong>IntelliJ Rust</strong></a> 功能的 <a href="https://www.jetbrains.com/clion/">CLion</a> （收费）。</li> <li>安装了 <a href="https://rust-analyzer.github.io/"><strong>rust-analyzer</strong></a> 插件的 <a href="https://code.visualstudio.com/">Visual Studio Code</a>。</li> </ul> </div></panel></tab>  <tab> <input type="radio" id="tab-hello-6" name="tab-hello"> <label for="tab-hello-6"><b>第一步</b></label> <panel><div>  <p><strong>模块化初学者资源</strong></p> <ul> <li><a href="https://tourofrust.com/TOC_zh-cn.html"><strong>Rust 语言之旅</strong></a>（中文） - 并排的实时代码和解释。</li> <li><a href="https://dhghomon.github.io/easy_rust/Chapter_3.html"><strong>用普通英文学习 Rust</strong></a> - 60 多个概念，简单英语，示例驱动。</li> </ul> <p>此外，have a look at the usual suspects. <a href="https://kaisery.github.io/trpl-zh-cn/"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/"><sup class="entry">EX</sup></a> <a href="https://doc.rust-lang.org/std"><sup class="mid">STD</sup></a></p> <blockquote> <p><strong>Opinion</strong> <sup>💬</sup> — If you have never seen or used any Rust it might be good to visit one of the links above before continuing; the next chapter might feel a bit terse otherwise.</p> </blockquote> </div></panel></tab> </tabs> </noprint> <h3 id="data-structures">数据结构<sup id="target-data-structures" class="target"><a href="#data-structures">url</a></sup></h3> <p>数据类型和内存位置由关键字定义。</p> <fixed-2-column> <table><thead><tr><th>示例</th><th>说明</th></tr></thead><tbody> <tr><td><code>struct S {}</code></td><td>定义包含命名字段的<strong>结构体</strong><a href="https://kaisery.github.io/trpl-zh-cn/ch05-00-structs.html"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/custom_types&#x2F;structs.html"><sup class="entry">EX</sup></a> <a href="https://doc.rust-lang.org/std&#x2F;keyword.struct.html"><sup class="mid">STD</sup></a> <a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;struct-expr.html"><sup class="expert">REF</sup></a>。</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>struct S { x: T }</code></td><td>定义包含 <code>T</code> 类型命名字段 <code>x</code> 的结构体。</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>struct S</code> ​<code>(T);</code></td><td>定义 <code>T</code> 类型数字字段 <code>.0</code> 的“元组”结构体。</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>struct S;</code></td><td>定义一个<strong>零大小</strong><a href="https://nomicon.purewhite.io/exotic-sizes.html#zero-sized-types-zsts"><sup class="expert">NOM</sup></a>的单元结构体。不占用任何空间，并进行了优化。</td></tr> <tr><td><code>enum E {}</code></td><td>定义<strong>枚举</strong>，<a href="https://kaisery.github.io/trpl-zh-cn/ch06-01-defining-an-enum.html"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/custom_types&#x2F;enum.html#enums"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/items&#x2F;enumerations.html"><sup class="expert">REF</sup></a> <em>c</em>. <a href="https://en.wikipedia.org/wiki/Algebraic_data_type">数字数据类型</a>, <a href="https://en.wikipedia.org/wiki/Tagged_union">标签联合</a>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>enum E { A, B</code>​<code>(), C {} }</code></td><td>定义变体枚举；可以是单元- <code>A</code>，元组- <code>B</code> ​<code>()</code> 或则结构体风格的 <code>C{}</code>。</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>enum E { A = 1 }</code></td><td>如果所有变体都是单元值，则允许判别式值，例如用于 FFI。</td></tr> <tr><td><code>union U {}</code></td><td>不安全的 C 风格<strong>联合体</strong><a href="https://rustwiki.org/zh-CN/reference/items&#x2F;unions.html"><sup class="expert">REF</sup></a>，用于兼容 FFI。 <sup style="font-size:100%;position:relative;top:-4px">🝖</sup></td></tr> <tr><td><code>static X: T = T();</code></td><td>有 <code>'static</code> 生命周期的<strong>全局变量</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch19-01-unsafe-rust.html#accessing-or-modifying-a-mutable-static-variable"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/custom_types&#x2F;constants.html#constants"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/items&#x2F;static-items.html#static-items"><sup class="expert">REF</sup></a>，内存位置独立。</td></tr> <tr><td><code>const X: T = T();</code></td><td>定义<strong>常量</strong><a href="https://kaisery.github.io/trpl-zh-cn/ch03-01-variables-and-mutability.html#differences-between-variables-and-constants"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/custom_types&#x2F;constants.html"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/items&#x2F;constant-items.html"><sup class="expert">REF</sup></a>，使用时会临时复制一份。</td></tr> <tr><td><code>let x: T;</code></td><td>在栈<sup>1</sup>上分配 <code>T</code> 大小的字节并命名为 <code>x</code>。 一旦分配不可修改。</td></tr> <tr><td><code>let mut x: T;</code></td><td>类似于 <code>let</code>，但允许<strong>修改</strong><a href="https://kaisery.github.io/trpl-zh-cn/ch03-01-variables-and-mutability.html"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/variable_bindings&#x2F;mut.html"><sup class="entry">EX</sup></a>以及可变借用<sup>2</sup>。</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>x = y;</code></td><td>将 <code>y</code> 移动到 <code>x</code>，如果 <code>T</code> 不能 <strong><code>Copy</code></strong><a href="https://doc.rust-lang.org/std&#x2F;marker&#x2F;trait.Copy.html"><sup class="mid">STD</sup></a>，<code>y</code> 将不再可用，否则 <code>y</code> 会复制一份。</td></tr> </tbody></table> </fixed-2-column> <footnotes> <p><sup>1</sup> <strong>绑定变量</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch03-01-variables-and-mutability.html"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/variable_bindings.html"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/variables.html"><sup class="expert">REF</sup></a>生存在栈上的同步代码。在<code>async{}</code>中，这些变量将成为异步状态机的一部分，最终驻留在堆上。<br> <sup>2</sup> 严密地来说_可变_和_不可变_并不准确。不可变绑定或共享引用可能仍然包含 Cell <a href="https://doc.rust-lang.org/std&#x2F;cell&#x2F;index.html"><sup class="mid">STD</sup></a>，从而提供_内部可变性_。</p> </footnotes> <div>&nbsp;</div> <p>下面列出了如何构建和访问数据结构；以及一些_神奇的_类型。</p> <fixed-2-column> <table><thead><tr><th>示例</th><th>说明</th></tr></thead><tbody> <tr><td><code>S { x: y }</code></td><td>构建 <code>struct S {}</code> 或者 <code>use</code>'ed <code>enum E::S {}</code> 字段 <code>x</code> 设置为 <code>y</code>。</td></tr> <tr><td><code>S { x }</code></td><td>同上，但字段 <code>x</code> 会被设置为局部变量 <code>x</code>。</td></tr> <tr><td><code>S { ..s }</code></td><td>用 <code>s</code> 填充剩余字段，常配合 <a href="https://doc.rust-lang.org/std/default/trait.Default.html">Default</a> 一起使用。</td></tr> <tr><td><code>S { 0: x }</code></td><td>类似于下面的 <code>S</code> ​<code>(x)</code>，但是用结构体语法设置字段 <code>.0</code>。</td></tr> <tr><td><code>S</code>​ <code>(x)</code></td><td>构建 <code>struct S</code> ​<code>(T)</code> 或者 <code>use</code>'ed <code>enum E::S</code>​ <code>()</code> 其中字段 <code>.0</code> 设置为 <code>x</code>。</td></tr> <tr><td><code>S</code></td><td>如果 <code>S</code> 是单元 <code>struct S</code>；或以 <code>S</code> 为值构建 <code>use</code>'ed <code>enum E::S</code>。</td></tr> <tr><td><code>E::C { x: y }</code></td><td>构建枚举变体 <code>C</code>。 上面的其他方法依然有效。</td></tr> <tr><td><code>()</code></td><td>空元组，既是字面量也是类型，又称<strong>单元</strong>。<a href="https://doc.rust-lang.org/std&#x2F;primitive.unit.html"><sup class="mid">STD</sup></a></td></tr> <tr><td><code>(x)</code></td><td>括号表达式。</td></tr> <tr><td><code>(x,)</code></td><td>单元素<strong>元组</strong>表达式。<a href="https://rustwiki.org/zh-CN/rust-by-example/primitives&#x2F;tuples.html"><sup class="entry">EX</sup></a> <a href="https://doc.rust-lang.org/std&#x2F;primitive.tuple.html"><sup class="mid">STD</sup></a> <a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;tuple-expr.html"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>(S,)</code></td><td>单元素元组类型。</td></tr> <tr><td><code>[S]</code></td><td>未指明长度的的数组类型，如<strong>切片</strong>。<a href="https://rustwiki.org/zh-CN/rust-by-example/primitives&#x2F;array.html"><sup class="entry">EX</sup></a> <a href="https://doc.rust-lang.org/std&#x2F;primitive.slice.html"><sup class="mid">STD</sup></a> <a href="https://rustwiki.org/zh-CN/reference/types.html#array-and-slice-types"><sup class="expert">REF</sup></a> 不能生存在栈上。<sup>*</sup></td></tr> <tr><td><code>[S; n]</code></td><td>元素类型为 <code>S</code>，固定长度为 <code>n</code> 的<strong>数组类型</strong> <a href="https://rustwiki.org/zh-CN/rust-by-example/primitives&#x2F;array.html"><sup class="entry">EX</sup></a> <a href="https://doc.rust-lang.org/std&#x2F;primitive.array.html"><sup class="mid">STD</sup></a>。</td></tr> <tr><td><code>[x; n]</code></td><td>由 <code>n</code> 个 <code>x</code> 副本构建的数组实例。<a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;array-expr.html"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>[x, y]</code></td><td>由给定元素 <code>x</code> 和 <code>y</code>构成的数据实例。</td></tr> <tr><td><code>x[0]</code></td><td>组合的索引，返回结果是 <code>usize</code> 类型。可重载 <a href="https://doc.rust-lang.org/std/ops/trait.Index.html"><strong>Index</strong></a>, <a href="https://doc.rust-lang.org/std/ops/trait.IndexMut.html"><strong>IndexMut</strong></a>。</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>x[..]</code></td><td>同样，通过范围（这里是_全部范围_），下面的 <code>x[a..b]</code>, <code>x[a..=b]</code>, ...<em>c</em> 也一样。</td></tr> <tr><td><code>a..b</code></td><td>构建<strong>左闭右开区间</strong> <a href="https://doc.rust-lang.org/std&#x2F;ops&#x2F;struct.Range.html"><sup class="mid">STD</sup></a> <a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;range-expr.html"><sup class="expert">REF</sup></a>，例如 <code>1..3</code> 表示 <code>1, 2</code>。</td></tr> <tr><td><code>..b</code></td><td>无起点到<strong>右开区间</strong> <a href="https://doc.rust-lang.org/std&#x2F;ops&#x2F;struct.RangeTo.html"><sup class="mid">STD</sup></a>。</td></tr> <tr><td><code>a..=b</code></td><td><strong>全闭合区间</strong>, <a href="https://doc.rust-lang.org/std&#x2F;ops&#x2F;struct.RangeInclusive.html"><sup class="mid">STD</sup></a> <code>1..=3</code> 表示 <code>1, 2, 3</code>。</td></tr> <tr><td><code>..=b</code></td><td>无起点到<strong>右闭合区间</strong> <a href="https://doc.rust-lang.org/std&#x2F;ops&#x2F;struct.RangeFrom.html"><sup class="mid">STD</sup></a>。</td></tr> <tr><td><code>..</code></td><td><strong>全包含区间</strong><a href="https://doc.rust-lang.org/std&#x2F;ops&#x2F;struct.RangeFull.html"><sup class="mid">STD</sup></a>，通常表示_整个组合_。</td></tr> <tr><td><code>s.x</code></td><td>命名 <strong>字段访问</strong><a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;field-expr.html"><sup class="expert">REF</sup></a>，如果 <code>x</code> 不是 <code>s</code> 的一部分的话则会尝试 <a href="https://doc.rust-lang.org/std/ops/trait.Deref.html">Deref</a>。</td></tr> <tr><td><code>s.0</code></td><td>数字字段访问，用于元组类型 <code>S</code> ​<code>(T)</code>。</td></tr> </tbody></table> </fixed-2-column> <footnotes> <p><sup>*</sup> 目前<a href="https://rust-lang.github.io/rfcs/1909-unsized-rvalues.html"><sup class="expert">RFC</sup></a>，待处理的<a href="https://github.com/rust-lang/rust/issues/48055">跟踪问题</a>。</p> </footnotes> <h3 id="references-pointers">引用 &amp; 指针<sup id="target-references-pointers" class="target"><a href="#references-pointers">url</a></sup></h3> <p>为非所有者内存赋予访问权限。另请参见 <a href="https://nootn.com/rust-language-cheat-sheet/#generics-constraints">泛型 &amp; 约束</a>部分。</p> <fixed-2-column> <table><thead><tr><th>示例</th><th>说明</th></tr></thead><tbody> <tr><td><code>&amp;S</code></td><td>Shared <strong>reference</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch04-02-references-and-borrowing.html"><sup class="entry">BK</sup></a> <a href="https://doc.rust-lang.org/std&#x2F;primitive.reference.html"><sup class="mid">STD</sup></a> <a href="https://nomicon.purewhite.io/references.html"><sup class="expert">NOM</sup></a> <a href="https://rustwiki.org/zh-CN/reference/types.html#pointer-types"><sup class="expert">REF</sup></a> (space for holding <em>any</em> <code>&amp;s</code>).</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>&amp;[S]</code></td><td>Special slice reference that contains (<code>address</code>, <code>length</code>).</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>&amp;str</code></td><td>Special string slice reference that contains (<code>address</code>, <code>length</code>).</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>&amp;mut S</code></td><td>Exclusive reference to allow mutability (also <code>&amp;mut [S]</code>, <code>&amp;mut dyn S</code>, …).</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>&amp;dyn T</code></td><td>Special <strong>trait object</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch17-02-trait-objects.html#using-trait-objects-that-allow-for-values-of-different-types"><sup class="entry">BK</sup></a> reference that contains (<code>address</code>, <code>vtable</code>).</td></tr> <tr><td><code>&amp;s</code></td><td>Shared <strong>borrow</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch04-02-references-and-borrowing.html"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/scope&#x2F;borrow.html"><sup class="entry">EX</sup></a> <a href="https://doc.rust-lang.org/std&#x2F;borrow&#x2F;trait.Borrow.html"><sup class="mid">STD</sup></a> (e.g., address, len, vtable, … of <em>this</em> <code>s</code>, like <code>0x1234</code>).</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>&amp;mut s</code></td><td>Exclusive borrow that allows <strong>mutability</strong>. <a href="https://rustwiki.org/zh-CN/rust-by-example/scope&#x2F;borrow&#x2F;mut.html"><sup class="entry">EX</sup></a></td></tr> <tr><td><code>*const S</code></td><td>Immutable <strong>raw pointer type</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch19-01-unsafe-rust.html#dereferencing-a-raw-pointer"><sup class="entry">BK</sup></a> <a href="https://doc.rust-lang.org/std&#x2F;primitive.pointer.html"><sup class="mid">STD</sup></a> <a href="https://rustwiki.org/zh-CN/reference/types.html#raw-pointers-const-and-mut"><sup class="expert">REF</sup></a> w/o memory safety.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>*mut S</code></td><td>Mutable raw pointer type w/o memory safety.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>&amp;raw const s</code></td><td>Create raw pointer w/o going through reference; <em>c</em>. <code>ptr:addr_of!()</code> <a href="https://doc.rust-lang.org/std&#x2F;ptr&#x2F;macro.addr_of.html"><sup class="mid">STD</sup></a> <sup>🚧</sup> <sup style="font-size:100%;position:relative;top:-4px">🝖</sup></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>&amp;raw mut s</code></td><td>Same, but mutable. <sup>🚧</sup> Raw ptrs. are needed for unaligned, packed fields. <sup style="font-size:100%;position:relative;top:-4px">🝖</sup></td></tr> <tr><td><code>ref s</code></td><td><strong>Bind by reference</strong>, <a href="https://rustwiki.org/zh-CN/rust-by-example/scope&#x2F;borrow&#x2F;ref.html"><sup class="entry">EX</sup></a> makes binding reference type. <sup>🗑️</sup></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>let ref r = s;</code></td><td>Equivalent to <code>let r = &amp;s</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>let S { ref mut x } = s;</code></td><td>Mutable ref binding (<code>let x = &amp;mut s.x</code>), shorthand destructuring <a href="#pattern-matching"><sup>↓</sup></a> version.</td></tr> <tr><td><code>*r</code></td><td><strong>Dereference</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch15-02-deref.html"><sup class="entry">BK</sup></a> <a href="https://doc.rust-lang.org/std&#x2F;ops&#x2F;trait.Deref.html"><sup class="mid">STD</sup></a> <a href="https://nomicon.purewhite.io/vec-deref.html"><sup class="expert">NOM</sup></a> a reference <code>r</code> to access what it points to.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>*r = s;</code></td><td>If <code>r</code> is a mutable reference, move or copy <code>s</code> to target memory.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>s = *r;</code></td><td>Make <code>s</code> a copy of whatever <code>r</code> references, if that is <code>Copy</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>s = *r;</code></td><td>Won't work <sup>🛑</sup> if <code>*r</code> is not <code>Copy</code>, as that would move and leave empty place.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>s = *my_box;</code></td><td>Special case<a href="https:&#x2F;&#x2F;www.reddit.com&#x2F;r&#x2F;rust&#x2F;comments&#x2F;b4so6i&#x2F;what_is_exactly&#x2F;ej8xwg8"><sup>🔗</sup></a> for <code>Box</code> that can also move out Box'ed content if it isn't <code>Copy</code>.</td></tr> <tr><td><code>'a</code></td><td>A <strong>lifetime parameter</strong>, <a href="https://kaisery.github.io/trpl-zh-cn/ch10-00-generics.html"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/scope&#x2F;lifetime.html"><sup class="entry">EX</sup></a> <a href="https://nomicon.purewhite.io/lifetimes.html"><sup class="expert">NOM</sup></a> <a href="https://rustwiki.org/zh-CN/reference/items&#x2F;generics.html#type-and-lifetime-parameters"><sup class="expert">REF</sup></a> duration of a flow in static analysis.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>&amp;'a S</code></td><td>Only accepts an address holding an <code>s</code>; addr. existing <code>'a</code> or longer.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>&amp;'a mut S</code></td><td>Same, but allow content of address to be changed.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>struct S&lt;'a&gt; {}</code></td><td>Signals <code>S</code> will contain address with lifetime <code>'a</code>. Creator of <code>S</code> decides <code>'a</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>trait T&lt;'a&gt; {}</code></td><td>Signals a <code>S</code> which <code>impl T for S</code> might contain address.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>fn f&lt;'a&gt;(t: &amp;'a T)</code></td><td>Same, for function. Caller decides <code>'a</code>.</td></tr> <tr><td><code>'static</code></td><td>Special lifetime lasting the entire program execution.</td></tr> </tbody></table> </fixed-2-column> <h3 id="functions-behavior">函数 &amp; 行为<sup id="target-functions-behavior" class="target"><a href="#functions-behavior">url</a></sup></h3> <p>定义代码单元及其抽象。</p> <fixed-2-column> <table><thead><tr><th>示例</th><th>说明</th></tr></thead><tbody> <tr><td><code>trait T {}</code></td><td>Define a <strong>trait</strong>; <a href="https://kaisery.github.io/trpl-zh-cn/ch10-02-traits.html"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/trait.html"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/items&#x2F;traits.html"><sup class="expert">REF</sup></a> common behavior others can implement.</td></tr> <tr><td><code>trait T : R {}</code></td><td><code>T</code> is subtrait of <strong>supertrait</strong> <a href="https://rustwiki.org/zh-CN/reference/items&#x2F;traits.html#supertraits"><sup class="expert">REF</sup></a> <code>R</code>. Any <code>S</code> must <code>impl R</code> before it can <code>impl T</code>.</td></tr> <tr><td><code>impl S {}</code></td><td><strong>Implementation</strong> <a href="https://rustwiki.org/zh-CN/reference/items&#x2F;implementations.html"><sup class="expert">REF</sup></a> of functionality for a type <code>S</code>, e.g., methods.</td></tr> <tr><td><code>impl T for S {}</code></td><td>Implement trait <code>T</code> for type <code>S</code>.</td></tr> <tr><td><code>impl !T for S {}</code></td><td>Disable an automatically derived <strong>auto trait</strong>. <a href="https://nomicon.purewhite.io/send-and-sync.html"><sup class="expert">NOM</sup></a> <a href="https://rustwiki.org/zh-CN/reference/special-types-and-traits.html#auto-traits"><sup class="expert">REF</sup></a> <sup>🚧</sup> <sup style="font-size:100%;position:relative;top:-4px">🝖</sup></td></tr> <tr><td><code>fn f() {}</code></td><td>Definition of a <strong>function</strong>; <a href="https://kaisery.github.io/trpl-zh-cn/ch03-03-how-functions-work.html"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/fn.html"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/items&#x2F;functions.html"><sup class="expert">REF</sup></a> or associated function if inside <code>impl</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>fn f() -&gt; S {}</code></td><td>Same, returning a value of type S.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>fn f(&amp;self) {}</code></td><td>Define a <strong>method</strong>, <a href="https://kaisery.github.io/trpl-zh-cn/ch05-03-method-syntax.html"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/fn&#x2F;methods.html"><sup class="entry">EX</sup></a> e.g., within an <code>impl S {}</code>.</td></tr> <tr><td><code>const fn f() {}</code></td><td>Constant <code>fn</code> usable at compile time, e.g., <code>const X: u32 = f(Y)</code>. <sup>&#x27;18</sup></td></tr> <tr><td><code>async fn f() {}</code></td><td><strong>Async</strong> <a href="https://rustwiki.org/zh-CN/reference/items&#x2F;functions.html#async-functions"><sup class="expert">REF</sup></a> <sup>&#x27;18</sup> function transformation, <a href="#async-await-101"><sup>↓</sup></a> makes <code>f</code> return an <code>impl</code> <strong><code>Future</code></strong>. <a href="https://doc.rust-lang.org/std&#x2F;future&#x2F;trait.Future.html"><sup class="mid">STD</sup></a></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>async fn f() -&gt; S {}</code></td><td>Same, but make <code>f</code> return an <code>impl Future&lt;Output=S&gt;</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>async { x }</code></td><td>Used within a function, make <code>{ x }</code> an <code>impl Future&lt;Output=X&gt;</code>.</td></tr> <tr><td><code>fn() -&gt; S</code></td><td><strong>Function pointers</strong>, <a href="https://kaisery.github.io/trpl-zh-cn/ch19-05-advanced-functions-and-closures.html#function-pointers"><sup class="entry">BK</sup></a> <a href="https://doc.rust-lang.org/std&#x2F;primitive.fn.html"><sup class="mid">STD</sup></a> <a href="https://rustwiki.org/zh-CN/reference/types.html#function-pointer-types"><sup class="expert">REF</sup></a> memory holding address of a callable.</td></tr> <tr><td><code>Fn() -&gt; S</code></td><td><strong>Callable Trait</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch19-05-advanced-functions-and-closures.html#returning-closures"><sup class="entry">BK</sup></a> <a href="https://doc.rust-lang.org/std&#x2F;ops&#x2F;trait.Fn.html"><sup class="mid">STD</sup></a> (also <code>FnMut</code>, <code>FnOnce</code>), implemented by closures, fn's …</td></tr> <tr><td><code>|| {} </code></td><td>A <strong>closure</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch13-01-closures.html"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/fn&#x2F;closures.html"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;closure-expr.html"><sup class="expert">REF</sup></a> that borrows its <strong>captures</strong>, <a href="#closures-data"><sup>↓</sup></a> <a href="https://rustwiki.org/zh-CN/reference/types&#x2F;closure.html#capture-modes"><sup class="expert">REF</sup></a> (e.g., a local variable).</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>|x| {}</code></td><td>Closure accepting one argument named <code>x</code>, body is block expression.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>|x| x + x</code></td><td>Same, without block expression; may only consist of single expression.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>move |x| x + y </code></td><td>Closure taking ownership of its captures; i.e., <code>y</code> transferred to closure.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code> return || true </code></td><td>Closures sometimes look like logical ORs (here: return a closure).</td></tr> <tr><td><code>unsafe</code></td><td>If you enjoy debugging segfaults Friday night; <strong>unsafe code</strong>. <a href="#unsafe-unsound-undefined"><sup>↓</sup></a> <a href="https://kaisery.github.io/trpl-zh-cn/ch19-01-unsafe-rust.html#unsafe-superpowers"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/unsafe.html#unsafe-operations"><sup class="entry">EX</sup></a> <a href="https://nomicon.purewhite.io/meet-safe-and-unsafe.html"><sup class="expert">NOM</sup></a> <a href="https://rustwiki.org/zh-CN/reference/unsafe-blocks.html#unsafe-blocks"><sup class="expert">REF</sup></a></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>unsafe fn f() {}</code></td><td>Means &quot;<em>calling can cause UB, <a href="#unsafe-unsound-undefined"><sup>↓</sup></a> <strong>YOU must check</strong> requirements</em>&quot;.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>unsafe trait T {}</code></td><td>Means &quot;<em>careless impl. of <code>T</code> can cause UB</em>; <strong>implementor must check</strong>&quot;.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>unsafe { f(); }</code></td><td>Guarantees to compiler &quot;<em><strong>I have checked</strong> requirements, trust me</em>&quot;.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>unsafe impl T for S {}</code></td><td>Guarantees <em><code>S</code> is well-behaved w.r.t <code>T</code></em>; people may use <code>T</code> on <code>S</code> safely.</td></tr> </tbody></table> </fixed-2-column> <h3 id="control-flow">控制流程<sup id="target-control-flow" class="target"><a href="#control-flow">url</a></sup></h3> <p>在函数中控制执行。</p> <fixed-2-column> <table><thead><tr><th>示例</th><th>说明</th></tr></thead><tbody> <tr><td><code>while x {}</code></td><td><strong>Loop</strong>, <a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;loop-expr.html#predicate-loops"><sup class="expert">REF</sup></a> run while expression <code>x</code> is true.</td></tr> <tr><td><code>loop {}</code></td><td><strong>Loop indefinitely</strong> <a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;loop-expr.html#infinite-loops"><sup class="expert">REF</sup></a> until <code>break</code>. Can yield value with <code>break x</code>.</td></tr> <tr><td><code>for x in iter {}</code></td><td>Syntactic sugar to loop over <strong>iterators</strong>. <a href="https://kaisery.github.io/trpl-zh-cn/ch13-02-iterators.html"><sup class="entry">BK</sup></a> <a href="https://doc.rust-lang.org/std&#x2F;iter&#x2F;index.html"><sup class="mid">STD</sup></a> <a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;loop-expr.html#iterator-loops"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>if x {} else {}</code></td><td><strong>Conditional branch</strong> <a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;if-expr.html"><sup class="expert">REF</sup></a> if expression is true.</td></tr> <tr><td><code>'label: loop {}</code></td><td><strong>Loop label</strong>, <a href="https://rustwiki.org/zh-CN/rust-by-example/flow_control&#x2F;loop&#x2F;nested.html"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;loop-expr.html#loop-labels"><sup class="expert">REF</sup></a> useful for flow control in nested loops.</td></tr> <tr><td><code>break</code></td><td><strong>Break expression</strong> <a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;loop-expr.html#break-expressions"><sup class="expert">REF</sup></a> to exit a loop.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>break x</code></td><td>Same, but make <code>x</code> value of the loop expression (only in actual <code>loop</code>).</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>break 'label</code></td><td>Exit not only this loop, but the enclosing one marked with <code>'label</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>break 'label x</code></td><td>Same, but make <code>x</code> the value of the enclosing loop marked with <code>'label</code>.</td></tr> <tr><td><code>continue </code></td><td><strong>Continue expression</strong> <a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;loop-expr.html#continue-expressions"><sup class="expert">REF</sup></a> to the next loop iteration of this loop.</td></tr> <tr><td><code>continue 'label</code></td><td>Same but instead of this loop, enclosing loop marked with 'label.</td></tr> <tr><td><code>x?</code></td><td>If <code>x</code> is <a href="https://doc.rust-lang.org/std/result/enum.Result.html#variant.Err">Err</a> or <a href="https://doc.rust-lang.org/std/option/enum.Option.html#variant.None">None</a>, <strong>return and propagate</strong>. <a href="https://kaisery.github.io/trpl-zh-cn/ch09-02-recoverable-errors-with-result.html#propagating-errors"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/error&#x2F;result&#x2F;enter_question_mark.html"><sup class="entry">EX</sup></a> <a href="https://doc.rust-lang.org/std&#x2F;result&#x2F;index.html#the-question-mark-operator-"><sup class="mid">STD</sup></a> <a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;operator-expr.html#the-question-mark-operator"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>x.await</code></td><td>Only works inside <code>async</code>. Yield flow until <strong><code>Future</code></strong> <a href="https://doc.rust-lang.org/std&#x2F;future&#x2F;trait.Future.html"><sup class="mid">STD</sup></a> or Stream <code>x</code> ready. <a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;await-expr.html#await-expressions"><sup class="expert">REF</sup></a> <sup>&#x27;18</sup></td></tr> <tr><td><code>return x</code></td><td>Early return from function. More idiomatic way is to end with expression.</td></tr> <tr><td><code>f()</code></td><td>Invoke callable <code>f</code> (e.g., a function, closure, function pointer, <code>Fn</code>, …).</td></tr> <tr><td><code>x.f()</code></td><td>Call member function, requires <code>f</code> takes <code>self</code>, <code>&amp;self</code>, … as first argument.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>X::f(x)</code></td><td>Same as <code>x.f()</code>. Unless <code>impl Copy for X {}</code>, <code>f</code> can only be called once.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>X::f(&amp;x)</code></td><td>Same as <code>x.f()</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>X::f(&amp;mut x)</code></td><td>Same as <code>x.f()</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>S::f(&amp;x)</code></td><td>Same as <code>x.f()</code> if <code>X</code> <a href="https://doc.rust-lang.org/std/ops/trait.Deref.html">derefs</a> to <code>S</code>, i.e., <code>x.f()</code> finds methods of <code>S</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>T::f(&amp;x)</code></td><td>Same as <code>x.f()</code> if <code>X impl T</code>, i.e., <code>x.f()</code> finds methods of <code>T</code> if in scope.</td></tr> <tr><td><code>X::f()</code></td><td>Call associated function, e.g., <code>X::new()</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>&lt;X as T&gt;::f()</code></td><td>Call trait method <code>T::f()</code> implemented for <code>X</code>.</td></tr> </tbody></table> </fixed-2-column> <h3 id="organizing-code">代码组织<sup id="target-organizing-code" class="target"><a href="#organizing-code">url</a></sup></h3> <p>将项目分割成更小的单元并最大限度地减少依赖关系。</p> <fixed-2-column> <table><thead><tr><th>示例</th><th>说明</th></tr></thead><tbody> <tr><td><code>mod m {}</code></td><td>Define a <strong>module</strong>, <a href="https://kaisery.github.io/trpl-zh-cn/ch07-02-defining-modules-to-control-scope-and-privacy.html"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/mod.html#modules"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/items&#x2F;modules.html#modules"><sup class="expert">REF</sup></a> get definition from inside <code>{}</code>. <a href="#project-anatomy"><sup>↓</sup></a></td></tr> <tr><td><code>mod m;</code></td><td>Define a module, get definition from <code>m.rs</code> or <code>m/mod.rs</code>. <a href="#project-anatomy"><sup>↓</sup></a></td></tr> <tr><td><code>a::b</code></td><td>Namespace <strong>path</strong> <a href="https://rustwiki.org/zh-CN/rust-by-example/mod&#x2F;use.html"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/paths.html"><sup class="expert">REF</sup></a> to element <code>b</code> within <code>a</code> (<code>mod</code>, <code>enum</code>, …).</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>::b</code></td><td>Search <code>b</code> relative to crate root. <sup>🗑️</sup></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>crate::b</code></td><td>Search <code>b</code> relative to crate root. <sup>&#x27;18</sup></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>self::b</code></td><td>Search <code>b</code> relative to current module.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>super::b</code></td><td>Search <code>b</code> relative to parent module.</td></tr> <tr><td><code>use a::b;</code></td><td><strong>Use</strong> <a href="https://rustwiki.org/zh-CN/rust-by-example/mod&#x2F;use.html#the-use-declaration"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/items&#x2F;use-declarations.html"><sup class="expert">REF</sup></a> <code>b</code> directly in this scope without requiring <code>a</code> anymore.</td></tr> <tr><td><code>use a::{b, c};</code></td><td>Same, but bring <code>b</code> and <code>c</code> into scope.</td></tr> <tr><td><code>use a::b as x;</code></td><td>Bring <code>b</code> into scope but name <code>x</code>, like <code>use std::error::Error as E</code>.</td></tr> <tr><td><code>use a::b as _;</code></td><td>Bring <code>b</code> anonymously into scope, useful for traits with conflicting names.</td></tr> <tr><td><code>use a::*;</code></td><td>Bring everything from <code>a</code> in, only recommended if <code>a</code> is some <strong>prelude</strong>. <a href="https:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;36384840&#x2F;what-is-the-prelude"><sup>🔗</sup></a></td></tr> <tr><td><code>pub use a::b;</code></td><td>Bring <code>a::b</code> into scope and reexport from here.</td></tr> <tr><td><code>pub T</code></td><td>&quot;Public if parent path is public&quot; <strong>visibility</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch07-02-defining-modules-to-control-scope-and-privacy.html"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/reference/visibility-and-privacy.html"><sup class="expert">REF</sup></a> for <code>T</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>pub(crate) T</code></td><td>Visible at most<sup>1</sup> in current crate.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>pub(super) T</code></td><td>Visible at most<sup>1</sup> in parent.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>pub(self) T</code></td><td>Visible at most<sup>1</sup> in current module (default, same as no <code>pub</code>).</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>pub(in a::b) T</code></td><td>Visible at most<sup>1</sup> in ancestor <code>a::b</code>.</td></tr> <tr><td><code>extern crate a;</code></td><td>Declare dependency on external <strong>crate</strong>; <a href="https://kaisery.github.io/trpl-zh-cn/ch02-00-guessing-game-tutorial.html#using-a-crate-to-get-more-functionality"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/reference/items&#x2F;extern-crates.html#extern-crate-declarations"><sup class="expert">REF</sup></a> <sup>🗑️</sup> just <code>use a::b</code> in <sup>&#x27;18</sup>.</td></tr> <tr><td><code>extern &quot;C&quot; {}</code></td><td><em>Declare</em> external dependencies and ABI (e.g., <code>&quot;C&quot;</code>) from <strong>FFI</strong>. <a href="https://kaisery.github.io/trpl-zh-cn/ch19-01-unsafe-rust.html#using-extern-functions-to-call-external-code"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/std_misc&#x2F;ffi.html#foreign-function-interface"><sup class="entry">EX</sup></a> <a href="https://nomicon.purewhite.io/ffi.html#calling-foreign-functions"><sup class="expert">NOM</sup></a> <a href="https://rustwiki.org/zh-CN/reference/items&#x2F;external-blocks.html#external-blocks"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>extern &quot;C&quot; fn f() {}</code></td><td><em>Define</em> function to be exported with ABI (e.g., <code>&quot;C&quot;</code>) to FFI.</td></tr> </tbody></table> </fixed-2-column> <footnotes> <p><sup>1</sup> 子模块中的项目始终可以访问任何项目，无论是否 <code>pub</code>。</p> </footnotes> <h3 id="type-aliases-and-casts">类型别名和转换<sup id="target-type-aliases-and-casts" class="target"><a href="#type-aliases-and-casts">url</a></sup></h3> <p>类型名称的简写，以及转为其他类型的方法。</p> <fixed-2-column> <table><thead><tr><th>示例</th><th>说明</th></tr></thead><tbody> <tr><td><code>type T = S;</code></td><td>Create a <strong>type alias</strong>, <a href="https://kaisery.github.io/trpl-zh-cn/ch19-04-advanced-types.html#creating-type-synonyms-with-type-aliases"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/reference/items&#x2F;type-aliases.html#type-aliases"><sup class="expert">REF</sup></a> i.e., another name for <code>S</code>.</td></tr> <tr><td><code>Self</code></td><td>Type alias for <strong>implementing type</strong>, <a href="https://rustwiki.org/zh-CN/reference/types.html#self-types"><sup class="expert">REF</sup></a> e.g. <code>fn new() -&gt; Self</code>.</td></tr> <tr><td><code>self</code></td><td>Method subject in <code>fn f(self) {}</code>, same as <code>fn f(self: Self) {}</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>&amp;self</code></td><td>Same, but refers to self as borrowed, same as <code>f(self: &amp;Self)</code></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>&amp;mut self</code></td><td>Same, but mutably borrowed, same as <code>f(self: &amp;mut Self)</code></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>self: Box&lt;Self&gt;</code></td><td><a href="https://github.com/withoutboats/rfcs/blob/arbitray-receivers/text/0000-century-of-the-self-type.md"><strong>Arbitrary self type</strong></a>, add methods to smart pointers (<code>my_box.f_of_self()</code>).</td></tr> <tr><td><code>S as T</code></td><td><strong>Disambiguate</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch19-03-advanced-traits.html#fully-qualified-syntax-for-disambiguation-calling-methods-with-the-same-name"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;call-expr.html#disambiguating-function-calls"><sup class="expert">REF</sup></a> type <code>S</code> as trait <code>T</code>, e.g., <code>&lt;S as T&gt;::f()</code>.</td></tr> <tr><td><code>S as R</code></td><td>In <code>use</code> of symbol, import <code>S</code> as <code>R</code>, e.g., <code>use a::S as R</code>.</td></tr> <tr><td><code>x as u32</code></td><td>Primitive <strong>cast</strong>, <a href="https://rustwiki.org/zh-CN/rust-by-example/types&#x2F;cast.html#casting"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;operator-expr.html#type-cast-expressions"><sup class="expert">REF</sup></a> may truncate and be a bit surprising. <sup>1</sup> <a href="https://nomicon.purewhite.io/casts.html"><sup class="expert">NOM</sup></a></td></tr> </tbody></table> </fixed-2-column> <footnotes> <p><sup>1</sup> 关于在类型之间转换的所有方法，请参见下面的<a href="https://nootn.com/rust-language-cheat-sheet/#type-conversions">类型转换</a>。</p> </footnotes> <h3 id="macros-attributes">宏 &amp; 属性<sup id="target-macros-attributes" class="target"><a href="#macros-attributes">url</a></sup></h3> <p>实际编译前的代码预展开。</p> <fixed-2-column> <table><thead><tr><th>示例</th><th>说明</th></tr></thead><tbody> <tr><td><code>m!()</code></td><td><strong>宏</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch19-06-macros.html"><sup class="entry">BK</sup></a> <a href="https://doc.rust-lang.org/std&#x2F;index.html#macros"><sup class="mid">STD</sup></a> <a href="https://rustwiki.org/zh-CN/reference/macros.html"><sup class="expert">REF</sup></a> 咒语，也作 <code>m!{}</code>、<code>m![]</code>（取决于宏本身）</td></tr> <tr><td><code>#[attr]</code></td><td>外部<strong>属性</strong><a href="https://rustwiki.org/zh-CN/rust-by-example/attribute.html"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/attributes.html"><sup class="expert">REF</sup></a>，注解接下来的内容。</td></tr> <tr><td><code>#![attr]</code></td><td>内部属性，注解_上部_，周边的内容。</td></tr> </tbody></table> </fixed-2-column> <div>&nbsp;</div><fixed-2-column class="color-header special_example"> <table><thead><tr><th>内部宏</th><th>说明</th></tr></thead><tbody> <tr><td><code>$x:ty</code></td><td>Macro capture (here a type); see <strong>tooling directives</strong> <a href="#tooling-directives"><sup>↓</sup></a> for details.</td></tr> <tr><td><code>$x</code></td><td>Macro substitution, e.g., use the captured <code>$x:ty</code> from above.</td></tr> <tr><td><code>$(x),*</code></td><td>Macro repetition &quot;zero or more times&quot; in macros by example.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>$(x),?</code></td><td>Same, but &quot;zero or one time&quot;.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>$(x),+</code></td><td>Same, but &quot;one or more times&quot;.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>$(x)&lt;&lt;+</code></td><td>In fact separators other than <code>,</code> are also accepted. Here: <code>&lt;&lt;</code>.</td></tr> </tbody></table> </fixed-2-column> <h3 id="pattern-matching">模式匹配<sup id="target-pattern-matching" class="target"><a href="#pattern-matching">url</a></sup></h3> <p>函数参数、<code>match</code> 或 <code>let</code> 表达式中的构造。</p> <fixed-2-column> <table><thead><tr><th>示例</th><th>说明</th></tr></thead><tbody> <tr><td><code>match m {}</code></td><td>Initiate <strong>pattern matching</strong>, <a href="https://kaisery.github.io/trpl-zh-cn/ch06-02-match.html"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/flow_control&#x2F;match.html"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;match-expr.html"><sup class="expert">REF</sup></a> then use match arms, <em>c</em>. next table.</td></tr> <tr><td><code>let S(x) = get();</code></td><td>Notably, <code>let</code> also <strong>destructures</strong> <a href="https://rustwiki.org/zh-CN/rust-by-example/flow_control&#x2F;match&#x2F;destructuring.html"><sup class="entry">EX</sup></a> similar to the table below.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>let S { x } = s;</code></td><td>Only <code>x</code> will be bound to value <code>s.x</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>let (_, b, _) = abc;</code></td><td>Only <code>b</code> will be bound to value <code>abc.1</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>let (a, ..) = abc;</code></td><td>Ignoring 'the rest' also works.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>let (.., a, b) = (1, 2);</code></td><td>Specific bindings take precedence over 'the rest', here <code>a</code> is <code>1</code>, <code>b</code> is <code>2</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>let s @ S { x } = get();</code></td><td>Bind <code>s</code> to <code>S</code> while <code>x</code> is bound to <code>s.x</code>, <strong>pattern binding</strong>, <a href="https://kaisery.github.io/trpl-zh-cn/ch18-03-pattern-syntax.html#-bindings"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/flow_control&#x2F;match&#x2F;binding.html#binding"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/patterns.html#identifier-patterns"><sup class="expert">REF</sup></a> <em>c</em>. below <sup style="font-size:100%;position:relative;top:-4px">🝖</sup></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>let w @ t @ f = get();</code></td><td>Stores 3 copies of <code>get()</code> result in each <code>w</code>, <code>t</code>, <code>f</code>. <sup style="font-size:100%;position:relative;top:-4px">🝖</sup></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>let Some(x) = get();</code></td><td><strong>Won't</strong> work <sup>🛑</sup> if pattern can be <strong>refuted</strong>, <a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;if-expr.html#if-let-expressions"><sup class="expert">REF</sup></a> use <code>if let</code> instead.</td></tr> <tr><td><code>if let Some(x) = get() {}</code></td><td>Branch if pattern can be assigned (e.g., <code>enum</code> variant), syntactic sugar. <sup>*</sup></td></tr> <tr><td><code>while let Some(x) = get() {}</code></td><td>Equiv.; here keep calling <code>get()</code>, run <code>{}</code> as long as pattern can be assigned.</td></tr> <tr><td><code>fn f(S { x }: S)</code></td><td>Function parameters also work like <code>let</code>, here <code>x</code> bound to <code>s.x</code> of <code>f(s)</code>. <sup style="font-size:100%;position:relative;top:-4px">🝖</sup></td></tr> </tbody></table> </fixed-2-column> <footnotes> <p><sup>*</sup> 展开后是 <code>match get() { Some(x) =&gt; {}, _ =&gt; () }</code>.</p> </footnotes> <div>&nbsp;</div> <p><code>match</code> 表达式的模式匹配分支。左列的分支也可用于 <code>let</code> 表达式。</p> <fixed-2-column class="color-header special_example"> <table><thead><tr><th>Within Match Arm</th><th>说明</th></tr></thead><tbody> <tr><td><code>E::A =&gt; {}</code></td><td>Match enum variant <code>A</code>, <em>c</em>. <strong>pattern matching</strong>. <a href="https://kaisery.github.io/trpl-zh-cn/ch06-02-match.html"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/flow_control&#x2F;match.html"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;match-expr.html"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>E::B ( .. ) =&gt; {}</code></td><td>Match enum tuple variant <code>B</code>, wildcard any index.</td></tr> <tr><td><code>E::C { .. } =&gt; {}</code></td><td>Match enum struct variant <code>C</code>, wildcard any field.</td></tr> <tr><td><code>S { x: 0, y: 1 } =&gt; {}</code></td><td>Match struct with specific values (only accepts <code>s</code> with <code>s.x</code> of <code>0</code> and <code>s.y</code> of <code>1</code>).</td></tr> <tr><td><code>S { x: a, y: b } =&gt; {}</code></td><td>Match struct with <em>any</em>(!) values and bind <code>s.x</code> to <code>a</code> and <code>s.y</code> to <code>b</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>S { x, y } =&gt; {}</code></td><td>Same, but shorthand with <code>s.x</code> and <code>s.y</code> bound as <code>x</code> and <code>y</code> respectively.</td></tr> <tr><td><code>S { .. } =&gt; {}</code></td><td>Match struct with any values.</td></tr> <tr><td><code>D =&gt; {}</code></td><td>Match enum variant <code>E::D</code> if <code>D</code> in <code>use</code>.</td></tr> <tr><td><code>D =&gt; {}</code></td><td>Match anything, bind <code>D</code>; possibly false friend <sup>🛑</sup> of <code>E::D</code> if <code>D</code> not in <code>use</code>.</td></tr> <tr><td><code>_ =&gt; {}</code></td><td>Proper wildcard that matches anything / &quot;all the rest&quot;.</td></tr> <tr><td><code>0 | 1 =&gt; {}</code></td><td>Pattern alternatives, <strong>or-patterns</strong>. <a href="https://rust-lang.github.io/rfcs/2535-or-patterns.html"><sup class="expert">RFC</sup></a></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>E::A | E::Z </code></td><td>Same, but on enum variants.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>E::C {x} | E::D {x}</code></td><td>Same, but bind <code>x</code> if all variants have it.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>Some(A | B)</code></td><td>Same, can also match alternatives deeply nested.</td></tr> <tr><td><code>(a, 0) =&gt; {}</code></td><td>Match tuple with any value for <code>a</code> and <code>0</code> for second.</td></tr> <tr><td><code>[a, 0] =&gt; {}</code></td><td><strong>Slice pattern</strong>, <a href="https://rustwiki.org/zh-CN/reference/patterns.html#slice-patterns"><sup class="expert">REF</sup></a> <a href="https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;edition-guide&#x2F;rust-2018&#x2F;slice-patterns.html"><sup>🔗</sup></a> match array with any value for <code>a</code> and <code>0</code> for second.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>[1, ..] =&gt; {}</code></td><td>Match array starting with <code>1</code>, any value for rest; <strong>subslice pattern</strong>. <sup>?</sup></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>[1, .., 5] =&gt; {}</code></td><td>Match array starting with <code>1</code>, ending with <code>5</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>[1, x @ .., 5] =&gt; {}</code></td><td>Same, but also bind <code>x</code> to slice representing middle (<em>c.</em> pattern binding).</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>[a, x @ .., b] =&gt; {}</code></td><td>Same, but match any first, last, bound as <code>a</code>, <code>b</code> respectively.</td></tr> <tr><td><code>1 .. 3 =&gt; {}</code></td><td><strong>Range pattern</strong>, <a href="https://kaisery.github.io/trpl-zh-cn/ch18-03-pattern-syntax.html#matching-ranges-of-values-with-"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/reference/patterns.html#range-patterns"><sup class="expert">REF</sup></a> here matches <code>1</code> and <code>2</code>; partially unstable. <sup>🚧</sup></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>1 ..= 3 =&gt; {}</code></td><td>Inclusive range pattern, matches <code>1</code>, <code>2</code> and <code>3</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>1 .. =&gt; {}</code></td><td>Open range pattern, matches <code>1</code> and any larger number.</td></tr> <tr><td><code>x @ 1..=5 =&gt; {}</code></td><td>Bind matched to <code>x</code>; <strong>pattern binding</strong>, <a href="https://kaisery.github.io/trpl-zh-cn/ch18-03-pattern-syntax.html#-bindings"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/flow_control&#x2F;match&#x2F;binding.html#binding"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/patterns.html#identifier-patterns"><sup class="expert">REF</sup></a> here <code>x</code> would be <code>1</code>, <code>2</code>, … or <code>5</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>Err(x @ Error {..}) =&gt; {}</code></td><td>Also works nested, here <code>x</code> binds to <code>Error</code>, esp. useful with <code>if</code> below.</td></tr> <tr><td><code>S { x } if x &gt; 10 =&gt; {}</code></td><td>Pattern <strong>match guards</strong>, <a href="https://kaisery.github.io/trpl-zh-cn/ch18-03-pattern-syntax.html#extra-conditionals-with-match-guards"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/flow_control&#x2F;match&#x2F;guard.html#guards"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;match-expr.html#match-guards"><sup class="expert">REF</sup></a> condition must be true as well to match.</td></tr> </tbody></table> </fixed-2-column>   <h3 id="generics-constraints">泛型 &amp; 约束<sup id="target-generics-constraints" class="target"><a href="#generics-constraints">url</a></sup></h3> <p>泛型与类型构造函数、特征和函数相结合，为用户提供了更大的灵活性。</p> <fixed-2-column> <table><thead><tr><th>示例</th><th>说明</th></tr></thead><tbody> <tr><td><code>S&lt;T&gt;</code></td><td>A <strong>generic</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch10-01-syntax.html"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/generics.html"><sup class="entry">EX</sup></a> type with a type parameter (<code>T</code> is placeholder name here).</td></tr> <tr><td><code>S&lt;T: R&gt;</code></td><td>Type short hand <strong>trait bound</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch10-02-traits.html#using-trait-bounds-to-conditionally-implement-methods"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/generics&#x2F;bounds.html"><sup class="entry">EX</sup></a> specification (<code>R</code> <em>must</em> be actual trait).</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>T: R, P: S</code></td><td><strong>Independent trait bounds</strong> (here one for <code>T</code> and one for <code>P</code>).</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>T: R, S</code></td><td>Compile error, <sup>🛑</sup> you probably want compound bound <code>R + S</code> below.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>T: R + S</code></td><td><strong>Compound trait bound</strong>, <a href="https://kaisery.github.io/trpl-zh-cn/ch10-02-traits.html#specifying-multiple-trait-bounds-with-the--syntax"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/generics&#x2F;multi_bounds.html"><sup class="entry">EX</sup></a> <code>T</code> must fulfill <code>R</code> and <code>S</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>T: R + 'a</code></td><td>Same, but w. lifetime. <code>T</code> must fulfill <code>R</code>, if <code>T</code> has lifetimes, must outlive <code>'a</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>T: ?Sized</code></td><td>Opt out of a pre-defined trait bound, here <code>Sized</code>. <sup>?</sup></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>T: 'a</code></td><td>Type <strong>lifetime bound</strong>; <a href="https://rustwiki.org/zh-CN/rust-by-example/scope&#x2F;lifetime&#x2F;lifetime_bounds.html"><sup class="entry">EX</sup></a> if T has references, they must outlive <code>'a</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>T: 'static</code></td><td>Same; does esp. <em>not</em> mean value <code>t</code> <em>will</em> <sup>🛑</sup> live <code>'static</code>, only that it could.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>'b: 'a</code></td><td>Lifetime <code>'b</code> must live at least as long as (i.e., <em>outlive</em>) <code>'a</code> bound.</td></tr> <tr><td><code>S&lt;const N: usize&gt;</code></td><td><strong>Generic const bound</strong>; <sup>?</sup> user of type <code>S</code> can provide constant value <code>N</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>S&lt;10&gt;</code></td><td>Where used, const bounds can be provided as primitive values.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>S&lt;{5+5}&gt;</code></td><td>Expressions must be put in curly brackets.</td></tr> <tr><td><code>S&lt;T&gt; where T: R</code></td><td>Almost same as <code>S&lt;T: R&gt;</code> but more pleasant to read for longer bounds.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>S&lt;T&gt; where u8: R&lt;T&gt;</code></td><td>Also allows you to make conditional statements involving <em>other</em> types.</td></tr> <tr><td><code>S&lt;T = R&gt;</code></td><td><strong>Default parameters</strong>; <a href="https://kaisery.github.io/trpl-zh-cn/ch19-03-advanced-traits.html#default-generic-type-parameters-and-operator-overloading"><sup class="entry">BK</sup></a> bit easier to use, but still flexible.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>S&lt;const N: u8 = 0&gt;</code></td><td>Default parameter for constants; e.g., in <code>f(x: S) {}</code> param <code>N</code> is <code>0</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>S&lt;T = u8&gt;</code></td><td>Default parameter for types, e.g., in <code>f(x: S) {}</code> param <code>T</code> is <code>u8</code>.</td></tr> <tr><td><code>S&lt;'_&gt;</code></td><td>Inferred <strong>anonymous lifetime</strong>; asks compiler to <em>'figure it out'</em> if obvious.</td></tr> <tr><td><code>S&lt;_&gt;</code></td><td>Inferred <strong>anonymous type</strong>, e.g., as <code>let x: Vec&lt;_&gt; = iter.collect()</code></td></tr> <tr><td><code>S::&lt;T&gt;</code></td><td><strong>Turbofish</strong> <a href="https://doc.rust-lang.org/std&#x2F;iter&#x2F;trait.Iterator.html#method.collect"><sup class="mid">STD</sup></a> call site type disambiguation, e.g. <code>f::&lt;u32&gt;()</code>.</td></tr> <tr><td><code>trait T&lt;X&gt; {}</code></td><td>A trait generic over <code>X</code>. Can have multiple <code>impl T for S</code> (one per <code>X</code>).</td></tr> <tr><td><code>trait T { type X; }</code></td><td>Defines <strong>associated type</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch19-03-advanced-traits.html#specifying-placeholder-types-in-trait-definitions-with-associated-types"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/reference/items&#x2F;associated-items.html#associated-types"><sup class="expert">REF</sup></a> <a href="https://rust-lang.github.io/rfcs/0195-associated-items.html"><sup class="expert">RFC</sup></a> <code>X</code>. Only one <code>impl T for S</code> possible.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>type X = R;</code></td><td>Set associated type within <code>impl T for S { type X = R; }</code>.</td></tr> <tr><td><code>impl&lt;T&gt; S&lt;T&gt; {}</code></td><td>Implement functionality for any <code>T</code> in <code>S&lt;T&gt;</code>, here <code>T</code> type parameter.</td></tr> <tr><td><code>impl S&lt;T&gt; {}</code></td><td>Implement functionality for exactly <code>S&lt;T&gt;</code>, here <code>T</code> specific type (e.g., <code>S&lt;u32&gt;</code>).</td></tr> <tr><td><code>fn f() -&gt; impl T</code></td><td><strong>Existential types</strong>, <a href="https://kaisery.github.io/trpl-zh-cn/ch10-02-traits.html#returning-types-that-implement-traits"><sup class="entry">BK</sup></a> returns an unknown-to-caller <code>S</code> that <code>impl T</code>.</td></tr> <tr><td><code>fn f(x: &amp;impl T)</code></td><td>Trait bound,&quot;<strong>impl traits</strong>&quot;, <a href="https://kaisery.github.io/trpl-zh-cn/ch10-02-traits.html#trait-bound-syntax"><sup class="entry">BK</sup></a> somewhat similar to <code>fn f&lt;S:T&gt;(x: &amp;S)</code>.</td></tr> <tr><td><code>fn f(x: &amp;dyn T)</code></td><td>Marker for <strong>dynamic dispatch</strong>, <a href="https://kaisery.github.io/trpl-zh-cn/ch17-02-trait-objects.html#using-trait-objects-that-allow-for-values-of-different-types"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/reference/types.html#trait-objects"><sup class="expert">REF</sup></a> <code>f</code> will not be monomorphized.</td></tr> <tr><td><code>fn f() where Self: R;</code></td><td>In <code>trait T {}</code>, make <code>f</code> accessible only on types known to also <code>impl R</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>fn f() where Self: Sized;</code></td><td>Using <code>Sized</code> can opt <code>f</code> out of <code>dyn T</code> trait object vtable, enabling trait obj.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>fn f() where Self: R {}</code></td><td>Other <code>R</code> useful w. dflt. methods (non dflt. would need be impl'ed anyway).</td></tr> <tr><td></td></tr></tbody></table></fixed-2-column><td></td>  <h3 id="higher-ranked-items">Higher-Ranked Items <sup style="font-size:100%;position:relative;top:-4px">🝖</sup><sup id="target-higher-ranked-items" class="target"><a href="#higher-ranked-items">url</a></sup></h3> <p>_真实的_类型和特征，抽象于某物之上，通常是生命周期。</p> <fixed-2-column> <table><thead><tr><th>示例</th><th>说明</th></tr></thead><tbody> <tr><td><code>for&lt;'a&gt;</code></td><td>Marker for <strong>higher-ranked bounds.</strong> <a href="https://nomicon.purewhite.io/hrtb.html"><sup class="expert">NOM</sup></a> <a href="https://rustwiki.org/zh-CN/reference/trait-bounds.html#higher-ranked-trait-bounds"><sup class="expert">REF</sup></a> <sup style="font-size:100%;position:relative;top:-4px">🝖</sup></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>trait T: for&lt;'a&gt; R&lt;'a&gt; {}</code></td><td>Any <code>S</code> that <code>impl T</code> would also have to fulfill <code>R</code> for any lifetime.</td></tr> <tr><td><code>fn(&amp;'a u8)</code></td><td><em>Fn. ptr.</em> type holding fn callable with <strong>specific</strong> lifetime <code>'a</code>.</td></tr> <tr><td><code>for&lt;'a&gt; fn(&amp;'a u8)</code></td><td><strong>Higher-ranked type</strong><sup>1</sup> <a href="https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust&#x2F;issues&#x2F;56105"><sup>🔗</sup></a> holding fn callable with <strong>any</strong> <em>lt.</em>; subtype of above.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>fn(&amp;'_ u8)</code></td><td>Same; automatically expanded to type <code>for&lt;'a&gt; fn(&amp;'a u8)</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>fn(&amp;u8)</code></td><td>Same; automatically expanded to type <code>for&lt;'a&gt; fn(&amp;'a u8)</code>.</td></tr> <tr><td><code>dyn for&lt;'a&gt; Fn(&amp;'a u8)</code></td><td>Higher-ranked (trait-object) type, works like <code>fn</code> above.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>dyn Fn(&amp;'_ u8)</code></td><td>Same; automatically expanded to type <code>dyn for&lt;'a&gt; Fn(&amp;'a u8)</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>dyn Fn(&amp;u8)</code></td><td>Same; automatically expanded to type <code>dyn for&lt;'a&gt; Fn(&amp;'a u8)</code>.</td></tr> </tbody></table> <footnotes> <p><sup>1</sup> Yes, the <code>for&lt;&gt;</code> is part of the type, which is why you write <code>impl T for for&lt;'a&gt; fn(&amp;'a u8)</code> below.</p> </footnotes> </fixed-2-column> <div class="color-header special_example"> <div>&nbsp;</div> <table><thead><tr><th>Implementing Traits</th><th>说明</th></tr></thead><tbody> <tr><td><code>impl&lt;'a&gt; T for fn(&amp;'a u8) {}</code></td><td>For fn. pointer, where call accepts <strong>specific</strong> <em>lt.</em> <code>'a</code>, impl trait <code>T</code>.</td></tr> <tr><td><code>impl T for for&lt;'a&gt; fn(&amp;'a u8) {}</code></td><td>For fn. pointer, where call accepts <strong>any</strong> <em>lt.</em>, impl trait <code>T</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>impl T for fn(&amp;u8) {}</code></td><td>Same, short version.</td></tr> </tbody></table> </div> <h3 id="strings-chars">字符串 &amp; 字符<sup id="target-strings-chars" class="target"><a href="#strings-chars">url</a></sup></h3> <p>Rust 提供了多种创建文字值的方法。</p> <fixed-2-column> <table><thead><tr><th>示例</th><th>说明</th></tr></thead><tbody> <tr><td><code>&quot;...&quot;</code></td><td><strong>String literal</strong>, <a href="https://rustwiki.org/zh-CN/reference/tokens.html#string-literals"><sup class="expert">REF</sup></a><sup>, 1</sup> UTF-8, will interpret <code>\n</code> as <em>line break</em> <code>0xA</code>, …</td></tr> <tr><td><code>r&quot;...&quot;</code></td><td><strong>Raw string literal</strong>. <a href="https://rustwiki.org/zh-CN/reference/tokens.html#raw-string-literals"><sup class="expert">REF</sup></a><sup>, 1</sup> UTF-8, won't interpret <code>\n</code>, …</td></tr> <tr><td><code>r#&quot;...&quot;#</code></td><td>Raw string literal, UTF-8, but can also contain <code>&quot;</code>. Number of <code>#</code> can vary.</td></tr> <tr><td><code>b&quot;...&quot;</code></td><td><strong>Byte string literal</strong>; <a href="https://rustwiki.org/zh-CN/reference/tokens.html#byte-and-byte-string-literals"><sup class="expert">REF</sup></a><sup>, 1</sup> constructs ASCII <code>[u8]</code>, not a string.</td></tr> <tr><td><code>br&quot;...&quot;</code>, <code>br#&quot;...&quot;#</code></td><td>Raw byte string literal, ASCII <code>[u8]</code>, combination of the above.</td></tr> <tr><td><code>'🦀'</code></td><td><strong>Character literal</strong>, <a href="https://rustwiki.org/zh-CN/reference/tokens.html#character-and-string-literals"><sup class="expert">REF</sup></a> fixed 4 byte unicode '<strong>char</strong>'. <a href="https://doc.rust-lang.org/std&#x2F;primitive.char.html"><sup class="mid">STD</sup></a></td></tr> <tr><td><code>b'x'</code></td><td>ASCII <strong>byte literal</strong>. <a href="https://rustwiki.org/zh-CN/reference/tokens.html#byte-literals"><sup class="expert">REF</sup></a></td></tr> </tbody></table> </fixed-2-column> <footnotes> <p><sup>1</sup> Supports multiple lines out of the box. Just keep in mind <code>Debug</code><a href="#string-output"><sup>↓</sup></a> (e.g., <code>dbg!(x)</code> and <code>println!(&quot;{x:?}&quot;)</code>) might render them as <code>\n</code>, while <code>Display</code><a href="#string-output"><sup>↓</sup></a> (e.g., <code>println!(&quot;{x}&quot;)</code>) renders them <em>proper</em>.</p> </footnotes> <h3 id="documentation">注释<sup id="target-documentation" class="target"><a href="#documentation">url</a></sup></h3> <p>调试人员讨厌他。用这个奇怪的技巧来避免错误。</p> <fixed-2-column> <table><thead><tr><th>示例</th><th>说明</th></tr></thead><tbody> <tr><td><code>///</code></td><td>Outer line <strong>doc comment</strong>, <a href="https://kaisery.github.io/trpl-zh-cn/ch14-02-publishing-to-crates-io.html#making-useful-documentation-comments"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/meta&#x2F;doc.html#documentation"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/comments.html#doc-comments"><sup class="expert">REF</sup></a> use these on types, traits, functions, …</td></tr> <tr><td><code>//!</code></td><td>Inner line doc comment, mostly used at start of file to document module.</td></tr> <tr><td><code>//</code></td><td>Line comment, use these to document code flow or <em>internals</em>.</td></tr> <tr><td><code>/*...*/</code></td><td>Block comment.</td></tr> <tr><td><code>/**...*/</code></td><td>Outer block doc comment.</td></tr> <tr><td><code>/*!...*/</code></td><td>Inner block doc comment.</td></tr> </tbody></table> </fixed-2-column> <footnotes> <p>Tooling directives <a href="#tooling-directives"><sup>↓</sup></a> outlines what you can do inside doc comments.</p> </footnotes> <h3 id="miscellaneous">其他<sup id="target-miscellaneous" class="target"><a href="#miscellaneous">url</a></sup></h3> <p>这些小技巧不属于其他分类但最好了解一下。</p> <fixed-2-column> <table><thead><tr><th>示例</th><th>说明</th></tr></thead><tbody> <tr><td><code>!</code></td><td>Always empty <strong>never type</strong>. <sup>🚧</sup> <a href="https://kaisery.github.io/trpl-zh-cn/ch19-04-advanced-types.html#the-never-type-that-never-returns"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/fn&#x2F;diverging.html#diverging-functions"><sup class="entry">EX</sup></a> <a href="https://doc.rust-lang.org/std&#x2F;primitive.never.html"><sup class="mid">STD</sup></a> <a href="https://rustwiki.org/zh-CN/reference/types.html#never-type"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>_</code></td><td>Unnamed variable binding, e.g., <code>|x, _| {}</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>let _ = x;</code></td><td>Unnamed assignment is no-op, does <strong>not</strong> <sup>🛑</sup> move out <code>x</code> or preserve scope!</td></tr> <tr><td><code>_x</code></td><td>Variable binding explicitly marked as unused.</td></tr> <tr><td><code>1_234_567</code></td><td>Numeric separator for visual clarity.</td></tr> <tr><td><code>1_u8</code></td><td>Type specifier for <strong>numeric literals</strong> <a href="https://rustwiki.org/zh-CN/rust-by-example/types&#x2F;literals.html#literals"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/tokens.html#number-literals"><sup class="expert">REF</sup></a> (also <code>i8</code>, <code>u16</code>, …).</td></tr> <tr><td><code>0xBEEF</code>, <code>0o777</code>, <code>0b1001</code></td><td>Hexadecimal (<code>0x</code>), octal (<code>0o</code>) and binary (<code>0b</code>) integer literals.</td></tr> <tr><td><code>r#foo</code></td><td>A <strong>raw identifier</strong> <a href="https://kaisery.github.io/trpl-zh-cn/appendix-01-keywords.html#raw-identifiers"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/compatibility&#x2F;raw_identifiers.html#raw-identifiers"><sup class="entry">EX</sup></a> for edition compatibility. <sup style="font-size:100%;position:relative;top:-4px">🝖</sup></td></tr> <tr><td><code>x;</code></td><td><strong>Statement</strong> <a href="https://rustwiki.org/zh-CN/reference/statements.html"><sup class="expert">REF</sup></a> terminator, <em>c</em>. <strong>expressions</strong> <a href="https://rustwiki.org/zh-CN/rust-by-example/expression.html"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/expressions.html"><sup class="expert">REF</sup></a></td></tr> </tbody></table> </fixed-2-column> <h3 id="common-operators">通用运算符<sup id="target-common-operators" class="target"><a href="#common-operators">url</a></sup></h3> <p>Rust 支持大部分其他语言也有的通用操作符（<code>+</code>, <code>*</code>, <code>%</code>, <code>=</code>, <code>==</code>, …），包含<strong>运算符重载</strong><a href="https://doc.rust-lang.org/std&#x2F;ops&#x2F;index.html"><sup class="mid">STD</sup></a>。因为这在 Rust 里没什么太大差别所以这里不列出来了。</p> <hr> <magic> <h1 id="behind-the-scenes">Behind the Scenes<sup id="target-behind-the-scenes" class="target"><a href="#behind-the-scenes">url</a></sup></h1> <p>强烈推荐那些可能会对你的思想造成可怕影响的神秘知识。</p> <h2 id="the-abstract-machine">机器抽象<sup id="target-the-abstract-machine" class="target"><a href="#the-abstract-machine">url</a></sup></h2> <p>与<code>C</code>和<code>C++</code>一样，Rust 也是基于机器抽象的。</p> <tabs>  <tab> <input type="radio" id="tab-abstract-machine-1" name="tab-group-abstract-machine" checked> <label for="tab-abstract-machine-1"><b>概述</b></label> <panel><div> <div style="text-align:center"> <mini-zoo class="zoo" style="text-align:center"> <entry> <machine class="bad">Rust</machine> </entry> <code style="text-align:center">→</code> <entry> <machine class="bad">CPU</machine> </entry> <br> <note><sup>🛑</sup> 不那么准确。</note> </mini-zoo> <mini-zoo class="zoo" style="text-align:center;margin-left:80px"> <entry> <machine class="good">Rust</machine> </entry> <code style="text-align:center">→</code> <entry style="width:120px"> <machine class="good">机器抽象</machine> </entry> <code style="text-align:center">→</code> <entry> <machine class="good">CPU</machine> </entry> <br> <note>更正。</note> </mini-zoo> </div> <div>&nbsp;</div> <p>机器抽象</p> <ul> <li>不是运行时，也没有任何运行时的开销，而是_计算模型的抽象_，</li> <li>包含诸如内存区域（堆栈，...），执行语义等概念，</li> <li><em>knows</em> and <em>sees</em> things your CPU might not care about,</li> <li>在程序员和机器之间形成契约，</li> <li>并且<strong>利用上述所有内容进行优化</strong>。</li> </ul> </div></panel></tab>  <tab> <input type="radio" id="tab-abstract-machine-2" name="tab-group-abstract-machine"> <label for="tab-abstract-machine-2"><b>误解</b></label> <panel><div> <div class="abstract-machine color-header"> <p>Things people may incorrectly assume they <em>should get away with</em> if Rust targeted CPU directly, and <em>more correct</em> counterparts: 如果 Rust 直接针对 CPU，人们可能会错误地认为他们可以_肆无忌惮_，而_更正确_的做法是：</p> <div>&nbsp;</div><table><thead><tr><th>Without AM</th><th>With AM</th></tr></thead><tbody> <tr><td><code>0xffff_ffff</code> would make a valid <code>char</code>. <sup>🛑</sup></td><td>Memory more than just bits.</td></tr> <tr><td><code>0xff</code> and <code>0xff</code> are same pointer. <sup>🛑</sup></td><td>Pointers can come from different <em>domains</em>.</td></tr> <tr><td>Any r/w pointer on <code>0xff</code> always fine. <sup>🛑</sup></td><td>Read and write reference may not exist same time.</td></tr> <tr><td>Null reference is just <code>0x0</code> in some register. <sup>🛑</sup></td><td>Holding <code>0x0</code> in reference summons Cthulhu.</td></tr> </tbody></table> </div> </div></panel></tab> </tabs>       <h2 id="language-sugar">语法糖<sup id="target-language-sugar" class="target"><a href="#language-sugar">url</a></sup></h2> <p>如果有什么东西让你觉得，“不该能用的啊”，那可能就是这里的原因。</p> <div class="color-header language-sugar"> <table><thead><tr><th>名称</th><th>说明</th></tr></thead><tbody> <tr><td><strong>Coercions</strong> <a href="https://nomicon.purewhite.io/coercions.html"><sup class="expert">NOM</sup></a></td><td><em>Weakens</em> types to match signature, e.g., <code>&amp;mut T</code> to <code>&amp;T</code>; <em>c</em>. <em>type conversions</em>. <a href="#type-conversions"><sup>↓</sup></a></td></tr> <tr><td><strong>Deref</strong> <a href="https://nomicon.purewhite.io/vec-deref.html"><sup class="expert">NOM</sup></a> <a href="https:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;28519997&#x2F;what-are-rusts-exact-auto-dereferencing-rules"><sup>🔗</sup></a></td><td><a href="https://doc.rust-lang.org/std/ops/trait.Deref.html">Derefs</a> <code>x: T</code> until <code>*x</code>, <code>**x</code>, … compatible with some target <code>S</code>.</td></tr> <tr><td><strong>Prelude</strong> <a href="https://doc.rust-lang.org/std&#x2F;prelude&#x2F;index.html"><sup class="mid">STD</sup></a></td><td>Automatic import of basic items, e.g., <code>Option</code>, <code>drop</code>, ...</td></tr> <tr><td><strong>Reborrow</strong></td><td>Since <code>x: &amp;mut T</code> can't be copied; moves new <code>&amp;mut *x</code> instead.</td></tr> <tr><td><strong>Lifetime Elision</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch10-03-lifetime-syntax.html#lifetime-elision"><sup class="entry">BK</sup></a> <a href="https://nomicon.purewhite.io/lifetime-elision.html#lifetime-elision"><sup class="expert">NOM</sup></a> <a href="https://rustwiki.org/zh-CN/reference/lifetime-elision.html#lifetime-elision"><sup class="expert">REF</sup></a></td><td>Automatically annotates <code>f(x: &amp;T)</code> to <code>f&lt;'a&gt;(x: &amp;'a T)</code>.</td></tr> <tr><td><strong>Method Resolution</strong> <a href="https://rustwiki.org/zh-CN/reference/expressions&#x2F;method-call-expr.html"><sup class="expert">REF</sup></a></td><td>Derefs or borrow <code>x</code> until <code>x.f()</code> works.</td></tr> <tr><td><strong>Match Ergonomics</strong> <a href="https://rust-lang.github.io/rfcs/2005-match-ergonomics.html"><sup class="expert">RFC</sup></a></td><td>Repeatedly dereferences <a href="https://doc.rust-lang.org/stable/reference/glossary.html#scrutinee">scrutinee</a> and adds <code>ref</code> and <code>ref mut</code> to bindings.</td></tr> <tr><td><strong>Rvalue Static Promotion</strong> <a href="https://rust-lang.github.io/rfcs/1414-rvalue_static_promotion.html"><sup class="expert">RFC</sup></a></td><td>Makes references to constants <code>'static</code>, e.g., <code>&amp;42</code>, <code>&amp;None</code>, <code>&amp;mut []</code>.</td></tr> </tbody></table> </div> <div>&nbsp;</div> <blockquote> <p><strong>意见</strong> <sup>💬</sup> — 尽管上面的特性将使简化了开发工作，但它们也会对理解当前发生了什么造成可能的妨碍。如果你对 Rust 还不太了解，想要搞明白到底发生了什么，你应该更详细地阅读相关资料。</p> </blockquote> <h2 id="memory-lifetimes">内存 &amp; 生命周期<sup id="target-memory-lifetimes" class="target"><a href="#memory-lifetimes">url</a></sup></h2> <p>为什么移动、引用和生命周期是这样的。</p> <tabs class="lifetimes">  <tab> <input type="radio" id="tab-lt-1" name="tab-lt" checked> <label for="tab-lt-1"><b>类型 & 移动</b></label> <panel> <div> <lifetime-section> <lifetime-example> <section-header>应用程序内存</section-header> <memory-row> <memory-backdrop> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <values> <value class="byte2 hide t" style="left:57px">S(1)</value> </values> <labels> <label style="right:10px">&nbsp;</label> </labels> <subtext>应用程序内存</subtext> </memory-row> </lifetime-example> <explanation> <ul> <li>应用程序内存只是低级别的字节数组。</li> <li>操作环境通常分为以下几个部分： <ul> <li><strong>栈(Stack)</strong>（小，低开销内存<sup>1</sup>，大多数_变量_都放在这里），</li> <li><strong>堆(Heap)</strong>（大而灵活的内存，但总是通过栈代理处理，如 <code>Box&lt;T&gt;</code>），</li> <li><strong>静态(static)</strong>（最常用作 <code>&amp;str</code> 的 <code>str</code> 部分来使用），</li> <li><strong>代码(code)</strong>（函数的位码所在的位置）。</li> </ul> </li> <li>最棘手的部分与<strong>栈如何演变</strong>有关，这是<strong>我们的重点</strong>。</li> </ul> <footnotes> <p><sup>1</sup> 对于固定大小的值，栈很容易管理：<em>在需要时多占用几个字符，离开后丢弃</em>。然而，给出指向这些_瞬态_位置的指针构成了_生命周期_存在的本质；并且是本章其余部分的主题。</p> </footnotes> </explanation> </lifetime-section> <lifetime-section> <lifetime-example class="not-first"> <section-header>变量</section-header> <memory-row> <memory-backdrop> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <values> <value class="byte2 hide t" style="left:57px">S(1)</value> <value class="byte2 t" style="left:97.5px">S(1)</value> </values> <labels> <label class="byte2 hide" style="left:57px"><code>a</code></label> <label class="byte2" style="left:97.5px"><code>t</code></label> </labels> <subtext>变量</subtext>  </memory-row> </lifetime-example> <explanation> <pre><code>let t = S(1);
</code></pre> <ul> <li>Reserves memory location with name <code>t</code> of type <code>S</code> and the value <code>S(1)</code> stored inside.</li> <li>If declared with <code>let</code> that location lives on stack. <sup>1</sup></li> <li>Note the <strong>linguistic ambiguity</strong>,<sup>2</sup> in the term <strong><em>variable</em></strong>, it can mean the: <ol> <li><strong>name</strong> of the location in the source file (&quot;rename that variable&quot;),</li> <li><strong>location</strong> in a compiled app, <code>0x7</code> (&quot;tell me the address of that variable&quot;),</li> <li><strong>value</strong> contained within, <code>S(1)</code> (&quot;increment that variable&quot;).</li> </ol> </li> <li>Specifically towards the compiler <code>t</code> can mean <strong>location of</strong> <code>t</code>, here <code>0x7</code>, and <strong>value within</strong> <code>t</code>, here <code>S(1)</code>.</li> </ul> <footnotes> <p><sup>1</sup> Compare above,<a href="#data-structures"><sup>↑</sup></a> true for fully synchronous code, but <code>async</code> stack frame might placed it on heap via runtime.</p> </footnotes> </explanation> </lifetime-section> <lifetime-section> <lifetime-example class="not-first"> <section-header>Move Semantics</section-header> <memory-row> <memory-backdrop> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <values> <value class="byte2 t" style="left:57px">S(1)</value> </values> <labels> <label class="byte2" style="left:57px"><code>a</code></label> <label class="byte2" style="left:97.5px"><code>t</code></label> </labels> <subtext>Moves</subtext>  </memory-row> </lifetime-example> <explanation> <pre><code>let a = t;
</code></pre> <ul> <li>This will <strong>move</strong> value within <code>t</code> to location of <code>a</code>, or copy it, if <code>S</code> is <code>Copy</code>.</li> <li>After move location <code>t</code> is <strong>invalid</strong> and cannot be read anymore. <ul> <li>Technically the bits at that location are not really <em>empty</em>, but <em>undefined</em>.</li> <li>If you still had access to <code>t</code> (via <code>unsafe</code>) they might still <em>look</em> like valid <code>S</code>, but any attempt to use them as valid <code>S</code> is undefined behavior. <a href="#unsafe-unsound-undefined"><sup>↓</sup></a></li> </ul> </li> <li>We do not cover <code>Copy</code> types explicitly here. They change the rules a bit, but not much: <ul> <li>They won't be dropped.</li> <li>They never leave behind an 'empty' variable location.</li> </ul> </li> </ul> </explanation> </lifetime-section> <lifetime-section> <lifetime-example class="not-first"> <section-header>Type Safety</section-header> <memory-row> <memory-backdrop> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <values> <failed style="left:231.5px"><value class="atomic byte4">M { ... }</value></failed> <denied style="left:141px">⛔</denied> </values> <labels> <label class="byte2" style="left:57px"><code></code></label> <label class="byte2" style="left:170px"><code>c</code></label> </labels> <subtext>Type Safety</subtext>  </memory-row> </lifetime-example> <explanation> <pre><code>let c: S = M::new();
</code></pre> <ul> <li>The <strong>type of a variable</strong> serves multiple important purposes, it: <ol> <li>dictates how the underlying bits are to be interpreted,</li> <li>allows only well-defined operations on these bits</li> <li>prevents random other values or bits from being written to that location.</li> </ol> </li> <li>Here assignment fails to compile since the bytes of <code>M::new()</code> cannot be converted to form of type <code>S</code>.</li> <li><strong>Conversions between types will <em>always</em> fail</strong> in general, <strong>unless explicit rule allows it</strong> (coercion, cast, …).</li> </ul> </explanation> </lifetime-section> <lifetime-section> <lifetime-example class="not-first"> <section-header>Scope & Drop</section-header> <memory-row> <memory-backdrop> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <values> <drop><value class="byte2 t" style="left:57px">S(1)</value><droparrow style="left:37px">▼</droparrow></drop> <value class="byte2 hide t" style="left:87.5px">C(2)</value> <drop><value class="byte2 t" style="left:128px">S(2)</value><droparrow style="left:107px">▼</droparrow></drop> <failed style="left:-27.5px"><value class="byte2 t" style="left:128px">S(3)</value></failed> </values> <labels> <label class="byte2" style="left:57px"><code></code></label> <label class="byte2" style="left:97.5px"><code>t</code></label>  </labels> <subtext>Scope & Drop</subtext>  </memory-row> </lifetime-example> <explanation> <pre><code>{
    let mut c = S(2);
    c = S(3);  &#x2F;&#x2F; &lt;- Drop called on `c` before assignment.
    let t = S(1);
    let a = t;
}   &#x2F;&#x2F; &lt;- Scope of `a`, `t`, `c` ends here, drop called on `a`, `c`.
</code></pre> <ul> <li>Once the 'name' of a non-vacated variable goes out of (drop-)<strong>scope</strong>, the contained value is <strong>dropped</strong>. <ul> <li>Rule of thumb: execution reaches point where name of variable leaves <code>{}</code>-block it was defined in</li> <li>In detail more tricky, esp. temporaries, …</li> </ul> </li> <li>Drop also invoked when new value assigned to existing variable location.</li> <li>In that case <strong><code>Drop::drop()</code></strong> is called on the location of that value. <ul> <li>In the example above <code>drop()</code> is called on <code>a</code>, twice on <code>c</code>, but not on <code>t</code>.</li> </ul> </li> <li>Most non-<code>Copy</code> values get dropped most of the time; exceptions include <code>mem::forget()</code>, <code>Rc</code> cycles, <code>abort()</code>.</li> </ul> </explanation> </lifetime-section> </div></panel></tab>  <tab> <input type="radio" id="tab-lt-2" name="tab-lt"> <label for="tab-lt-2"><b>Call Stack</b></label> <panel><div> <lifetime-section> <lifetime-example> <section-header>Stack Frame</section-header> <memory-row> <memory-backdrop> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <values> <value class="byte2 t" style="left:57px">S(1)</value> </values> <labels> <label class="byte2" style="left:57px"><code>a</code></label> <label class="byte2" style="left:97.5px"><code>x</code></label> </labels> <subtext>Function Boundaries</subtext>  </memory-row> </lifetime-example> <explanation> <pre><code>fn f(x: S) { ... }

let a = S(1); &#x2F;&#x2F; &lt;- We are here
f(a);
</code></pre> <ul> <li>When a <strong>function is called</strong>, memory for parameters (and return values) are reserved on stack.<sup>1</sup></li> <li>Here before <code>f</code> is invoked value in <code>a</code> is moved to 'agreed upon' location on stack, and during <code>f</code> works like 'local variable' <code>x</code>.</li> </ul> <footnotes> <p><sup>1</sup> Actual location depends on calling convention, might practically not end up on stack at all, but that doesn't change mental model.</p> </footnotes> </explanation> </lifetime-section> <lifetime-section> <lifetime-example class="not-first"> <memory-row> <memory-backdrop> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <values> <value class="byte2 t" style="left:131px">S(1)</value> </values> <labels> <label class="byte2" style="left:57px"><code>a</code></label> <label class="byte2" style="left:97.5px"><code>x</code></label> <label class="byte2" style="left:136px"><code>x</code></label> </labels> <subtext>Nested Functions</subtext>  </memory-row> </lifetime-example> <explanation> <pre><code>fn f(x: S) {
    if once() { f(x) } &#x2F;&#x2F; &lt;- We are here (before recursion)
}

let a = S(1);
f(a);
</code></pre> <ul> <li><strong>Recursively calling</strong> functions, or calling other functions, likewise extends the stack frame.</li> <li>Nesting too many invocations (esp. via unbounded recursion) will cause stack to grow, and eventually to overflow, terminating the app.</li> </ul> </explanation> </lifetime-section> <lifetime-section> <lifetime-example class="not-first"> <section-header>Validity of Variables</section-header> <memory-row> <memory-backdrop> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t" style="opacity:.4"></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <values> <value class="byte2 t" style="left:131px">S(1)</value> <value class="atomic byte4" style="left:190px">M { }</value> </values> <labels> <label class="byte2" style="left:57px"><code>a</code></label> <label class="byte2" style="left:97.5px"><code>x</code></label> <label class="byte2" style="left:174px"><code>m</code></label> </labels> <subtext>Repurposing Memory</subtext>  </memory-row> </lifetime-example> <explanation> <pre><code>fn f(x: S) {
    if once() { f(x) }
    let m = M::new() &#x2F;&#x2F; &lt;- We are here (after recursion)
}

let a = S(1);
f(a);
</code></pre> <ul> <li>Stack that previously held a certain type will be repurposed across (even within) functions.</li> <li>Here, recursing on <code>f</code> produced second <code>x</code>, which after recursion was partially reused for <code>m</code>.</li> </ul> <blockquote> <p>Key take away so far, there are multiple ways how memory locations that previously held a valid value of a certain type stopped doing so in the meantime. As we will see shortly, this has implications for pointers.</p> </blockquote> </explanation> </lifetime-section> </div></panel></tab>  <tab> <input type="radio" id="tab-lt-3" name="tab-lt"> <label for="tab-lt-3"><b>References & Pointers</b></label> <panel><div> <lifetime-section> <lifetime-example> <section-header class="arrowed">Reference Types</section-header> <memory-row> <arrows> <arrow style="left:62px;width:176px">&nbsp;<tip>▼</tip></arrow> </arrows> <memory-backdrop> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <values> <value class="byte2 t" style="left:57px">S(1)</value> <value class="byte4 ptr" style="left:171px">0x3</value> </values> <labels> <label class="byte2" style="left:57px"><code>a</code></label> <label class="byte4" style="left:171px"><code>r</code></label> </labels> <subtext>References as Pointers</subtext>  </memory-row> </lifetime-example> <explanation> <pre><code>let a = S(1);
let r: &amp;S = &amp;a;
</code></pre> <ul> <li>A <strong>reference type</strong> such as <code>&amp;S</code> or <code>&amp;mut S</code> can hold the <strong>location of</strong> some <code>s</code>.</li> <li>Here type <code>&amp;S</code>, bound as name <code>r</code>, holds <em>location of</em> variable <code>a</code> (<code>0x3</code>), that must be type <code>S</code>, obtained via <code>&amp;a</code>.</li> <li>If you think of variable <code>c</code> as <em>specific location</em>, reference <strong><code>r</code> is a <em>switchboard for locations</em></strong>.</li> <li>The type of the reference, like all other types, can often be inferred, so we might omit it from now on:<pre><code>let r: &amp;S = &amp;a;
let r = &amp;a;
</code></pre> </li> </ul>  </explanation> </lifetime-section> <lifetime-section> <lifetime-example class="not-first"> <section-header class="arrowed">(Mutable) References</section-header> <memory-row> <arrows> <arrow style="left:62px;width:176px">&nbsp;<tip>▼</tip></arrow> </arrows> <memory-backdrop> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <values> <value class="byte2 t" style="left:57px">S(2)</value> <value class="byte4 ptr" style="left:171px">0x3</value> <value class="byte2 t" style="left:213px">S(1)</value> </values> <labels> <label class="byte2" style="left:57px"><code>a</code></label> <label class="byte4" style="left:171px"><code>r</code></label> <label class="byte4" style="left:193px"><code>d</code></label> </labels> <subtext>Access to Non-Owned Memory</subtext>  </memory-row> </lifetime-example> <explanation> <pre><code>let mut a = S(1);
let r = &amp;mut a;
let d = r.clone();  &#x2F;&#x2F; Valid to clone (or copy) from r-target.
*r = S(2);          &#x2F;&#x2F; Valid to set new S value to r-target.
</code></pre> <ul> <li>References can <strong>read from</strong> (<code>&amp;S</code>) and also <strong>write to</strong> (<code>&amp;mut S</code>) location they point to.</li> <li>The <em>dereference</em> <code>*r</code> means to neither use the <em>location of</em> or <em>value within</em> <code>r</code>, but the <strong>location <code>r</code> points to</strong>.</li> <li>In example above, clone <code>d</code> is created from <code>*r</code>, and <code>S(2)</code> written to <code>*r</code>. <ul> <li>Method <code>Clone::clone(&amp;T)</code> expects a reference itself, which is why we can use <code>r</code>, not <code>*r</code>.</li> <li>On assignment <code>*r = ...</code> old value in location also dropped (not shown above).</li> </ul> </li> </ul> </explanation> </lifetime-section> <lifetime-section> <lifetime-example class="not-first"> <memory-row> <arrows> <arrow style="left:62px;width:176px">&nbsp;<tip>▼</tip></arrow> </arrows> <memory-backdrop> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <values> <value class="byte2 hide t" style="left:57px">S(2)</value> <value class="byte4 ptr" style="left:171px">0x3</value> <value class="atomic byte4" style="top:-36px;left:20px">M { x }</value> <denied style="left:-71px;top:-36px">⛔</denied> <denied style="left:-131px">⛔</denied> </values> <labels> <label class="byte2" style="left:57px"><code>a</code></label> <label class="byte4" style="left:171px"><code>r</code></label> <label class="byte4" style="left:193px"><code>d</code></label> </labels> <subtext>References Guard Referents</subtext>  </memory-row> </lifetime-example> <explanation> <pre><code>let mut a = ...;
let r = &amp;mut a;
let d = *r;       &#x2F;&#x2F; Invalid to move out value, `a` would be empty.
*r = M::new();    &#x2F;&#x2F; invalid to store non S value, doesn&#x27;t make sense.
</code></pre> <ul> <li>While bindings guarantee to always <em>hold</em> valid data, references guarantee to always <em>point to</em> valid data.</li> <li>Esp. <code>&amp;mut T</code> must provide same guarantees as variables, and some more as they can't dissolve the target: <ul> <li>They do <strong>not allow writing invalid</strong> data.</li> <li>They do <strong>not allow moving out</strong> data (would leave target empty w/o owner knowing).</li> </ul> </li> </ul> </explanation> </lifetime-section> <lifetime-section> <lifetime-example class="not-first"> <memory-row> <arrows> <arrow style="left:62px;width:176px;border-color:red">&nbsp;<tip style="color:red">▼</tip></arrow> </arrows> <memory-backdrop> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <values> <value class="byte2 hide t" style="left:57px">C(2)</value> <value class="byte4 ptr unsafe" style="left:171px">0x3</value> </values> <labels> <label class="byte2 hide" style="left:57px"><code>c</code></label> <label class="byte4" style="left:171px"><code>p</code></label> </labels> <subtext>Raw Pointers</subtext>  </memory-row> </lifetime-example> <explanation> <pre><code>let p: *const S = questionable_origin();
</code></pre> <ul> <li>In contrast to references, pointers come with almost no guarantees.</li> <li>They may point to invalid or non-existent data.</li> <li>Dereferencing them is <code>unsafe</code>, and treating an invalid <code>*p</code> as if it were valid is undefined behavior. <a href="#unsafe-unsound-undefined"><sup>↓</sup></a></li> </ul> </explanation> </lifetime-section> </div></panel></tab>  <tab> <input type="radio" id="tab-lt-10" name="tab-lt"> <label for="tab-lt-10"><b>Lifetime Basics</b></label> <panel><div> <lifetime-section> <lifetime-example> <memory-row> <memory-backdrop class="past" style="padding-left:7px"> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <memory-backdrop class="past" style="padding-left:3px"> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <memory-backdrop> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <values> <value class="byte2 hide t" style="left:57px">C(2)</value> <value class="byte4 hide ptr" style="left:171px">0x3</value> </values> <labels>  </labels> <subtext>"Lifetime" of Things</subtext>  </memory-row> </lifetime-example> <explanation> <ul> <li>Every entity in a program has some (temporal / spatial) room where it is relevant, i.e., <em>alive</em>.</li> <li>Loosely speaking, this <em>alive time</em> can be<sup>1</sup> <ol> <li>the <strong>LOC</strong> (lines of code) where an <strong>item is available</strong> (e.g., a module name).</li> <li>the <strong>LOC</strong> between when a <em>location</em> is <strong>initialized</strong> with a value, and when the location is <strong>abandoned</strong>.</li> <li>the <strong>LOC</strong> between when a location is first <strong>used in a certain way</strong>, and when that <strong>usage stops</strong>.</li> <li>the <strong>LOC (or actual time)</strong> between when a <em>value</em> is created, and when that value is dropped.</li> </ol> </li> <li>Within the rest of this section, we will refer to the items above as the: <ol> <li><strong>scope</strong> of that item, irrelevant here.</li> <li><strong>scope</strong> of that variable or location.</li> <li><strong>lifetime</strong><sup>2</sup> of that usage.</li> <li><strong>lifetime</strong> of that value, might be useful when discussing open file descriptors, but also irrelevant here.</li> </ol> </li> <li>Likewise, lifetime parameters in code, e.g., <code>r: &amp;'a S</code>, are <ul> <li>concerned with LOC any <strong>location r <em>points to</em></strong> needs to be accessible or locked;</li> <li>unrelated to the 'existence time' (as LOC) of <code>r</code> itself (well, it needs to exist shorter, that's it).</li> </ul> </li> <li><code>&amp;'static S</code> means address must be <em>valid during all lines of code</em>.</li> </ul> <blockquote> <p><sup>1</sup> There is sometimes ambiguity in the docs differentiating the various <em>scopes</em> and <em>lifetimes</em>. We try to be pragmatic here, but suggestions are welcome.</p> <p><sup>2</sup> <em>Live lines</em> might have been a more appropriate term ...</p> </blockquote> </explanation> </lifetime-section> <lifetime-section> <lifetime-example class="not-first"> <memory-row> <memory-backdrop class="past" style="padding-left:7px"> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <memory-backdrop class="past" style="padding-left:3px"> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <arrows> <arrow style="left:192px;width:120px">&nbsp;<tip>▼</tip></arrow> </arrows> <memory-backdrop> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <values> <value class="byte2 hide t" style="left:38px">S(0)</value> <value class="byte2 hide t" style="left:79px">S(1)</value> <value class="byte2 t" style="left:119px">S(2)</value> <value class="byte4 ptr" style="left:177px">0xa</value> </values> <labels> <label class="byte2 hide" style="left:37px"><code>a</code></label> <label class="byte2 hide" style="left:78px"><code>b</code></label> <label class="byte2" style="left:118px"><code>c</code></label> <label class="byte4" style="left:177px"><code>r</code></label> </labels> <subtext>Meaning of <code>r: &'c S</code></subtext>  </memory-row> </lifetime-example> <explanation> <ul> <li>Assume you got a <code>r: &amp;'c S</code> from somewhere it means: <ul> <li><code>r</code> holds an address of some <code>S</code>,</li> <li>any address <code>r</code> points to must and will exist for at least <code>'c</code>,</li> <li>the variable <code>r</code> itself cannot live longer than <code>'c</code>.</li> </ul> </li> </ul> </explanation> </lifetime-section> <lifetime-section> <lifetime-example class="not-first"> <memory-row> <memory-backdrop class="past" style="padding-left:7px"> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <memory-backdrop class="past" style="padding-left:3px"> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <arrows> <arrow style="left:118px;width:193px">&nbsp;<tip>▼</tip></arrow> </arrows> <memory-backdrop> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <values> <value class="byte2 t" style="left:38px">S(0)</value> <value class="byte2 t" style="left:79px">S(3)</value> <value class="byte2 t" style="left:119px">S(2)</value> <value class="byte4 ptr" style="left:177px">0x6</value> <denied style="left:-125px;top:-25px">⛔</denied> </values> <labels> <label class="byte2" style="left:37px"><code>a</code></label> <label class="byte2" style="left:78px"><code>b</code></label> <label class="byte2" style="left:118px"><code>c</code></label> <label class="byte4" style="left:177px"><code>r</code></label> </labels> <subtext>Typelikeness of Lifetimes</subtext>  </memory-row> </lifetime-example> <explanation> <pre><code>{
    let b = S(3);
    {
        let c = S(2);
        let r: &amp;&#x27;c S = &amp;c;      &#x2F;&#x2F; Does not quite work since we can&#x27;t name lifetimes of local
        {                       &#x2F;&#x2F; variables in a function body, but very same principle applies
            let a = S(0);       &#x2F;&#x2F; to functions next page.

            r = &amp;a;             &#x2F;&#x2F; Location of `a` does not live sufficient many lines -&gt; not ok.
            r = &amp;b;             &#x2F;&#x2F; Location of `b` lives all lines of `c` and more -&gt; ok.
        }
    }
}
</code></pre> <ul> <li>Assume you got a <code>mut r: &amp;mut 'c S</code> from somewhere. <ul> <li>That is, a mutable location that can hold a mutable reference.</li> </ul> </li> <li>As mentioned, that reference must guard the targeted memory.</li> <li>However, the <strong><code>'c</code> part</strong>, like a type, also <strong>guards what is allowed into <code>r</code></strong>.</li> <li>Here assiging <code>&amp;b</code> (<code>0x6</code>) to <code>r</code> is valid, but <code>&amp;a</code> (<code>0x3</code>) would not, as only <code>&amp;b</code> lives equal or longer than <code>&amp;c</code>.</li> </ul> </explanation> </lifetime-section> <lifetime-section> <lifetime-example class="not-first"> <memory-row> <memory-backdrop class="past" style="padding-left:7px"> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <memory-backdrop class="past" style="padding-left:3px"> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <arrows> <arrow style="left:118px;width:193px">&nbsp;<tip>▼</tip></arrow> </arrows> <memory-backdrop> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="borrowed t"></byte> <byte class="borrowed t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <values> <value class="byte2 hide t" style="left:38px">S(0)</value> <value class="byte2 t" style="left:79px">&nbsp;</value> <value class="byte2 hide t" style="left:119px">S(2)</value> <value class="byte4 ptr" style="left:177px">0x6</value> <failed style="left:-40px"><value class="bytes t">S(4)</value></failed> <denied style="left:-83px">⛔</denied> </values> <labels> <label class="byte2 hide" style="left:37px"><code>a</code></label> <label class="byte2" style="left:78px"><code>b</code></label> <label class="byte2 hide" style="left:118px"><code>c</code></label> <label class="byte4 hide" style="left:177px"><code></code></label> </labels> <subtext>Borrowed State</subtext> </memory-row> </lifetime-example> <explanation> <pre><code>let mut b = S(0);
let r = &amp;mut b;

b = S(4);   &#x2F;&#x2F; Will fail since `b` in borrowed state.

print_byte(r);
</code></pre> <ul> <li>Once the address of a variable is taken via <code>&amp;b</code> or <code>&amp;mut b</code> the variable is marked as <strong>borrowed</strong>.</li> <li>While borrowed, the content of the address cannot be modified anymore via original binding <code>b</code>.</li> <li>Once address taken via <code>&amp;b</code> or <code>&amp;mut b</code> stops being used (in terms of LOC) original binding <code>b</code> works again.</li> </ul> </explanation> </lifetime-section> </div></panel></tab>  <tab> <input type="radio" id="tab-lt-11" name="tab-lt"> <label for="tab-lt-11"><b>Lifetimes in Functions</b></label> <panel> <div> <lifetime-section> <lifetime-example> <memory-row> <memory-backdrop class="past" style="padding-left:7px"> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <memory-backdrop class="past" style="padding-left:3px"> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <memory-backdrop> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="borrowed t"></byte> <byte class="borrowed t"></byte> <byte></byte> <byte></byte> <byte class="borrowed t"></byte> <byte class="borrowed t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <values> <value class="byte2 hide t" style="left:38px">S(0)</value> <value class="byte2 t" style="left:79px">S(1)</value> <value class="byte2 t" style="left:119px">S(2)</value> <value class="byte4 ptr" style="left:177px">?</value> <value class="byte4 ptr" style="left:201px">0x6</value> <value class="byte4 ptr" style="left:224px">0xa</value> </values> <labels> <label class="byte2 hide" style="left:37px"><code>a</code></label> <label class="byte4" style="left:59px"><code>b</code></label> <label class="byte2" style="left:81px"><code>c</code></label> <label class="byte4" style="left:139px"><code>r</code></label> <label class="byte4" style="left:165px"><code>x</code></label> <label class="byte4" style="left:188px"><code>y</code></label> </labels> <subtext>Function Parameters</subtext>  </memory-row> </lifetime-example> <explanation> <pre><code>fn f(x: &amp;S, y:&amp;S) -&gt; &amp;u8 { ... }

let b = S(1);
let c = S(2);

let r = f(&amp;b, &amp;c);
</code></pre> <ul> <li>When calling functions that take and return references two interesting things happen: <ul> <li>The used local variables are placed in a borrowed state,</li> <li>But it is during compilation unknown which address will be returned.</li> </ul> </li> </ul> </explanation> </lifetime-section> <lifetime-section> <lifetime-example class="not-first"> <memory-row> <memory-backdrop class="past" style="padding-left:7px"> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <memory-backdrop class="past" style="padding-left:3px"> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <memory-backdrop> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="maybe-borrowed t"></byte> <byte class="maybe-borrowed t"></byte> <byte></byte> <byte></byte> <byte class="maybe-borrowed t"></byte> <byte class="maybe-borrowed t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <values> <value class="byte2 hide t" style="left:38px">S(0)</value> <value class="byte2 t" style="left:79px">S(1)</value> <value class="byte2 t" style="left:119px">S(2)</value> <value class="byte4 ptr" style="left:177px">?</value> <value class="byte4 hide ptr" style="left:201px">0x6</value> <value class="byte4 hide ptr" style="left:224px">0xa</value> </values> <labels> <label class="byte2" style="left:37px"><code>a</code></label> <label class="byte4" style="left:59px"><code>b</code></label> <label class="byte2" style="left:81px"><code>c</code></label> <label class="byte4" style="left:139px"><code>r</code></label> <label class="byte4 hide" style="left:165px"><code>x</code></label> <label class="byte4 hide" style="left:188px"><code>y</code></label> </labels> <subtext>Problem of 'Borrowed' Propagation</subtext>  </memory-row> </lifetime-example> <explanation> <pre><code>let b = S(1);
let c = S(2);

let r = f(&amp;b, &amp;c);

let a = b;   &#x2F;&#x2F; Are we allowed to do this?
let a = c;   &#x2F;&#x2F; Which one is _really_ borrowed?

print_byte(r);
</code></pre> <ul> <li>Since <code>f</code> can return only one address, not in all cases <code>b</code> and <code>c</code> need to stay locked.</li> <li>In many cases we can get quality-of-life improvements. <ul> <li>Notably, when we know one parameter <em>couldn't</em> have been used in return value anymore.</li> </ul> </li> </ul> </explanation> </lifetime-section> <lifetime-section> <lifetime-example class="not-first"> <memory-row> <memory-backdrop class="past" style="padding-left:7px"> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <memory-backdrop class="past" style="padding-left:3px"> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <arrows> <arrow style="left:210px;width:102px">&nbsp;<tip>▼</tip></arrow> </arrows> <memory-backdrop> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="borrowed t"></byte> <byte class="borrowed t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <values> <value class="byte2 t" style="left:38px">S(1)</value> <value class="byte2 hide t" style="left:79px">S(1)</value> <value class="byte2 t" style="left:119px">S(2)</value> <value class="byte4 ptr" style="left:177px">y + _</value> <value class="byte4 hide ptr" style="left:201px">0x6</value> <value class="byte4 hide ptr" style="left:224px">0xa</value> </values> <labels> <label class="byte2" style="left:37px"><code>a</code></label> <label class="byte4" style="left:59px"><code>b</code></label> <label class="byte2" style="left:81px"><code>c</code></label> <label class="byte4" style="left:139px"><code>r</code></label> <label class="byte4 hide" style="left:165px"><code>x</code></label> <label class="byte4 hide" style="left:188px"><code>y</code></label> </labels> <subtext>Lifetimes Propagate Borrowed State</subtext>  </memory-row> </lifetime-example> <explanation> <pre><code>fn f&lt;&#x27;b, &#x27;c&gt;(x: &amp;&#x27;b S, y: &amp;&#x27;c S) -&gt; &amp;&#x27;c u8 { ... }

let b = S(1);
let c = S(2);

let r = f(&amp;b, &amp;c); &#x2F;&#x2F; We know returned reference is `c`-based, which must stay locked,
                   &#x2F;&#x2F; while `b` is free to move.

let a = b;

print_byte(r);
</code></pre> <ul> <li>Lifetime parameters in signatures, like <code>'c</code> above, solve that problem.</li> <li>Their primary purpose is: <ul> <li><strong>outside the function</strong>, to explain based on which input address an output address could be generated,</li> <li><strong>within the function</strong>, to guarantee only addresses that live at least <code>'c</code> are assigned.</li> </ul> </li> <li>The actual lifetimes <code>'b</code>, <code>'c</code> are transparently picked by the compiler at <strong>call site</strong>, based on the borrowed variables the developer gave.</li> <li>They are <strong>not</strong> equal to the <em>scope</em> (which would be LOC from initialization to destruction) of <code>b</code> or <code>c</code>, but only a minimal subset of their scope called <em>lifetime</em>, that is, a minmal set of LOC based on how long <code>b</code> and <code>c</code> need to be borrowed to perform this call and use the obtained result.</li> <li>In some cases, like if <code>f</code> had <code>'c: 'b</code> instead, we still couldn't distinguish and both needed to stay locked.</li> </ul> </explanation> </lifetime-section> <lifetime-section> <lifetime-example class="not-first"> <memory-row> <memory-backdrop class="past" style="padding-left:7px"> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte class="atomic"></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <memory-backdrop class="past" style="padding-left:3px"> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte class="ptr"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <memory-backdrop> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte class="t"></byte> <byte class="t"></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> <byte></byte> </memory-backdrop> <values> <value class="byte2 t" style="left:38px">S(2)</value> <value class="byte2 hide t" style="left:79px">S(1)</value> <value class="byte2 hide t" style="left:119px">S(2)</value> <value class="byte4 hide ptr" style="left:177px">y + 1</value> <value class="byte4 hide ptr" style="left:201px">0x6</value> <value class="byte4 hide ptr" style="left:224px">0xa</value> </values> <labels> <label class="byte2" style="left:37px"><code>a</code></label> <label class="byte4 hide" style="left:59px"><code>b</code></label> <label class="byte2" style="left:81px"><code>c</code></label> <label class="byte4 hide" style="left:139px"><code>r</code></label> <label class="byte4 hide" style="left:165px"><code>x</code></label> <label class="byte4 hide" style="left:188px"><code>y</code></label> </labels>  <subtext>Unlocking</subtext> </memory-row> </lifetime-example> <explanation> <pre><code>let mut c = S(2);

let r = f(&amp;c);
let s = r;
                    &#x2F;&#x2F; &lt;- Not here, `s` prolongs locking of `c`.

print_byte(s);

let a = c;          &#x2F;&#x2F; &lt;- But here, no more use of `r` or `s`.


</code></pre> <ul> <li>A variable location is <em>unlocked</em> again once the last use of any reference that may point to it ends.</li> </ul> </explanation> </lifetime-section> </div></panel></tab> </tabs> <footnotes> <p>↕️ Examples expand by clicking.</p> </footnotes> <div>&nbsp;</div></magic> <hr> <h1 id="shu-ju-lei-xing">数据类型<sup id="target-shu-ju-lei-xing" class="target"><a href="#shu-ju-lei-xing">url</a></sup></h1> <p>通用数据类型的内存表示。</p> <h2 id="basic-types">基本类型<sup id="target-basic-types" class="target"><a href="#basic-types">url</a></sup></h2> <p>语言核心内建的必要类型。</p> <h4 id="shu-zi-lei-xing">数字类型 <a href="https://rustwiki.org/zh-CN/reference/types&#x2F;numeric.html"><sup class="expert">REF</sup></a><sup id="target-shu-zi-lei-xing" class="target"><a href="#shu-zi-lei-xing">url</a></sup></h4>  <datum class="spaced"> <name><code>u8</code>, <code>i8</code></name> <visual class="bytes"> <byte><code></code></byte> </visual> </datum>  <datum class="spaced"> <name><code>u16</code>, <code>i16</code></name> <visual class="bytes"> <byte><code></code></byte> <byte><code></code></byte> </visual> </datum>  <datum class="spaced"> <name><code>u32</code>, <code>i32</code></name> <visual class="bytes"> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> </visual> </datum>  <datum class="spaced"> <name><code>u64</code>, <code>i64</code></name> <visual class="bytes"> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> </visual> </datum>  <datum class="spaced"> <name><code>u128</code>, <code>i128</code></name> <visual class="bytes"> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> </visual> </datum>  <datum class="spaced"> <name><code>f32</code></name> <visual class="float"> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> </visual> </datum>  <datum class="spaced"> <name><code>f64</code></name> <visual class="float"> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> </visual> </datum>  <datum class="spaced"> <name><code>usize</code>, <code>isize</code></name> <visual class="sized"> <byte><code></code></byte> <byte><code></code></byte> <byte style="border-color:#888"><code></code></byte> <byte style="border-color:#888"><code></code></byte> <byte style="border-color:#aaa"><code></code></byte> <byte style="border-color:#aaa"><code></code></byte> <byte style="border-color:#aaa"><code></code></byte> <byte style="border-color:#aaa"><code></code></byte> </visual> <zoom> 与平台的 <code>ptr</code> 一致。 </zoom> </datum> <br> <div>&nbsp;</div> <div style="overflow:auto"> <div style="min-width:100%;width:650px"> <tabs>  <tab> <input type="radio" id="tab-numeric-1" name="tab-group-numeric" checked> <label for="tab-numeric-1"><b>无符号类型</b></label> <panel><div> <table><thead><tr><th>类型</th><th>最大值</th></tr></thead><tbody> <tr><td><code>u8</code></td><td><code>255</code></td></tr> <tr><td><code>u16</code></td><td><code>65_535</code></td></tr> <tr><td><code>u32</code></td><td><code>4_294_967_295</code></td></tr> <tr><td><code>u64</code></td><td><code>18_446_744_073_709_551_615</code></td></tr> <tr><td><code>u128</code></td><td><code>340_282_366_920_938_463_463_374_607_431_768_211_455</code></td></tr> <tr><td><code>usize</code></td><td>Depending on platform pointer size, same as <code>u16</code>, <code>u32</code>, or <code>u64</code>.</td></tr> </tbody></table> </div></panel></tab>  <tab> <input type="radio" id="tab-numeric-3" name="tab-group-numeric"> <label for="tab-numeric-3"><b>有符号类型</b></label> <panel><div> <table><thead><tr><th>类型</th><th>最大值</th></tr></thead><tbody> <tr><td><code>i8</code></td><td><code>127</code></td></tr> <tr><td><code>i16</code></td><td><code>32_767</code></td></tr> <tr><td><code>i32</code></td><td><code>2_147_483_647</code></td></tr> <tr><td><code>i64</code></td><td><code>9_223_372_036_854_775_807</code></td></tr> <tr><td><code>i128</code></td><td><code>170_141_183_460_469_231_731_687_303_715_884_105_727</code></td></tr> <tr><td><code>isize</code></td><td>Depending on platform pointer size, same as <code>i16</code>, <code>i32</code>, or <code>i64</code>.</td></tr> </tbody></table> <div>&nbsp;</div><table><thead><tr><th>类型</th><th>最小值</th></tr></thead><tbody> <tr><td><code>i8</code></td><td><code>-128</code></td></tr> <tr><td><code>i16</code></td><td><code>-32_768</code></td></tr> <tr><td><code>i32</code></td><td><code>-2_147_483_648</code></td></tr> <tr><td><code>i64</code></td><td><code>-9_223_372_036_854_775_808</code></td></tr> <tr><td><code>i128</code></td><td><code>-170_141_183_460_469_231_731_687_303_715_884_105_728</code></td></tr> <tr><td><code>isize</code></td><td>Depending on platform pointer size, same as <code>i16</code>, <code>i32</code>, or <code>i64</code>.</td></tr> </tbody></table> </div></panel></tab>  <tab> <input type="radio" id="tab-numeric-2" name="tab-group-numeric"> <label for="tab-numeric-2"><b>浮点类型</b><sup style="font-size:100%;position:relative;top:-4px">🝖</sup></label> <panel><div> <p><code>f32</code> 的位表示*：</p>  <datum style="opacity:.7;margin-bottom:10px"> <visual class="float"> <bitgroup> <bit><code>S</code></bit> </bitgroup> <bitgroup> <bit><code>E</code></bit> <bit><code>E</code></bit> <bit><code>E</code></bit> <bit><code>E</code></bit> <bit><code>E</code></bit> <bit><code>E</code></bit> <bit><code>E</code></bit> <bit><code>E</code></bit> </bitgroup> <bitgroup> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> <bit><code>F</code></bit> </bitgroup> </visual> </datum> <div>&nbsp;</div> <p>说明：</p> <table><thead><tr><th>f32</th><th>S (1)</th><th>E (8)</th><th>F (23)</th><th>值</th></tr></thead><tbody> <tr><td>规格化数</td><td>±</td><td>1 to 254</td><td>任意</td><td>±(1.F)<sub>2</sub> * 2<sup>E-127</sup></td></tr> <tr><td>非规格化数</td><td>±</td><td>0</td><td>非零</td><td>±(0.F)<sub>2</sub> * 2<sup>-126</sup></td></tr> <tr><td>零</td><td>±</td><td>0</td><td>0</td><td>±0</td></tr> <tr><td>无穷大</td><td>±</td><td>255</td><td>0</td><td>±∞</td></tr> <tr><td>NaN</td><td>±</td><td>255</td><td>非零</td><td>NaN</td></tr> </tbody></table> <div>&nbsp;</div> <p>同样，对于 <code>f64</code> 类型，这将类似于：</p> <table><thead><tr><th>f64</th><th>S (1)</th><th>E (11)</th><th>F (52)</th><th>值</th></tr></thead><tbody> <tr><td>规格化数</td><td>±</td><td>1 to 2046</td><td>任意</td><td>±(1.F)<sub>2</sub> * 2<sup>E-1023</sup></td></tr> <tr><td>非规格化数</td><td>±</td><td>0</td><td>非零</td><td>±(0.F)<sub>2</sub> * 2<sup>-1022</sup></td></tr> <tr><td>零</td><td>±</td><td>0</td><td>0</td><td>±0</td></tr> <tr><td>无穷大</td><td>±</td><td>2047</td><td>0</td><td>±∞</td></tr> <tr><td>NaN</td><td>±</td><td>2047</td><td>非零</td><td>NaN</td></tr> </tbody></table> <footnotes> <sup>*</sup> 浮点类型遵循 <a href="https://en.wikipedia.org/wiki/IEEE_754-2008_revision">IEEE 754-2008</a> 规范，并取决于平台大小端序。 </footnotes> </div></panel></tab>  <tab> <input type="radio" id="tab-numeric-4" name="tab-group-numeric"> <label for="tab-numeric-4"><b>Casting Pitfalls</b> <sup>🛑</sup></label> <panel><div> <table><thead><tr><th>Cast<sup>1</sup></th><th>Gives</th><th>Note</th></tr></thead><tbody> <tr><td><code>3.9_f32 as u8</code></td><td><code>3</code></td><td>Truncates, consider <code>x.round()</code> first.</td></tr> <tr><td><code>314_f32 as u8</code></td><td><code>255</code></td><td>采用最接近的可用数字。</td></tr> <tr><td><code>f32::INFINITY as u8</code></td><td><code>255</code></td><td>Same, treats <code>INFINITY</code> as <em>really</em> large number.</td></tr> <tr><td><code>f32::NAN as u8</code></td><td><code>0</code></td><td>-</td></tr> <tr><td><code>_314 as u8</code></td><td><code>58</code></td><td>截断多余的位。</td></tr> <tr><td><code>_200 as i8</code></td><td><code>56</code></td><td>-</td></tr> <tr><td><code>_257 as i8</code></td><td><code>-1</code></td><td>-</td></tr> </tbody></table> </div></panel></tab>  <tab> <input type="radio" id="tab-numeric-5" name="tab-group-numeric"> <label for="tab-numeric-5"><b>Arithmetical Pitfalls</b> <sup>🛑</sup></label> <panel><div> <table><thead><tr><th>Operation<sup>1</sup></th><th>Gives</th><th>Note</th></tr></thead><tbody> <tr><td><code>200_u8 / 0_u8</code></td><td>Compile error.</td><td>-</td></tr> <tr><td><code>200_u8 / _0</code> <sup>d</sup></td><td>Panic.</td><td>Regular math may panic; here: division by zero.</td></tr> <tr><td><code>200_u8 / _0</code> <sup>r</sup></td><td>Panic.</td><td>Same.</td></tr> <tr><td><code>200_u8 + 200_u8</code></td><td>Compile error.</td><td>-</td></tr> <tr><td><code>200_u8 + _200</code> <sup>d</sup></td><td>Panic.</td><td>Consider <code>checked_</code>, <code>wrapping_</code>, ... instead. <a href="https://doc.rust-lang.org/std&#x2F;primitive.isize.html#method.checked_add"><sup class="mid">STD</sup></a></td></tr> <tr><td><code>200_u8 + _200</code> <sup>r</sup></td><td><code>144</code></td><td>In release mode this will overflow.</td></tr> <tr><td><code>1_u8 / 2_u8</code></td><td><code>0</code></td><td>Other integer division truncates.</td></tr> <tr><td><code>0.8_f32 + 0.1_f32</code></td><td><code>0.90000004</code></td><td>-</td></tr> <tr><td><code>1.0_f32 / 0.0_f32</code></td><td><code>f32::INFINITY</code></td><td>-</td></tr> <tr><td><code>0.0_f32 / 0.0_f32</code></td><td><code>f32::NAN</code></td><td>-</td></tr> <tr><td><code>x &lt; f32::NAN</code></td><td><code>false</code></td><td><code>NAN</code> comparisons always return false.</td></tr> <tr><td><code>x &gt; f32::NAN</code></td><td><code>false</code></td><td>-</td></tr> <tr><td><code>f32::NAN == f32::NAN</code></td><td><code>false</code></td><td>-</td></tr> </tbody></table> </div></panel></tab>  </tabs>  </div></div> <footnotes> <p><sup>1</sup>表达式<code>_100</code>表示可能包含<code>100</code>值的任何内容，例如<code>100_i32</code>，但对编译器是不透明的。<br> <sup>d</sup> 调试版本。<br> <sup>r</sup> 发布版本。<br></p> </footnotes> <div>&nbsp;</div><h4 id="wen-zi-lei-xing">文字类型 <a href="https://rustwiki.org/zh-CN/reference/types&#x2F;textual.html"><sup class="expert">REF</sup></a><sup id="target-wen-zi-lei-xing" class="target"><a href="#wen-zi-lei-xing">url</a></sup></h4>  <datum class="spaced"> <name><code>char</code></name> <visual class="char"> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> <byte><code></code></byte> </visual> <description>任意 UTF-8 标量。</description> </datum>  <datum class="spaced"> <name><code>str</code></name> <visual> <note>...</note> <byte class="bytes"><code>U</code></byte> <byte class="bytes"><code>T</code></byte> <byte class="bytes"><code>F</code></byte> <byte class="bytes"><code>-</code></byte> <byte class="bytes"><code>8</code></byte> <note>...未指明条目</note> </visual> <description>很少单独见到，常用 <code>&str</code> 代替。</description> </datum> <div>&nbsp;</div><tabs>  <tab> <input type="radio" id="tab-textual-3" name="tab-group-textual" checked> <label for="tab-textual-3"><b>基本</b></label> <panel><div> <table><thead><tr><th>类型</th><th>描述</th></tr></thead><tbody> <tr><td><code>char</code></td><td>总是为 4 字节，且仅包含一个 Unicode <strong>标量值</strong><a href="https:&#x2F;&#x2F;www.unicode.org&#x2F;glossary&#x2F;#unicode_scalar_value"><sup>🔗</sup></a>。</td></tr> <tr><td><code>str</code></td><td>未知长度的 <code>u8</code> 数组保证保存 <strong>UTF-8 编码的码位</strong>。</td></tr> </tbody></table> </div></panel></tab>  <tab> <input type="radio" id="tab-textual-1" name="tab-group-textual"> <label for="tab-textual-1"><b>用法</b></label> <panel><div>  <table><thead><tr><th>字符</th><th>描述</th></tr></thead><tbody> <tr><td><code>let c = 'a';</code></td><td>Often a <code>char</code> (unicode scalar) can coincide with your intuition of <em>character</em>.</td></tr> <tr><td><code>let c = '❤';</code></td><td>It can also hold many Unicode symbols.</td></tr> <tr><td><code>let c = '❤️';</code></td><td>But not always. Given emoji is <strong>two</strong> <code>char</code> (see Encoding) and <strong>can't</strong> <sup>🛑</sup> be held by <code>c</code>.<sup>1</sup></td></tr> <tr><td><code>c = 0xffff_ffff;</code></td><td>Also, chars are <strong>not allowed</strong> <sup>🛑</sup> to hold arbitrary bit patterns.</td></tr> </tbody></table> <footnotes> <sup>1</sup> Fun fact, due to the <a href="https://en.wikipedia.org/wiki/Zero-width_joiner">Zero-width joiner</a> (⨝) what the user <i>perceives as a character</i> can get even more unpredictable: 👨‍👩‍👧 is in fact 5 chars 👨⨝👩⨝👧, and rendering engines are free to either show them fused as one, or separately as three, depending on their abilities. </footnotes> <div>&nbsp;</div><table><thead><tr><th>字符串</th><th>描述</th></tr></thead><tbody> <tr><td><code>let s = &quot;a&quot;;</code></td><td>A <code>str</code> is usually never held directly, but as <code>&amp;str</code>, like <code>s</code> here.</td></tr> <tr><td><code>let s = &quot;❤❤️&quot;;</code></td><td>It can hold arbitrary text, has variable length per <em>c.</em>, and is hard to index.</td></tr> </tbody></table> </div></panel></tab>  <tab> <input type="radio" id="tab-textual-2" name="tab-group-textual"> <label for="tab-textual-2"><b>Encoding</b><sup style="font-size:100%;position:relative;top:-4px">🝖</sup></label> <panel><div> <p><code>let s = &quot;I ❤ Rust&quot;; </code> <br> <code>let t = &quot;I ❤️ Rust&quot;;</code></p> <table><thead><tr><th>Variant</th><th>Memory Representation<sup>2<sup></sup></sup></th></tr></thead><tbody> <tr><td><code>s.as_bytes()</code></td><td><code>49</code> <code>20</code> <span class="force-code-color same-black"><b><code>e2 9d a4</code></b> </span> <code>20 52 75 73 74</code> <sup>3<sup></sup></sup></td></tr> <tr><td><code>s.chars()</code><sup>1<sup></sup></sup></td><td><code>49 00 00 00 20 00 00 00</code> <span class="force-code-color same-black"><b><code>64 27 00 00</code> </b></span> <code>20 00 00 00 52 00 00 00 75 00 00 00 73 00</code> …</td></tr> <tr><td><code>t.as_bytes()</code></td><td><code>49</code> <code>20</code> <span class="force-code-color same-black"><b><code>e2 9d a4</code></b> </span> <span class="force-code-color same-red"><b><code>ef b8 8f</code></b></span> <code>20 52 75 73 74</code> <sup>4<sup></sup></sup></td></tr> <tr><td><code>t.chars()</code><sup>1<sup></sup></sup></td><td><code>49 00 00 00 20 00 00 00</code> <span class="force-code-color same-black"><b><code>64 27 00 00</code></b></span> <span class="force-code-color same-red"><b><code>0f fe 01 00</code></b></span> <code>20 00 00 00 52 00 00 00 75 00</code> …</td></tr> </tbody></table> <div>&nbsp;</div><footnotes> <sup>1</sup> Result then collected into array and transmuted to bytes.<br> <sup>2</sup> Values given in hex, on x86.<br> <sup>3</sup> Notice how <code>❤</code>, having <a href="https://codepoints.net/U+2764">Unicode Code Point (U+2764)</a>, is represented as <span class="force-code-color same-black"><b>64 27 00 00</b></span> inside the <code>char</code>, but got <a href="https://en.wikipedia.org/wiki/UTF-8#Description">UTF-8 encoded to</a> <span class="force-code-color same-black"><b>e2 9d a4</b></span> in the <code>str</code>.<br> <sup>4</sup> Also observe how the emoji <a href="https://emojipedia.org/red-heart/">Red Heart <code>❤️</code></a>, is a combination of <code>❤</code> and the <a href="https://codepoints.net/U+FE0F">U+FE0F Variation Selector</a>, thus <code>t</code> has a higher char count than <code>s</code>. </footnotes> <div>&nbsp;</div><footnotes> <blockquote> <p><sup>💬</sup> For what seem to be browser bugs Safari and Edge render the hearts in Footnote 3 and 4 wrong, despite being able to differentiate them correctly in <code>s</code> and <code>t</code> above.</p> </blockquote> </footnotes> </div></panel></tab>  </tabs> <div>&nbsp;</div><h2 id="custom-types">自定义类型<sup id="target-custom-types" class="target"><a href="#custom-types">url</a></sup></h2> <p>用户定义的基本类型。它实际的<b>内存布局</b><a href="https://rustwiki.org/zh-CN/reference/type-layout.html"><sup class="expert">REF</sup></a>取决于<b>表示法</b><a href="https://rustwiki.org/zh-CN/reference/type-layout.html#representations"><sup class="expert">REF</sup></a>，还有对齐。</p>  <datum class="spaced"> <name class="nogrow"><code>T</code></name> <name class="hidden">x</name> <visual> <framed class="any t"><code>T</code></framed> </visual> <description>Sized <a href="#sized-types"><sup>↓</sup></a> </description> </datum>  <datum class="spaced"> <name><code>T: ?Sized</code></name> <visual> <framed class="any unsized"><code>T</code></framed> </visual> <description>也许是 DST <a href="#sized-types"><sup>↓</sup></a> </description> </datum>  <datum class="spaced"> <name><code>[T; n]</code></name> <visual> <framed class="any t"><code>T</code></framed> <framed class="any t"><code>T</code></framed> <framed class="any t"><code>T</code></framed> <note>... n 次</note> </visual> <description>固定的 <code>n</code> 个元素的数组。</description> </datum>  <datum class="spaced"> <name><code>[T]</code></name> <visual> <note>...</note> <framed class="any t"><code>T</code></framed> <framed class="any t"><code>T</code></framed> <framed class="any t"><code>T</code></framed> <note>...未指定条目</note> </visual> <description>未知多元素的<b>切片类型</b>。Neither <br> <code>Sized</code> （不携带 <code>len</code> 信息），<br>而且大多数情况下都是以<code>&[T]</code>为参照。<a href="#references-pointers-ui"><sup>↓</sup></a></description> </datum>  <datum style="margin-right:70px"> <name class="nogrow"><code>struct S; </code></name> <name class="hidden"><code>;</code></name> <visual style="width:15px" class="zst"> <code></code> </visual> <description>Zero-Sized <a href="#sized-types"><sup>↓</sup></a> </description> </datum>  <datum class="spaced"> <name><code>(A, B, C)</code></name> <visual style="width:182px"> <framed class="any"><code>A</code></framed> <framed class="any" style="width:100px"><code>B</code></framed> <framed class="any" style="width:50px"><code>C</code></framed> </visual> <andor>or maybe</andor> <visual style="width:182px"> <framed class="any" style="width:100px"><code>B</code></framed> <framed class="any"><code>A</code></framed> <framed class="any" style="width:50px"><code>C</code></framed> </visual> <description>除非强制表示（例如通过 <code>#[repr(C)]</code>）<br>否则类型布局未指定。</description> </datum>  <datum class="spaced"> <name><code>struct S { b: B, c: C } </code></name> <visual style="width:166px"> <framed class="any" style="width:100px"><code>B</code></framed> <framed class="any" style="width:50px"><code>C</code></framed> </visual> <andor>或者也许</andor> <visual> <framed class="any" style="width:50px"><code>C</code></framed> <pad><code>↦</code></pad> <framed class="any" style="width:100px"><code>B</code></framed> </visual> <description>编译器还可以添加填充。</description> </datum> <blockquote> <footnotes> <p>还需注意，具有完全相同字段的两种类型 <code>A(X, Y)</code> 和 <code>B(X, Y)</code> 仍然可以具有不同的布局；如果没有表示保证，则决不能使用 <code>transmute()</code>。</p> </footnotes> </blockquote> <div>&nbsp;</div> <p>这些<strong>合并类型</strong>存有其一种子类型的值：</p>  <datum class="spaced"> <name><code>enum E { A, B, C }</code></name> <visual class="enum" style="text-align:left"> <pad><code>标签</code></pad> <framed class="any"> <code>A</code> </framed> </visual> <andor>排他性或</andor> <visual class="enum" style="text-align:left"> <pad><code>标签</code></pad> <framed class="any" style="width:100px"> <code>B</code> </framed> </visual> <andor>排他性或</andor> <visual class="enum" style="text-align:left"> <pad><code>标签</code></pad> <framed class="any" style="width:50px"> <code>C</code> </framed> </visual> <description> 安全地保存 A、B 或 C。<br>又名“标签联合”，尽管编译器会忽略标签。 </description> </datum>  <datum class="spaced"> <name><code>union { ... }</code></name> <visual style="text-align:left"> <framed class="any"> <code>A</code> </framed> </visual> <andor>不安全或</andor> <visual style="text-align:left"> <framed class="any" style="width:100px"> <code>B</code> </framed> </visual> <andor>不安全或</andor> <visual style="text-align:left"> <framed class="any" style="width:50px"> <code>C</code> </framed> </visual> <description> 不安全地以多种方式解释同一块内存。<br>结果可能是未定义的。 </description> </datum> <h2 id="references-pointers-ui">引用 &amp; 指针<sup id="target-references-pointers-ui" class="target"><a href="#references-pointers-ui">url</a></sup></h2> <p>引用授权了对其他内存空间的安全访问。裸指针则是不安全 <code>unsafe</code> 的访问。 各自的 <code>mut</code> 类型是相同的。</p>  <datum class="spaced"> <name><code>&'a T</code></name> <visual> <ptr> <code>ptr</code><sub>2/4/8</sub> </ptr> <payload> <code>meta</code><sub>2/4/8</sub> </payload> </visual> <memory-entry> <memory-link style="left:46%">|</memory-link> <memory class="anymem"> <framed class="any unsized"><code>T</code></framed> </memory> </memory-entry> <description>必须定位一些有效 <code>t</code> 的 <code>T</code>，<br> 并且任何这样的目标必须 至少存在<code>'a</code>。</description> </datum>  <datum class="spaced"> <name><code>*const T</code></name> <visual class="unsafe"> <ptr> <code>ptr</code><sub>2/4/8</sub> </ptr> <payload> <code>meta</code><sub>2/4/8</sub> </payload> </visual> <zoom> 没有任何保证。 </zoom> </datum> <br> <h3 id="pointer-meta">元指针<sup id="target-pointer-meta" class="target"><a href="#pointer-meta">url</a></sup></h3> <p>许多引用和指针类型可以携带一个额外的字段，<strong>元数据指针</strong><a href="https://doc.rust-lang.org/nightly&#x2F;std&#x2F;ptr&#x2F;trait.Pointee.html#pointer-metadata"><sup class="mid">STD</sup></a>。 它可以是目标的元素长度或字节长度，也可以是指向<i>vtable</i>的指针。带有 meta 的指针称为<strong>胖指针(fat)</strong>，否则称为<strong>细指针(thin)</strong>。</p>  <datum class="spaced"> <name><code>&'a T</code></name> <visual> <ptr> <code>ptr</code><sub>2/4/8</sub> </ptr> </visual> <memory-entry> <memory-link style="left:46%">|</memory-link> <memory class="anymem"> <framed class="any t"><code>T</code></framed> </memory> </memory-entry> <description>没有大小目标的元（细指针）。</description> </datum>  <datum class="spaced"> <name><code>&'a T</code></name> <visual> <ptr> <code>ptr</code><sub>2/4/8</sub> </ptr> <sized> <code>len</code><sub>2/4/8</sub> </sized> </visual> <memory-entry> <memory-link style="left:46%">|</memory-link> <memory class="anymem"> <framed class="any unsized"><code>T</code></framed> </memory> </memory-entry> <description>If <code>T</code> is a DST <code>struct</code> such as<br> <code>S { x: [u8] }</code> meta field <code>len</code> is <br>length of dyn. sized content.</description> </datum>  <datum class="spaced"> <name><code>&'a [T]</code></name> <visual> <ptr> <code>ptr</code><sub>2/4/8</sub> </ptr> <sized> <code>len</code><sub>2/4/8</sub> </sized> </visual> <memory-entry class="double"> <memory-link style="left:24%">|</memory-link> <memory class="anymem"> ... <framed class="any" style="width:30px"><code>T</code></framed> <framed class="any" style="width:30px"><code>T</code></framed> ... </memory> </memory-entry> <description>Regular <b>slice reference</b> (i.e., the <br>reference type of a slice type <code>[T]</code>) <a href="#custom-types"><sup>↑</sup></a> <br>often seen as <code>&[T]</code> if <code>'a</code> elided.</description> </datum>  <datum class="spaced"> <name><code>&'a str</code></name> <visual> <ptr> <code>ptr</code><sub>2/4/8</sub> </ptr> <sized> <code>len</code><sub>2/4/8</sub> </sized> </visual> <memory-entry class="double"> <memory-link style="left:24%">|</memory-link> <memory class="anymem"> ... <byte class="bytes"><code>U</code></byte> <byte class="bytes"><code>T</code></byte> <byte class="bytes"><code>F</code></byte> <byte class="bytes"><code>-</code></byte> <byte class="bytes"><code>8</code></byte> ... </memory> </memory-entry> <description><b>String slice reference</b> (i.e., the <br>reference type of string type <code>str</code>),<br> with meta <code>len</code> being byte length.</description> </datum> <br>  <datum class="spaced" style="padding-bottom:165px"> <name><code>&'a dyn Trait</code></name> <visual> <ptr> <code>ptr</code><sub>2/4/8</sub> </ptr> <ptr> <code>ptr</code><sub>2/4/8</sub> </ptr> </visual> <memory-entry> <memory-link style="left:49%">|</memory-link> <memory class="anymem"> <framed class="any unsized"><code>T</code></framed> </memory> </memory-entry> <memory-entry style="width:220px;position:absolute"> <memory-link style="left:22%">|</memory-link> <memory class="static-vtable" style="width:210px"> <table> <tr class="vtable"><td><code>*Drop::drop(&mut T)</code></td></tr> <tr class="vtable"><td><code>size</code></td></tr> <tr class="vtable"><td><code>align</code></td></tr> <tr class="vtable"><td><code>*Trait::f(&T, ...)</code></td></tr> <tr class="vtable"><td><code>*Trait::g(&T, ...)</code></td></tr> </table> </memory> <description>Meta points to vtable, where <code>*Drop::drop()</code>, <code>*Trait::f()</code>, ... are pointers to their respective <code>impl</code> for <code>T</code>.</description> </memory-entry> </datum> <h2 id="closures-data">闭包<sup id="target-closures-data" class="target"><a href="#closures-data">url</a></sup></h2> <p>闭包是一个临时函数，定义闭包时，它会自动管理数据<strong>捕获</strong><a href="https://rustwiki.org/zh-CN/reference/types&#x2F;closure.html#capture-modes"><sup class="expert">REF</sup></a>环境中访问的内容。例如：</p>  <datum class="spaced"> <name><code>move |x| x + y.f() + z</code></name> <visual> <framed class="any" style="width:100px"><code>Y</code></framed> <framed class="any" style="width:50px"><code>Z</code></framed> </visual> <zoom>匿名闭包类型 C1</zoom>  </datum>  <datum class="spaced"> <name><code>|x| x + y.f() + z</code></name> <visual> <ptr> <code>ptr</code><sub>2/4/8</sub> </ptr> <ptr> <code>ptr</code><sub>2/4/8</sub> </ptr> </visual> <zoom>匿名闭包类型 C2</zoom> <memory-entry> <memory-link style="left:44%">|</memory-link> <memory class="anymem"> <framed class="any" style="width:30px"><code>Y</code></framed> </memory> </memory-entry> <memory-entry> <memory-link style="left:44%">|</memory-link> <memory class="anymem"> <framed class="any" style="width:30px"><code>Z</code></framed> </memory> </memory-entry>  </datum>   <blockquote> <footnotes> <p>Also produces anonymous <code>fn</code> such as <code>f<sub>c1</sub>(C1, X)</code> or <code>f<sub>c2</sub>(&amp;C2, X)</code>. Details depend which <code>FnOnce</code>, <code>FnMut</code>, <code>Fn</code> ... is supported, based on properties of captured types.</p> </footnotes> </blockquote> <h2 id="standard-library-types">Standard Library Types<sup id="target-standard-library-types" class="target"><a href="#standard-library-types">url</a></sup></h2> <p>Rust's standard library combines the above primitive types into useful types with special semantics, e.g.:</p>  <datum class="spaced"> <name><code>UnsafeCell&lt;T&gt;</code></name> <visual class="cell"> <framed class="any unsized"><code>T</code></framed> </visual> <description>Magic type allowing <br>aliased mutability.</description> </datum>  <datum class="spaced"> <name><code>Cell&lt;T&gt;</code></name> <visual> <framed class="any celled unsized"><code>T</code></framed> </visual> <description>Allows <code>T</code>'s<br> to move in<br> and out.</description> </datum>  <datum class="spaced"> <name><code>RefCell&lt;T&gt;</code></name> <visual> <sized class="celled"><code>borrowed</code></sized> <framed class="any celled unsized"><code>T</code></framed> </visual> <description>Also support dynamic<br> borrowing of <code>T</code>. Like <code>Cell</code> this<br> is <code>Send</code>, but not <code>Sync</code>.</description> </datum>  <datum class="spaced"> <name><code>AtomicUsize</code></name> <visual class="atomic"> <ptr class="atomic"> <code>usize</code><sub>2/4/8</sub> </ptr> </visual> <description>Other atomic similarly.</description> </datum>  <datum> <name><code>Result&lt;T, E&gt;</code></name> <visual class="enum" style="text-align:left"> <pad><code>Tag</code></pad> <framed class="any" style="width:50px"> <code>E</code> </framed> </visual> <andor>or</andor> <visual class="enum" style="text-align:left"> <pad><code>Tag</code></pad> <framed class="any" style="width:100px"> <code>T</code> </framed> </visual> </datum>  <datum class="spaced"> <name><code>Option&lt;T&gt;</code></name> <visual class="enum" style="text-align:left"> <pad><code>Tag</code></pad> </visual> <andor>or</andor> <visual class="enum"> <pad><code>Tag</code></pad> <framed class="any" style="width:100px"> <code>T</code> </framed> </visual> <description>Tag may be omitted for <br> certain T, e.g., <code>NonNull</code>.</description> </datum> <div>&nbsp;</div><h4 id="general-purpose-heap-storage">General Purpose Heap Storage<sup id="target-general-purpose-heap-storage" class="target"><a href="#general-purpose-heap-storage">url</a></sup></h4>  <datum class="spaced"> <name><code>Box&lt;T&gt;</code></name> <visual> <ptr> <code>ptr</code><sub>2/4/8</sub> </ptr> <payload> <code>meta</code><sub>2/4/8</sub> </payload> </visual> <memory-entry> <memory-link style="left:49%">|</memory-link> <memory class="heap"> <framed class="any unsized"><code>T</code></framed> </memory> </memory-entry> <description>For some <code>T</code> stack proxy may carry <br>meta<a href="#custom-types"><sup>↑</sup></a> (e.g., <code>Box<[T]></[T]></code>).</description> </datum> <spacer> </spacer>  <datum> <name><code>Vec&lt;T&gt;</code></name>  <visual> <ptr> <code>ptr</code><sub>2/4/8</sub> </ptr> <sized> <code>capacity</code><sub>2/4/8</sub> </sized> <sized> <code>len</code><sub>2/4/8</sub> </sized> </visual> <memory-entry class="double"> <memory-link style="left:25%">|</memory-link> <memory class="capacity heap"> <div> <framed class="any t"><code>T</code></framed> <framed class="any t"><code>T</code></framed> <note>... len</note> </div> <capacity>← <note>capacity</note> →</capacity> </memory> </memory-entry> </datum> <div>&nbsp;</div><h4 id="owned-strings">Owned Strings<sup id="target-owned-strings" class="target"><a href="#owned-strings">url</a></sup></h4>  <datum> <name><code>String</code></name>  <visual> <ptr> <code>ptr</code><sub>2/4/8</sub> </ptr> <sized> <code>capacity</code><sub>2/4/8</sub> </sized> <sized> <code>len</code><sub>2/4/8</sub> </sized> </visual> <memory-entry class="double"> <memory-link style="left:25%">|</memory-link> <memory class="heap"> <div> <byte class="bytes"><code>U</code></byte> <byte class="bytes"><code>T</code></byte> <byte class="bytes"><code>F</code></byte> <byte class="bytes"><code>-</code></byte> <byte class="bytes"><code>8</code></byte> <note>... len</note> </div> <capacity>← <note>capacity</note> →</capacity> </memory> </memory-entry> <description>Observe how <code>String</code> differs from <code>&str</code> and <code>&[char]</code>.</description> </datum> <spacer> </spacer>  <datum> <name><code>CString</code></name>  <visual> <ptr> <code>ptr</code><sub>2/4/8</sub> </ptr> <sized> <code>len</code><sub>2/4/8</sub> </sized> </visual> <memory-entry class="double"> <memory-link style="left:25%">|</memory-link> <memory class="heap"> <div> <byte class="bytes"><code>A</code></byte> <byte class="bytes"><code>B</code></byte> <byte class="bytes"><code>C</code></byte> <note>... len ...</note> <byte class="bytes"><code>␀</code></byte> </div> </memory> </memory-entry> <description>NUL-terminated but w/o NUL in middle.</description> </datum> <spacer> </spacer>  <datum> <name><code>OsString</code> <sup>?</sup></name>  <visual class="platformdefined"> Platform Defined </visual> <memory-entry class="double"> <memory-link style="left:25%">|</memory-link> <memory class="heap"> <div> <byte class="bytes"><code>?</code></byte> <byte class="bytes"><code>?</code></byte> / <word class="bytes"><code>?</code></word> <word class="bytes"><code>?</code></word> </div> </memory> </memory-entry> <description>Encapsulates how operating system<br> represents strings (e.g., UTF-16 on <br>Windows).</description> </datum> <spacer> </spacer>  <datum> <name><code>PathBuf</code> <sup>?</sup></name>  <visual class="platformdefined"> <payload> <code>OsString</code> </payload> </visual> <memory-entry class="double"> <memory-link style="left:40%">|</memory-link> <memory class="heap"> <div> <byte class="bytes"><code>?</code></byte> <byte class="bytes"><code>?</code></byte> / <word class="bytes"><code>?</code></word> <word class="bytes"><code>?</code></word> </div> </memory> </memory-entry> <description>Encapsulates how operating system<br> represents paths.</description> </datum> <div>&nbsp;</div><h4 id="shared-ownership">Shared Ownership<sup id="target-shared-ownership" class="target"><a href="#shared-ownership">url</a></sup></h4> <p>If the type does not contain a <code>Cell</code> for <code>T</code>, these are often combined with one of the <code>Cell</code> types above to allow shared de-facto mutability.</p>  <datum> <name><code>Rc&lt;T&gt;</code></name> <visual style="width:180px"> <ptr> <code>ptr</code><sub>2/4/8</sub> </ptr> <payload> <code>meta</code><sub>2/4/8</sub> </payload> </visual> <div> <memory-entry class="quad"> <memory-link style="left:15%">|</memory-link> <memory class="heap"> <sized class="celled"><code>strng</code><sub>2/4/8</sub></sized> <sized class="celled"><code>weak</code><sub>2/4/8</sub></sized> <framed class="any unsized"><code>T</code></framed> </memory> </memory-entry> </div> <description>Share ownership of <code>T</code> in same thread. Needs nested <code>Cell</code> <br>or <code>RefCell</code>to allow mutation. Is neither <code>Send</code> nor <code>Sync</code>.</description> </datum>  <datum> <name><code>Arc&lt;T&gt;</code></name> <visual style="width:180px"> <ptr> <code>ptr</code><sub>2/4/8</sub> </ptr> <payload> <code>meta</code><sub>2/4/8</sub> </payload> </visual> <div style="width:0"> <memory-entry class="quad"> <memory-link style="left:15%">|</memory-link> <memory class="heap"> <sized class="atomicx"><code>strng</code><sub>2/4/8</sub></sized> <sized class="atomicx"><code>weak</code><sub>2/4/8</sub></sized> <framed class="any unsized"><code>T</code></framed> </memory> </memory-entry> </div> <description>Same, but allow sharing between threads IF contained<br> <code>T</code> itself is <code>Send</code> and <code>Sync</code>.</description> </datum> <br>  <datum> <name><code>Mutex&lt;T&gt;</code> / <code>RwLock&lt;T&gt;</code></name> <visual style="width:230px"> <ptr><code>ptr</code><sub>2/4/8</sub></ptr> <sized class="atomicx"><code>poison</code><sub>2/4/8</sub></sized> <framed class="any celled unsized"><code>T</code></framed> </visual> <memory-entry> <memory-link style="left:45%">|</memory-link> <memory class="heap"> <code>lock</code> </memory> </memory-entry> <description>Needs to be held in <code>Arc</code> to be shared between<br> threads, always <code>Send</code> and <code>Sync</code>. Consider using <br> <a href="https://crates.io/crates/parking_lot">parking_lot</a> instead (faster, no heap usage). </description> </datum> <hr> <h1 id="standard-library">Standard Library<sup id="target-standard-library" class="target"><a href="#standard-library">url</a></sup></h1> <h2 id="one-liners">One-Liners<sup id="target-one-liners" class="target"><a href="#one-liners">url</a></sup></h2> <p>Snippets that are common, but still easy to forget. See <strong>Rust Cookbook</strong> <a href="https:&#x2F;&#x2F;rust-lang-nursery.github.io&#x2F;rust-cookbook&#x2F;"><sup>🔗</sup></a> for more.</p>   <div style="overflow:auto"> <div style="min-width:100%;width:650px"> <tabs>  <tab> <input type="radio" id="tab-api-2" name="tab-api-sized" checked> <label for="tab-api-2"><b>Strings</b></label> <panel><div class="cheats color-header one-liners"> <table><thead><tr><th>Intent</th><th>Snippet</th></tr></thead><tbody> <tr><td>Concatenate strings (any <code>Display</code><a href="#string-output"><sup>↓</sup></a> that is). <sup>1</sup> <sup>&#x27;21</sup></td><td><code>format!(&quot;{x}{y}&quot;)</code></td></tr> <tr><td>Split by separator pattern. <a href="https://doc.rust-lang.org/std&#x2F;str&#x2F;pattern&#x2F;trait.Pattern.html"><sup class="mid">STD</sup></a> <a href="https:&#x2F;&#x2F;stackoverflow.com&#x2F;a&#x2F;38138985"><sup>🔗</sup></a></td><td><code>s.split(pattern)</code></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> ... with <code>&amp;str</code></td><td><code>s.split(&quot;abc&quot;)</code></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> ... with <code>char</code></td><td><code>s.split('/')</code></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> ... with closure</td><td><code>s.split(char::is_numeric)</code></td></tr> <tr><td>Split by whitespace.</td><td><code>s.split_whitespace()</code></td></tr> <tr><td>Split by newlines.</td><td><code>s.lines()</code></td></tr> <tr><td>Split by regular expression.<sup>2</sup></td><td><code> Regex::new(r&quot;\s&quot;)?.split(&quot;one two three&quot;)</code></td></tr> </tbody></table> <footnotes> <p><sup>1</sup> Allocates; might not be fastest solution if <code>x</code> is <code>String</code> already.<br> <sup>2</sup> Requires <a href="https://crates.io/crates/regex">regex</a> crate.</p> </footnotes> </div></panel></tab>  <tab> <input type="radio" id="tab-api-1" name="tab-api-sized"> <label for="tab-api-1"><b>I/O</b></label> <panel><div class="cheats color-header one-liners"> <table><thead><tr><th>Intent</th><th>Snippet</th></tr></thead><tbody> <tr><td>Create a new file</td><td><code>File::create(PATH)?</code></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> Same, via OpenOptions</td><td><code>OpenOptions::new().create(true).write(true).truncate(true).open(PATH)?</code></td></tr> </tbody></table>  </div></panel></tab>  <tab> <input type="radio" id="tab-api-4" name="tab-api-sized"> <label for="tab-api-4"><b>Macros</b></label> <panel><div class="cheats color-header one-liners"> <table><thead><tr><th>Intent</th><th>Snippet</th></tr></thead><tbody> <tr><td>Macro w. variable arguments</td><td><code>macro_rules! var_args { ($($args:expr),*) =&gt; {{ }} }</code></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> Using <code>args</code>, e.g., calling <code>f</code> multiple times.</td><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code> $( f($args); )*</code></td></tr> </tbody></table> </div></panel></tab>  <tab> <input type="radio" id="tab-api-3" name="tab-api-sized"> <label for="tab-api-3"><b>Esoterics</b><sup style="font-size:100%;position:relative;top:-4px">🝖</sup></label> <panel><div class="cheats color-header one-liners"> <table><thead><tr><th>Intent</th><th>Snippet</th></tr></thead><tbody> <tr><td>Cleaner closure captures</td><td><code>wants_closure({ let c = outer.clone(); move || use_clone(c) })</code></td></tr> <tr><td>Fix inference in '<code>try</code>' closures</td><td><code>iter.try_for_each(|x| { Ok::&lt;(), Error&gt;(()) })?;</code></td></tr> <tr><td>Iterate <em>and</em> edit <code>&amp;mut [T]</code> if <code>T</code> Copy.</td><td><code>Cell::from_mut(mut_slice).as_slice_of_cells()</code></td></tr> <tr><td>Get subslice with length.</td><td><code>&amp;original_slice[offset..][..length]</code></td></tr> <tr><td>Canary to ensure trait <code>T</code> is object safe.</td><td><code>const _: Option&lt;&amp;dyn T&gt; = None;</code></td></tr> </tbody></table> </div></panel></tab> </tabs> </div></div> <h2 id="thread-safety">线程安全<sup id="target-thread-safety" class="target"><a href="#thread-safety">url</a></sup></h2>  <table class="sendsync"> <thead> <tr><th>Examples</th><th><code>Send</code><sup>*</sup></th><th><code>!Send</code></th></tr> </thead> <tbody> <tr><td><code>Sync</code><sup>*</sup></td><td><i>Most types</i> ... <code>Mutex&lt;T&gt;</code>, <code>Arc&lt;T&gt;</code><sup>1,2</sup></td><td><code>MutexGuard&lt;T&gt;</code><sup>1</sup>, <code>RwLockReadGuard&lt;T&gt;</code><sup>1</sup></td></tr> <tr><td><code>!Sync</code></td><td><code>Cell&lt;T&gt;</code><sup>2</sup>, <code>RefCell&lt;T&gt;</code><sup>2</sup></td><td><code>Rc&lt;T&gt;</code>, <code>&dyn Trait</code>, <code>*const T</code><sup>3</sup>, <code>*mut T</code><sup>3</sup></td></tr> </tbody> </table> <footnotes> <p><sup>*</sup> An instance <code>t</code> where <strong><code>T: Send</code></strong> can be moved to another thread, a <strong><code>T: Sync</code></strong> means <code>&amp;t</code> can be moved to another thread.<br> <sup>1</sup> If <code>T</code> is <code>Sync</code>. <br> <sup>2</sup> If <code>T</code> is <code>Send</code>. <br> <sup>3</sup> If you need to send a raw pointer, create newtype <code>struct Ptr(*const u8)</code> and <code>unsafe impl Send for Ptr {}</code>. Just ensure you <em>may</em> send it.</p> </footnotes> <h2 id="iterators">迭代器<sup id="target-iterators" class="target"><a href="#iterators">url</a></sup></h2> <tabs class="color-header std-green">  <tab> <input type="radio" id="tab-trait-iter-1" name="tab-group-trait-iter" checked> <label for="tab-trait-iter-1"><b>Obtaining Iterators</b></label> <panel><div> <p><strong>Basics</strong></p> <p>Assume you have a collection <code>c</code> of type <code>C</code>:</p> <ul> <li><strong><code>c.into_iter()</code></strong> — Turns collection <code>c</code> into an <strong><code>Iterator</code></strong> <a href="https://doc.rust-lang.org/std&#x2F;iter&#x2F;trait.Iterator.html"><sup class="mid">STD</sup></a> <code>i</code> and <strong>consumes</strong><sup>*</sup> <code>c</code>. Requires <strong><code>IntoIterator</code></strong> <a href="https://doc.rust-lang.org/std&#x2F;iter&#x2F;trait.IntoIterator.html"><sup class="mid">STD</sup></a> for <code>C</code> to be implemented. Type of item depends on what <code>C</code> was. 'Standardized' way to get Iterators.</li> <li><strong><code>c.iter()</code></strong> — Courtesy method <strong>some</strong> collections provide, returns <strong>borrowing</strong> Iterator, doesn't consume <code>c</code>.</li> <li><strong><code>c.iter_mut()</code></strong> — Same, but <strong>mutably borrowing</strong> Iterator that allow collection to be changed.</li> </ul> <p><strong>The Iterator</strong></p> <p>Once you have an <code>i</code>:</p> <ul> <li><strong><code>i.next()</code></strong> — Returns <code>Some(x)</code> next element <code>c</code> provides, or <code>None</code> if we're done.</li> </ul> <p><strong>For Loops</strong></p> <ul> <li><strong><code>for x in c {}</code></strong> — Syntactic sugar, calls <code>c.into_iter()</code> and loops <code>i</code> until <code>None</code>.</li> </ul> <footnotes> <p><sup>*</sup> If it looks as if it doesn't consume <code>c</code> that's because type was <code>Copy</code>. For example, if you call <code>(&amp;c).into_iter()</code> it will invoke <code>.into_iter()</code> on <code>&amp;c</code> (which will consume the reference and turn it into an Iterator), but <code>c</code> remains untouched.</p> </footnotes> </div></panel></tab>  <tab> <input type="radio" id="tab-trait-iter-2" name="tab-group-trait-iter"> <label for="tab-trait-iter-2"><b>Implementing Iterators</b></label> <panel><div> <p><strong>Basics</strong></p> <p>Let's assume you have a <code>struct Collection&lt;T&gt; {}</code>.</p> <ul> <li><strong><code>struct IntoIter&lt;T&gt; {}</code></strong> — Create a struct to hold your iteration status (e.g., an index) for value iteration.</li> <li><strong><code>impl Iterator for IntoIter {}</code></strong> — Implement <code>Iterator::next()</code> so it can produce elements.</li> </ul> <mini-zoo class="zoo"> <entry class="wide"> <type class="dotted generic"><code>Collection&lt;T&gt;</code></type> </entry> </mini-zoo> <mini-zoo class="zoo" style="margin-right:20px"> <entry class="wide"> <type class="dotted generic"><code>IntoIter&lt;T&gt;</code></type> <trait-impl>⌾ <code>Iterator</code></trait-impl> <associated-type class="grayed"><code>Item = T;</code></associated-type> </entry> </mini-zoo> <hr> <p><strong>Shared &amp; Mutable Iterators</strong></p> <ul> <li><strong><code>struct Iter&lt;T&gt; {}</code></strong> — Create struct holding <code>&amp;Collection&lt;T&gt;</code> for shared iteration.</li> <li><strong><code>struct IterMut&lt;T&gt; {}</code></strong> — Similar, but holding <code>&amp;mut Collection&lt;T&gt;</code> for mutable iteration.</li> <li><strong><code>impl Iterator for Iter&lt;T&gt; {}</code></strong> — Implement shared iteration.</li> <li><strong><code>impl Iterator for IterMut&lt;T&gt; {}</code></strong> — Implement mutable iteration.</li> </ul> <p>In addition, you might want to add convenience methods:</p> <ul> <li><code>Collection::iter(&amp;self) -&gt; Iter</code>,</li> <li><code>Collection::iter_mut(&amp;mut self) -&gt; IterMut</code>.</li> </ul> <mini-zoo class="zoo" style="margin-right:20px"> <entry class="wide"> <type class="dotted generic"><code>Iter&lt;T&gt;</code></type> <trait-impl>⌾ <code>Iterator</code></trait-impl> <associated-type class="grayed"><code>Item = &T;</code></associated-type> </entry> </mini-zoo> <mini-zoo class="zoo" style="margin-right:20px"> <entry class="wide"> <type class="dotted generic"><code>IterMut&lt;T&gt;</code></type> <trait-impl>⌾ <code>Iterator</code></trait-impl> <associated-type class="grayed"><code>Item = &mut T;</code></associated-type> </entry> </mini-zoo> <hr> <p><strong>Making Loops Work</strong></p> <ul> <li><strong><code>impl IntoIterator for Collection {}</code></strong> — Now <code>for x in c {}</code> works.</li> <li><strong><code>impl IntoIterator for &amp;Collection {}</code></strong> — Now <code>for x in &amp;c {}</code> works.</li> <li><strong><code>impl IntoIterator for &amp;mut Collection {}</code></strong> — Now <code>for x in &amp;mut c {}</code> works.</li> </ul> <mini-zoo class="zoo"> <entry class="wide"> <type class="dotted generic"><code>Collection&lt;T&gt;</code></type> <trait-impl>⌾ <code>IntoIterator</code></trait-impl> <associated-type class="grayed"><code>Item = T;</code></associated-type> <associated-type class="grayed"><code>To = IntoIter&lt;T&gt;</code></associated-type> <note>Iterate over <code>T</code>.</note> </entry> </mini-zoo> <mini-zoo class="zoo"> <entry class="wide"> <type class="dotted generic grayed"><code>&Collection&lt;T&gt;</code></type> <trait-impl>⌾ <code>IntoIterator</code></trait-impl> <associated-type class="grayed"><code>Item = &T;</code></associated-type> <associated-type class="grayed"><code>To = Iter&lt;T&gt;</code></associated-type> <note>Iterate over <code>&T</code>.</note> </entry> </mini-zoo> <mini-zoo class="zoo"> <entry class="wide"> <type class="dotted generic grayed"><code>&mut Collectn&lt;T&gt;</code></type> <trait-impl>⌾ <code>IntoIterator</code></trait-impl> <associated-type class="grayed"><code>Item = &mut T;</code></associated-type> <associated-type class="grayed"><code>To = IterMut&lt;T&gt;</code></associated-type> <note>Iterate over <code>&mut T</code>.</note> </entry> </mini-zoo> </div></panel></tab> </tabs>  <div style="overflow:auto"> <div style="min-width:100%;width:650px"> <div class="color-header number"> <h2 id="number-conversions">数字转换<sup id="target-number-conversions" class="target"><a href="#number-conversions">url</a></sup></h2> <p>As-<b>correct</b>-as-it-currently-gets number conversions.</p> <table><thead><tr><th>↓ Have / Want →</th><th><code>u8</code> … <code>i128</code></th><th><code>f32</code> / <code>f64</code></th><th>String</th></tr></thead><tbody> <tr><td><code>u8</code> … <code>i128</code></td><td><code>u8::try_from(x)?</code> <sup>1</sup></td><td><code>x as f32</code> <sup>3</sup></td><td><code>x.to_string()</code></td></tr> <tr><td><code>f32</code> / <code>f64</code></td><td><code>x as u8</code> <sup>2</sup></td><td><code>x as f32</code></td><td><code>x.to_string()</code></td></tr> <tr><td><code>String</code></td><td><code>x.parse::&lt;u8&gt;()?</code></td><td><code>x.parse::&lt;f32&gt;()?</code></td><td><code>x</code></td></tr> </tbody></table> <footnotes> <p><sup>1</sup> If type true subset <code>from()</code> works directly, e.g., <code>u32::from(my_u8)</code>. <br> <sup>2</sup> Truncating (<code>11.9_f32 as u8</code> gives <code>11</code>) and saturating (<code>1024_f32 as u8</code> gives <code>255</code>); <em>c</em>. below. <br> <sup>3</sup> Might misrepresent number (<code>u64::MAX as f32</code>) or produce <code>Inf</code> (<code>u128::MAX as f32</code>).</p> </footnotes>  </div> </div> </div> <h2 id="string-conversions">字符串转换<sup id="target-string-conversions" class="target"><a href="#string-conversions">url</a></sup></h2> <p>If you <strong>want</strong> a string of type …</p>  <div style="overflow:auto"> <div style="min-width:100%;width:650px"> <tabs>  <tab> <input type="radio" id="tab-str-1" name="tab-group-str" checked> <label for="tab-str-1"><code>String</code></label> <panel><div class="stringconversion"> <table><thead><tr><th>If you <strong>have</strong> <code>x</code> of type …</th><th>Use this …</th></tr></thead><tbody> <tr><td><code>String</code></td><td><code>x</code></td></tr> <tr><td><code>CString</code></td><td><code>x.into_string()?</code></td></tr> <tr><td><code>OsString</code></td><td><code>x.to_str()?.to_string()</code></td></tr> <tr><td><code>PathBuf</code></td><td><code>x.to_str()?.to_string()</code></td></tr> <tr><td><code>Vec&lt;u8&gt;</code> <sup>1</sup></td><td><code>String::from_utf8(x)?</code></td></tr> <tr><td><code>&amp;str</code></td><td><code>x.to_string()</code> <sup><code>i</code></sup></td></tr> <tr><td><code>&amp;CStr</code></td><td><code>x.to_str()?.to_string()</code></td></tr> <tr><td><code>&amp;OsStr</code></td><td><code>x.to_str()?.to_string()</code></td></tr> <tr><td><code>&amp;Path</code></td><td><code>x.to_str()?.to_string()</code></td></tr> <tr><td><code>&amp;[u8]</code> <sup>1</sup></td><td><code>String::from_utf8_lossy(x).to_string()</code></td></tr> </tbody></table> </div></panel></tab>  <tab> <input type="radio" id="tab-str-2" name="tab-group-str"> <label for="tab-str-2"><code>CString</code></label> <panel><div class="stringconversion"> <table><thead><tr><th>If you <strong>have</strong> <code>x</code> of type …</th><th>Use this …</th></tr></thead><tbody> <tr><td><code>String</code></td><td><code>CString::new(x)?</code></td></tr> <tr><td><code>CString</code></td><td><code>x</code></td></tr> <tr><td><code>OsString</code> <sup>2</sup></td><td><code>CString::new(x.to_str()?)?</code></td></tr> <tr><td><code>PathBuf</code></td><td><code>CString::new(x.to_str()?)?</code></td></tr> <tr><td><code>Vec&lt;u8&gt;</code> <sup>1</sup></td><td><code>CString::new(x)?</code></td></tr> <tr><td><code>&amp;str</code></td><td><code>CString::new(x)?</code></td></tr> <tr><td><code>&amp;CStr</code></td><td><code>x.to_owned()</code> <sup><code>i</code></sup></td></tr> <tr><td><code>&amp;OsStr</code> <sup>2</sup></td><td><code>CString::new(x.to_os_string().into_string()?)?</code></td></tr> <tr><td><code>&amp;Path</code></td><td><code>CString::new(x.to_str()?)?</code></td></tr> <tr><td><code>&amp;[u8]</code> <sup>1</sup></td><td><code>CString::new(Vec::from(x))?</code></td></tr> <tr><td><code>*mut c_char</code> <sup>3</sup></td><td><code>unsafe { CString::from_raw(x) }</code></td></tr> </tbody></table> </div></panel></tab>  <tab> <input type="radio" id="tab-str-3" name="tab-group-str"> <label for="tab-str-3"><code>OsString</code></label> <panel><div class="stringconversion"> <table><thead><tr><th>If you <strong>have</strong> <code>x</code> of type …</th><th>Use this …</th></tr></thead><tbody> <tr><td><code>String</code></td><td><code>OsString::from(x)</code> <sup><code>i</code></sup></td></tr> <tr><td><code>CString</code></td><td><code>OsString::from(x.to_str()?)</code></td></tr> <tr><td><code>OsString</code></td><td><code>x</code></td></tr> <tr><td><code>PathBuf</code></td><td><code>x.into_os_string()</code></td></tr> <tr><td><code>Vec&lt;u8&gt;</code> <sup>1</sup></td><td><sup>?</sup></td></tr> <tr><td><code>&amp;str</code></td><td><code>OsString::from(x)</code> <sup><code>i</code></sup></td></tr> <tr><td><code>&amp;CStr</code></td><td><code>OsString::from(x.to_str()?)</code></td></tr> <tr><td><code>&amp;OsStr</code></td><td><code>OsString::from(x)</code> <sup><code>i</code></sup></td></tr> <tr><td><code>&amp;Path</code></td><td><code>x.as_os_str().to_owned()</code></td></tr> <tr><td><code>&amp;[u8]</code> <sup>1</sup></td><td><sup>?</sup></td></tr> </tbody></table> </div></panel></tab>  <tab> <input type="radio" id="tab-str-35" name="tab-group-str"> <label for="tab-str-35"><code>PathBuf</code></label> <panel><div class="stringconversion"> <table><thead><tr><th>If you <strong>have</strong> <code>x</code> of type …</th><th>Use this …</th></tr></thead><tbody> <tr><td><code>String</code></td><td><code>PathBuf::from(x)</code> <sup><code>i</code></sup></td></tr> <tr><td><code>CString</code></td><td><code>PathBuf::from(x.to_str()?)</code></td></tr> <tr><td><code>OsString</code></td><td><code>PathBuf::from(x)</code> <sup><code>i</code></sup></td></tr> <tr><td><code>PathBuf</code></td><td><code>x</code></td></tr> <tr><td><code>Vec&lt;u8&gt;</code> <sup>1</sup></td><td><sup>?</sup></td></tr> <tr><td><code>&amp;str</code></td><td><code>PathBuf::from(x)</code> <sup><code>i</code></sup></td></tr> <tr><td><code>&amp;CStr</code></td><td><code>PathBuf::from(x.to_str()?)</code></td></tr> <tr><td><code>&amp;OsStr</code></td><td><code>PathBuf::from(x)</code> <sup><code>i</code></sup></td></tr> <tr><td><code>&amp;Path</code></td><td><code>PathBuf::from(x)</code> <sup><code>i</code></sup></td></tr> <tr><td><code>&amp;[u8]</code> <sup>1</sup></td><td><sup>?</sup></td></tr> </tbody></table> </div></panel></tab>  <tab> <input type="radio" id="tab-str-4" name="tab-group-str"> <label for="tab-str-4"><code>Vec&lt;u8&gt;</code></label> <panel><div class="stringconversion"> <table><thead><tr><th>If you <strong>have</strong> <code>x</code> of type …</th><th>Use this …</th></tr></thead><tbody> <tr><td><code>String</code></td><td><code>x.into_bytes()</code></td></tr> <tr><td><code>CString</code></td><td><code>x.into_bytes()</code></td></tr> <tr><td><code>OsString</code></td><td><sup>?</sup></td></tr> <tr><td><code>PathBuf</code></td><td><sup>?</sup></td></tr> <tr><td><code>Vec&lt;u8&gt;</code> <sup>1</sup></td><td><code>x</code></td></tr> <tr><td><code>&amp;str</code></td><td><code>Vec::from(x.as_bytes())</code></td></tr> <tr><td><code>&amp;CStr</code></td><td><code>Vec::from(x.to_bytes_with_nul())</code></td></tr> <tr><td><code>&amp;OsStr</code></td><td><sup>?</sup></td></tr> <tr><td><code>&amp;Path</code></td><td><sup>?</sup></td></tr> <tr><td><code>&amp;[u8]</code> <sup>1</sup></td><td><code>x.to_vec()</code></td></tr> </tbody></table> </div></panel></tab>  <tab> <input type="radio" id="tab-str-5" name="tab-group-str"> <label for="tab-str-5"><code>&str</code></label> <panel><div class="stringconversion"> <table><thead><tr><th>If you <strong>have</strong> <code>x</code> of type …</th><th>Use this …</th></tr></thead><tbody> <tr><td><code>String</code></td><td><code>x.as_str()</code></td></tr> <tr><td><code>CString</code></td><td><code>x.to_str()?</code></td></tr> <tr><td><code>OsString</code></td><td><code>x.to_str()?</code></td></tr> <tr><td><code>PathBuf</code></td><td><code>x.to_str()?</code></td></tr> <tr><td><code>Vec&lt;u8&gt;</code> <sup>1</sup></td><td><code>std::str::from_utf8(&amp;x)?</code></td></tr> <tr><td><code>&amp;str</code></td><td><code>x</code></td></tr> <tr><td><code>&amp;CStr</code></td><td><code>x.to_str()?</code></td></tr> <tr><td><code>&amp;OsStr</code></td><td><code>x.to_str()?</code></td></tr> <tr><td><code>&amp;Path</code></td><td><code>x.to_str()?</code></td></tr> <tr><td><code>&amp;[u8]</code> <sup>1</sup></td><td><code>std::str::from_utf8(x)?</code></td></tr> </tbody></table> </div></panel></tab>  <tab> <input type="radio" id="tab-str-6" name="tab-group-str"> <label for="tab-str-6"><code>&CStr</code></label> <panel><div class="stringconversion"> <table><thead><tr><th>If you <strong>have</strong> <code>x</code> of type …</th><th>Use this …</th></tr></thead><tbody> <tr><td><code>String</code></td><td><code>CString::new(x)?.as_c_str()</code></td></tr> <tr><td><code>CString</code></td><td><code>x.as_c_str()</code></td></tr> <tr><td><code>OsString</code> <sup>2</sup></td><td><code>x.to_str()?</code></td></tr> <tr><td><code>PathBuf</code></td><td><sup>?</sup><sup>,4</sup></td></tr> <tr><td><code>Vec&lt;u8&gt;</code> <sup>1</sup><sup>,5</sup></td><td><code>CStr::from_bytes_with_nul(&amp;x)?</code></td></tr> <tr><td><code>&amp;str</code></td><td><sup>?</sup><sup>,4</sup></td></tr> <tr><td><code>&amp;CStr</code></td><td><code>x</code></td></tr> <tr><td><code>&amp;OsStr</code> <sup>2</sup></td><td><sup>?</sup></td></tr> <tr><td><code>&amp;Path</code></td><td><sup>?</sup></td></tr> <tr><td><code>&amp;[u8]</code> <sup>1</sup><sup>,5</sup></td><td><code>CStr::from_bytes_with_nul(x)?</code></td></tr> <tr><td><code>*const c_char</code> <sup>1</sup></td><td><code>unsafe { CStr::from_ptr(x) }</code></td></tr> </tbody></table> </div></panel></tab>  <tab> <input type="radio" id="tab-str-8" name="tab-group-str"> <label for="tab-str-8"><code>&OsStr</code></label> <panel><div class="stringconversion"> <table><thead><tr><th>If you <strong>have</strong> <code>x</code> of type …</th><th>Use this …</th></tr></thead><tbody> <tr><td><code>String</code></td><td><code>OsStr::new(&amp;x)</code></td></tr> <tr><td><code>CString</code></td><td><sup>?</sup></td></tr> <tr><td><code>OsString</code></td><td><code>x.as_os_str()</code></td></tr> <tr><td><code>PathBuf</code></td><td><code>x.as_os_str()</code></td></tr> <tr><td><code>Vec&lt;u8&gt;</code> <sup>1</sup></td><td><sup>?</sup></td></tr> <tr><td><code>&amp;str</code></td><td><code>OsStr::new(x)</code></td></tr> <tr><td><code>&amp;CStr</code></td><td><sup>?</sup></td></tr> <tr><td><code>&amp;OsStr</code></td><td><code>x</code></td></tr> <tr><td><code>&amp;Path</code></td><td><code>x.as_os_str()</code></td></tr> <tr><td><code>&amp;[u8]</code> <sup>1</sup></td><td><sup>?</sup></td></tr> </tbody></table> </div></panel></tab>  <tab> <input type="radio" id="tab-str-85" name="tab-group-str"> <label for="tab-str-85"><code>&Path</code></label> <panel><div class="stringconversion"> <table><thead><tr><th>If you <strong>have</strong> <code>x</code> of type …</th><th>Use this …</th></tr></thead><tbody> <tr><td><code>String</code></td><td><code>Path::new(x)</code> <sup><code>r</code></sup></td></tr> <tr><td><code>CString</code></td><td><code>Path::new(x.to_str()?)</code></td></tr> <tr><td><code>OsString</code></td><td><code>Path::new(x.to_str()?)</code> <sup><code>r</code></sup></td></tr> <tr><td><code>PathBuf</code></td><td><code>Path::new(x.to_str()?)</code> <sup><code>r</code></sup></td></tr> <tr><td><code>Vec&lt;u8&gt;</code> <sup>1</sup></td><td><sup>?</sup></td></tr> <tr><td><code>&amp;str</code></td><td><code>Path::new(x)</code> <sup><code>r</code></sup></td></tr> <tr><td><code>&amp;CStr</code></td><td><code>Path::new(x.to_str()?)</code></td></tr> <tr><td><code>&amp;OsStr</code></td><td><code>Path::new(x)</code> <sup><code>r</code></sup></td></tr> <tr><td><code>&amp;Path</code></td><td><code>x</code></td></tr> <tr><td><code>&amp;[u8]</code> <sup>1</sup></td><td><sup>?</sup></td></tr> </tbody></table> </div></panel></tab>  <tab> <input type="radio" id="tab-str-7" name="tab-group-str"> <label for="tab-str-7"><code>&[u8]</code></label> <panel><div class="stringconversion"> <table><thead><tr><th>If you <strong>have</strong> <code>x</code> of type …</th><th>Use this …</th></tr></thead><tbody> <tr><td><code>String</code></td><td><code>x.as_bytes()</code></td></tr> <tr><td><code>CString</code></td><td><code>x.as_bytes()</code></td></tr> <tr><td><code>OsString</code></td><td><sup>?</sup></td></tr> <tr><td><code>PathBuf</code></td><td><sup>?</sup></td></tr> <tr><td><code>Vec&lt;u8&gt;</code> <sup>1</sup></td><td><code>&amp;x</code></td></tr> <tr><td><code>&amp;str</code></td><td><code>x.as_bytes()</code></td></tr> <tr><td><code>&amp;CStr</code></td><td><code>x.to_bytes_with_nul()</code></td></tr> <tr><td><code>&amp;OsStr</code></td><td><code>x.as_bytes()</code> <sup>2</sup></td></tr> <tr><td><code>&amp;Path</code></td><td><sup>?</sup></td></tr> <tr><td><code>&amp;[u8]</code> <sup>1</sup></td><td><code>x</code></td></tr> </tbody></table> </div></panel></tab>  <tab> <input type="radio" id="tab-str-9" name="tab-group-str"> <label for="tab-str-9"><b>Other</b></label> <panel><div class="stringconversion"> <table><thead><tr><th>You <strong>want</strong></th><th>And <strong>have</strong> <code>x</code></th><th>Use this …</th></tr></thead><tbody> <tr><td><b><code>*const c_char</code></b></td><td><b><code>CString</code></b></td><td><code>x.as_ptr()</code></td></tr> </tbody></table> </div></panel></tab>  </tabs>  </div></div> <footnotes> <p><sup>i</sup> Short form <code>x.into()</code> possible if type can be inferred. <br> <sup>r</sup> Short form <code>x.as_ref()</code> possible if type can be inferred.</p> <p><sup>1</sup> You should, or must if call is <code>unsafe</code>, ensure raw data comes with a valid representation for the string type (e.g., UTF-8 data for a <code>String</code>). <a href="https:&#x2F;&#x2F;people.gnome.org&#x2F;~federico&#x2F;blog&#x2F;correctness-in-rust-reading-strings.html"><sup>🔗</sup></a></p> <p><sup>2</sup> Only on some platforms <code>std::os::&lt;your_os&gt;::ffi::OsStrExt</code> exists with helper methods to get a raw <code>&amp;[u8]</code> representation of the underlying <code>OsStr</code>. Use the rest of the table to go from there, e.g.:</p> <pre><code>use std::os::unix::ffi::OsStrExt;
let bytes: &amp;[u8] = my_os_str.as_bytes();
CString::new(bytes)?
</code></pre> <p><sup>3</sup> The <code>c_char</code> <strong>must</strong> have come from a previous <code>CString</code>. If it comes from FFI see <code>&amp;CStr</code> instead.</p> <p><sup>4</sup> No known shorthand as <code>x</code> will lack terminating <code>0x0</code>. Best way to probably go via <code>CString</code>.</p> <p><sup>5</sup> Must ensure vector actually ends with <code>0x0</code>.</p> </footnotes> <h2 id="string-output">字符串输出<sup id="target-string-output" class="target"><a href="#string-output">url</a></sup></h2> <p>How to convert types into a <code>String</code>, or output them.</p> <tabs>  <tab> <input type="radio" id="tab-strop-1" name="tab-group-strop" checked> <label for="tab-strop-1"><b>APIs</b></label> <panel><div class="color-header undefined-color-3"> <p>Rust has, among others, these APIs to convert types to stringified output, collectively called <em>format</em> macros:</p> <table><thead><tr><th>Macro</th><th>Output</th><th>Notes</th></tr></thead><tbody> <tr><td><code>format!(fmt)</code></td><td><code>String</code></td><td>Bread-and-butter &quot;to <code>String</code>&quot; converter.</td></tr> <tr><td><code>print!(fmt)</code></td><td>Console</td><td>Writes to standard output.</td></tr> <tr><td><code>println!(fmt)</code></td><td>Console</td><td>Writes to standard output.</td></tr> <tr><td><code>eprint!(fmt)</code></td><td>Console</td><td>Writes to standard error.</td></tr> <tr><td><code>eprintln!(fmt)</code></td><td>Console</td><td>Writes to standard error.</td></tr> <tr><td><code>write!(dst, fmt)</code></td><td>Buffer</td><td>Don't forget to also <code>use std::io::Write;</code></td></tr> <tr><td><code>writeln!(dst, fmt)</code></td><td>Buffer</td><td>Don't forget to also <code>use std::io::Write;</code></td></tr> </tbody></table> <div>&nbsp;</div><table><thead><tr><th>Method</th><th>Notes</th></tr></thead><tbody> <tr><td><code>x.to_string()</code> <a href="https://doc.rust-lang.org/std&#x2F;string&#x2F;trait.ToString.html"><sup class="mid">STD</sup></a></td><td>Produces <code>String</code>, implemented for any <code>Display</code> type.</td></tr> </tbody></table> <div>&nbsp;</div> <p>Here <code>fmt</code> is string literal such as <code>&quot;hello {}&quot;</code>, that specifies output (compare &quot;Formatting&quot; tab) and additional parameters.</p> </div></panel></tab>  <tab> <input type="radio" id="tab-strop-2" name="tab-group-strop"> <label for="tab-strop-2"><b>Printable Types</b></label> <panel><div class="color-header undefined-color-3"> <p>In <code>format!</code> and friends, types convert via trait <code>Display</code> <code>&quot;{}&quot;</code> <a href="https://doc.rust-lang.org/std&#x2F;fmt&#x2F;trait.Display.html"><sup class="mid">STD</sup></a> or <code>Debug</code> <code>&quot;{:?}&quot;</code> <a href="https://doc.rust-lang.org/std&#x2F;fmt&#x2F;trait.Debug.html"><sup class="mid">STD</sup></a> , non exhaustive list:</p> <table><thead><tr><th>Type</th><th>Implements</th><th></th></tr></thead><tbody> <tr><td><code>String</code></td><td><code>Debug, Display</code></td><td></td></tr> <tr><td><code>CString</code></td><td><code>Debug</code></td><td></td></tr> <tr><td><code>OsString</code></td><td><code>Debug</code></td><td></td></tr> <tr><td><code>PathBuf</code></td><td><code>Debug</code></td><td></td></tr> <tr><td><code>Vec&lt;u8&gt;</code></td><td><code>Debug</code></td><td></td></tr> <tr><td><code>&amp;str</code></td><td><code>Debug, Display</code></td><td></td></tr> <tr><td><code>&amp;CStr</code></td><td><code>Debug</code></td><td></td></tr> <tr><td><code>&amp;OsStr</code></td><td><code>Debug</code></td><td></td></tr> <tr><td><code>&amp;Path</code></td><td><code>Debug</code></td><td></td></tr> <tr><td><code>&amp;[u8]</code></td><td><code>Debug</code></td><td></td></tr> <tr><td><code>bool</code></td><td><code>Debug, Display</code></td><td></td></tr> <tr><td><code>char</code></td><td><code>Debug, Display</code></td><td></td></tr> <tr><td><code>u8</code> … <code>i128</code></td><td><code>Debug, Display</code></td><td></td></tr> <tr><td><code>f32</code>, <code>f64</code></td><td><code>Debug, Display</code></td><td></td></tr> <tr><td><code>!</code></td><td><code>Debug, Display</code></td><td></td></tr> <tr><td><code>()</code></td><td><code>Debug</code></td><td></td></tr> </tbody></table> <div>&nbsp;</div> <p>In short, pretty much everything is <code>Debug</code>; more <em>special</em> types might need special handling or conversion <a href="#string-conversions"><sup>↑</sup></a> to <code>Display</code>.</p> </div></panel></tab>  <tab> <input type="radio" id="tab-strop-3" name="tab-group-strop"> <label for="tab-strop-3"><b>Formatting</b></label> <panel><div> <p>Each argument designator in format macro is either empty <code>{}</code>, <code>{argument}</code>, or follows a basic <a href="https://doc.rust-lang.org/std/fmt/index.html#syntax"><strong>syntax</strong></a>:</p> <pre><code>{ [argument] &#x27;:&#x27; [[fill] align] [sign] [&#x27;#&#x27;] [width [$]] [&#x27;.&#x27; precision [$]] [type] }
</code></pre> <div class="color-header undefined-color-3"> <table><thead><tr><th>Element</th><th>Meaning</th></tr></thead><tbody> <tr><td><code>argument</code></td><td>Number (<code>0</code>, <code>1</code>, ...), argument <sup>&#x27;21</sup> or name,<sup>&#x27;18</sup> e.g., <code>print!(&quot;{x}&quot;)</code>.</td></tr> <tr><td><code>fill</code></td><td>The character to fill empty spaces with (e.g., <code>0</code>), if <code>width</code> is specified.</td></tr> <tr><td><code>align</code></td><td>Left (<code>&lt;</code>), center (<code>^</code>), or right (<code>&gt;</code>), if width is specified.</td></tr> <tr><td><code>sign</code></td><td>Can be <code>+</code> for sign to always be printed.</td></tr> <tr><td><code>#</code></td><td><a href="https://doc.rust-lang.org/std/fmt/index.html#sign0">Alternate formatting</a>, e.g. prettify <code>Debug</code><a href="https://doc.rust-lang.org/std&#x2F;fmt&#x2F;trait.Debug.html"><sup class="mid">STD</sup></a> formatter <code>?</code> or prefix hex with <code>0x</code>.</td></tr> <tr><td><code>width</code></td><td>Minimum width (≥ 0), padding with <code>fill</code> (default to space). If starts with <code>0</code>, zero-padded.</td></tr> <tr><td><code>precision</code></td><td>Decimal digits (≥ 0) for numerics, or max width for non-numerics.</td></tr> <tr><td><code>$</code></td><td>Interpret <code>width</code> or <code>precision</code> as argument identifier instead to allow for dynamic formatting.</td></tr> <tr><td><strong><code>type</code></strong></td><td><code>Debug</code><a href="https://doc.rust-lang.org/std&#x2F;fmt&#x2F;trait.Debug.html"><sup class="mid">STD</sup></a> (<code>?</code>) formatting, hex (<code>x</code>), binary (<code>b</code>), octal (<code>o</code>), pointer (<code>p</code>), exp (<code>e</code>) ... <a href="https://doc.rust-lang.org/std/fmt/index.html#traits">see more</a>.</td></tr> </tbody></table> </div> <div>&nbsp;</div><div class="color-header undefined-color-3"> <table><thead><tr><th>Format Example</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>{}</code></td><td>Print the next argument using <code>Display</code>.<a href="https://doc.rust-lang.org/std&#x2F;fmt&#x2F;trait.Display.html"><sup class="mid">STD</sup></a></td></tr> <tr><td><code>{x}</code></td><td>Same, but use variable <code>x</code> from scope. <sup>&#x27;21</sup></td></tr> <tr><td><code>{:?}</code></td><td>Print the next argument using <code>Debug</code>.<a href="https://doc.rust-lang.org/std&#x2F;fmt&#x2F;trait.Debug.html"><sup class="mid">STD</sup></a></td></tr> <tr><td><code>{2:#?}</code></td><td>Pretty-print the 3<sup>rd</sup> argument with <code>Debug</code><a href="https://doc.rust-lang.org/std&#x2F;fmt&#x2F;trait.Debug.html"><sup class="mid">STD</sup></a> formatting.</td></tr> <tr><td><code>{val:^2$}</code></td><td>Center the <code>val</code> named argument, width specified by the 3<sup>rd</sup> argument.</td></tr> <tr><td><code>{:&lt;10.3}</code></td><td>Left align with width 10 and a precision of 3.</td></tr> <tr><td><code>{val:#x}</code></td><td>Format <code>val</code> argument as hex, with a leading <code>0x</code> (alternate format for <code>x</code>).</td></tr> </tbody></table> </div> <div>&nbsp;</div><div class="color-header undefined-color-3"> <table><thead><tr><th>Full Example</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>println!(&quot;{}&quot;, x)</code></td><td>Print <code>x</code> using <code>Display</code><a href="https://doc.rust-lang.org/std&#x2F;fmt&#x2F;trait.Display.html"><sup class="mid">STD</sup></a> on std. out and append new line. <sup>&#x27;15</sup></td></tr> <tr><td><code>println!(&quot;{x}&quot;)</code></td><td>Same, but use variable <code>x</code> from scope. <sup>&#x27;21</sup></td></tr> <tr><td><code>format!(&quot;{a:.3} {b:?}&quot;)</code></td><td>Convert <code>PI</code> with 3 digits, add space, b with <code>Debug</code> <a href="https://doc.rust-lang.org/std&#x2F;fmt&#x2F;trait.Debug.html"><sup class="mid">STD</sup></a>, return <code>String</code>. <sup>&#x27;21</sup></td></tr> </tbody></table> </div> </div></panel></tab> </tabs> <div>&nbsp;</div> <hr> <h1 id="tooling">Tooling<sup id="target-tooling" class="target"><a href="#tooling">url</a></sup></h1> <h2 id="project-anatomy">Project Anatomy<sup id="target-project-anatomy" class="target"><a href="#project-anatomy">url</a></sup></h2> <p>Basic project layout, and common files and folders, as used by <code>cargo</code>. <a href="#cargo"><sup>↓</sup></a></p> <div class="color-header red"> <table><thead><tr><th>Entry</th><th>Code</th></tr></thead><tbody> <tr><td>📁 <code>.cargo/</code></td><td><strong>Project-local cargo configuration</strong>, may contain <strong><code>config.toml</code></strong>. <a href="https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;cargo&#x2F;reference&#x2F;config.html"><sup>🔗</sup></a> <sup style="font-size:100%;position:relative;top:-4px">🝖</sup></td></tr> <tr><td>📁 <code>benches/</code></td><td>Benchmarks for your crate, run via <strong><code>cargo bench</code></strong>, requires nightly by default. <sup>*</sup> <sup>🚧</sup></td></tr> <tr><td>📁 <code>examples/</code></td><td>Examples how to use your crate, they see your crate like external user would.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>my_example.rs</code></td><td>Individual examples are run like <strong><code>cargo run --example my_example</code></strong>.</td></tr> <tr><td>📁 <code>src/</code></td><td>Actual source code for your project.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>main.rs</code></td><td>Default entry point for applications, this is what <strong><code>cargo run</code></strong> uses.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>lib.rs</code></td><td>Default entry point for libraries. This is where lookup for <code>my_crate::f()</code> starts.</td></tr> <tr><td>📁 <code>src/bin/</code></td><td>Place for additional binaries, even in library projects.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>x.rs</code></td><td>Additional binary, run with <code>cargo run --bin x</code>.</td></tr> <tr><td>📁 <code>tests/</code></td><td>Integration tests go here, invoked via <strong><code>cargo test</code></strong>. Unit tests often stay in <code>src/</code> file.</td></tr> <tr><td><code>.rustfmt.toml</code></td><td>In case you want to <a href="https://rust-lang.github.io/rustfmt/"><strong>customize</strong></a> how <strong><code>cargo fmt</code></strong> works.</td></tr> <tr><td><code>.clippy.toml</code></td><td>Special configuration for certain <a href="https://rust-lang.github.io/rust-clippy/master/index.html"><strong>clippy lints</strong></a>, utilized via <strong><code>cargo clippy</code></strong> <sup style="font-size:100%;position:relative;top:-4px">🝖</sup></td></tr> <tr><td><code>build.rs</code></td><td><strong>Pre-build script</strong>, <a href="https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;cargo&#x2F;reference&#x2F;build-scripts.html"><sup>🔗</sup></a> useful when compiling C / FFI, ...</td></tr> <tr><td><code class="ignore-auto language-bash">Cargo.toml</code></td><td>Main <strong>project manifest</strong>, <a href="https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;cargo&#x2F;reference&#x2F;manifest.html"><sup>🔗</sup></a> Defines dependencies, artifacts ...</td></tr> <tr><td><code class="ignore-auto language-bash">Cargo.lock</code></td><td>Dependency details for reproducible builds; add to <code>git</code> for apps, not for libs.</td></tr> <tr><td><code>rust-toolchain.toml</code></td><td>Define <strong>toolchain override</strong><a href="https:&#x2F;&#x2F;rust-lang.github.io&#x2F;rustup&#x2F;overrides.html"><sup>🔗</sup></a> (channel, components, targets) for this project.</td></tr> </tbody></table> </div> <footnotes> <p><sup>*</sup> On stable consider <a href="https://github.com/bheisler/criterion.rs">Criterion</a>.</p> </footnotes> <div>&nbsp;</div> <p><strong>Minimal examples</strong> for various entry points might look like:</p> <tabs>  <tab> <input type="radio" id="tab-anatomy-1" name="tab-group-anatomy" checked> <label for="tab-anatomy-1"><b>Applications</b></label> <panel><div>  <div style="overflow:auto"> <div style="min-width:100%;width:650px"> <pre><code>&#x2F;&#x2F; src&#x2F;main.rs (default application entry point)

fn main() {
    println!(&quot;Hello, world!&quot;);
}
</code></pre> </div></div></div></panel></tab>  <tab> <input type="radio" id="tab-anatomy-2" name="tab-group-anatomy"> <label for="tab-anatomy-2"><b>Libraries</b></label> <panel><div>  <div style="overflow:auto"> <div style="min-width:100%;width:650px"> <pre><code>&#x2F;&#x2F; src&#x2F;lib.rs (default library entry point)

pub fn f() {}      &#x2F;&#x2F; Is a public item in root, so it&#x27;s accessible from the outside.

mod m {
    pub fn g() {}  &#x2F;&#x2F; No public path (`m` not public) from root, so `g`
}                  &#x2F;&#x2F; is not accessible from the outside of the crate.
</code></pre> </div></div></div></panel></tab>  <tab> <input type="radio" id="tab-anatomy-3" name="tab-group-anatomy"> <label for="tab-anatomy-3"><b>Unit Tests</b></label> <panel><div>  <div style="overflow:auto"> <div style="min-width:100%;width:650px"> <pre><code>&#x2F;&#x2F; src&#x2F;my_module.rs (any file of your project)

fn f() -&gt; u32 { 0 }

#[cfg(test)]
mod test {
    use super::f;           &#x2F;&#x2F; Need to import items from parent module. Has
                            &#x2F;&#x2F; access to non-public members.
    #[test]
    fn ff() {
        assert_eq!(f(), 0);
    }
}
</code></pre> </div></div></div></panel></tab>  <tab> <input type="radio" id="tab-anatomy-4" name="tab-group-anatomy"> <label for="tab-anatomy-4"><b>Integration Tests</b></label> <panel><div>  <div style="overflow:auto"> <div style="min-width:100%;width:650px"> <pre><code>&#x2F;&#x2F; tests&#x2F;sample.rs (sample integration test)

#[test]
fn my_sample() {
    assert_eq!(my_crate::f(), 123); &#x2F;&#x2F; Integration tests (and benchmarks) &#x27;depend&#x27; to the crate like
}                                   &#x2F;&#x2F; a 3rd party would. Hence, they only see public items.
</code></pre> </div></div></div></panel></tab>  <tab> <input type="radio" id="tab-anatomy-5" name="tab-group-anatomy"> <label for="tab-anatomy-5"><b>Benchmarks</b></label> <panel><div>  <div style="overflow:auto"> <div style="min-width:100%;width:650px"> <pre><code>&#x2F;&#x2F; benches&#x2F;sample.rs (sample benchmark)

#![feature(test)]   &#x2F;&#x2F; #[bench] is still experimental

extern crate test;  &#x2F;&#x2F; Even in &#x27;18 this is needed ... for reasons.
                    &#x2F;&#x2F; Normally you don&#x27;t need this in &#x27;18 code.

use test::{black_box, Bencher};

#[bench]
fn my_algo(b: &amp;mut Bencher) {
    b.iter(|| black_box(my_crate::f())); &#x2F;&#x2F; `black_box` prevents `f` from being optimized away.
}
</code></pre> </div></div></div></panel></tab>  <tab> <input type="radio" id="tab-anatomy-6" name="tab-group-anatomy"> <label for="tab-anatomy-6"><b>Build Scripts</b></label> <panel><div>  <div style="overflow:auto"> <div style="min-width:100%;width:650px"> <pre><code>&#x2F;&#x2F; build.rs (sample pre-build script)

fn main() {
    &#x2F;&#x2F; You need to rely on env. vars for target; `#[cfg(...)]` are for host.
    let target_os = env::var(&quot;CARGO_CFG_TARGET_OS&quot;);
}
</code></pre> <p><sup>*</sup><a href="https://doc.rust-lang.org/cargo/reference/environment-variables.html#environment-variables-cargo-sets-for-build-scripts">See here for list</a> of environment variables set.</p> </div></div></div></panel></tab>  <tab> <input type="radio" id="tab-anatomy-25" name="tab-group-anatomy"> <label for="tab-anatomy-25"><b>Proc Macros</b><sup style="font-size:100%;position:relative;top:-4px">🝖</sup></label> <panel><div>  <div style="overflow:auto"> <div style="min-width:100%;width:650px"> <pre><code>&#x2F;&#x2F; src&#x2F;lib.rs (default entry point for proc macros)

extern crate proc_macro;  &#x2F;&#x2F; Apparently needed to be imported like this.

use proc_macro::TokenStream;

#[proc_macro_attribute]   &#x2F;&#x2F; Can now be used as `#[my_attribute]`
pub fn my_attribute(_attr: TokenStream, item: TokenStream) -&gt; TokenStream {
    item
}
</code></pre> <pre><code>&#x2F;&#x2F; Cargo.toml

[package]
name = &quot;my_crate&quot;
version = &quot;0.1.0&quot;

[lib]
proc-macro = true
</code></pre> </div></div></div></panel></tab> </tabs> <div>&nbsp;</div> <p>Module trees and imports:</p> <tabs>  <tab> <input type="radio" id="tab-module-import-1" name="tab-group-module-import" checked> <label for="tab-module-import-1"><b>Module Trees</b></label> <panel><div>  <div style="overflow:auto"> <div style="min-width:100%;width:650px"> <p><strong>Modules</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch07-02-defining-modules-to-control-scope-and-privacy.html"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/mod.html#modules"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/items&#x2F;modules.html#modules"><sup class="expert">REF</sup></a> and <strong>source files</strong> work as follows:</p> <ul> <li><strong>Module tree</strong> needs to be explicitly defined, is <strong>not</strong> implicitly built from <strong>file system tree</strong>. <a href="http:&#x2F;&#x2F;www.sheshbabu.com&#x2F;posts&#x2F;rust-module-system&#x2F;"><sup>🔗</sup></a></li> <li><strong>Module tree root</strong> equals library, app, … entry point (e.g., <code>lib.rs</code>).</li> </ul> <p>Actual <strong>module definitions</strong> work as follows:</p> <ul> <li>A <strong><code>mod m {}</code></strong> defines module in-file, while <strong><code>mod m;</code></strong> will read <code>m.rs</code> or <code>m/mod.rs</code>.</li> <li>Path of <code>.rs</code> based on <strong>nesting</strong>, e.g., <code>mod a { mod b { mod c; }}}</code> is either <code>a/b/c.rs</code> or <code>a/b/c/mod.rs</code>.</li> <li>Files not pathed from module tree root via some <code>mod m;</code> won't be touched by compiler! <sup>🛑</sup></li> </ul>  </div></div></div></panel></tab>  <tab> <input type="radio" id="tab-module-import-2" name="tab-group-module-import"> <label for="tab-module-import-2"><b>Namespaces</b><sup style="font-size:100%;position:relative;top:-4px">🝖</sup></label> <panel><div> <p>Rust has three kinds of <strong>namespaces</strong>:</p> <table> <thead> <tr> <th>Namespace <i>Types</i></th> <th>Namespace <i>Functions</i></th> <th>Namespace <i>Macros</i></th> </tr> </thead> <tbody> <tr> <td><code>mod X {}</code></td> <td><code>fn X() {}</code></td> <td><code>macro_rules! X { ... }</code></td> </tr> <tr> <td><code>X</code> (crate)</td> <td><code>const X: u8 = 1;</code></td> <td><code></code></td> </tr> <tr> <td><code>trait X {}</code></td> <td><code>static X: u8 = 1;</code></td> <td><code></code></td> </tr> <tr> <td><code>enum X {}</code></td> <td><code></code></td> <td><code></code></td> </tr> <tr> <td><code>union X {}</code></td> <td><code></code></td> <td><code></code></td> </tr> <tr> <td><code>struct X {}</code></td> <td><code></code></td> <td><code></code></td> </tr> <tr> <td colspan="2" style="text-align:center"><code>struct X;</code><sup>1</sup></td> <td></td> </tr> <tr> <td colspan="2" style="text-align:center"><code>struct X();</code><sup>1</sup></td> <td></td> </tr> </tbody> </table> <footnotes> <p><sup>1</sup> Counts in <i>Types</i> and in <i>Functions</i>.</p> </footnotes> <ul> <li>In any given scope, for example within a module, only one item item per namespace can exist, e.g., <ul> <li><code>enum X {}</code> and <code>fn X() {}</code> can coexist</li> <li><code>struct X;</code> and <code>const X</code> cannot coexist</li> </ul> </li> <li>With a <code>use my_mod::X;</code> all items called <code>X</code> will be imported.</li> </ul> <blockquote> <p>Due to naming conventions (e.g., <code>fn</code> and <code>mod</code> are lowercase by convention) and <em>common sense</em> (most developers just don't name all things <code>X</code>) you won't have to worry about these <em>kinds</em> in most cases. They can, however, be a factor when designing macros.</p> </blockquote> </div></panel></tab> </tabs> <div>&nbsp;</div><h2 id="cargo">Cargo<sup id="target-cargo" class="target"><a href="#cargo">url</a></sup></h2> <p>Commands and tools that are good to know.</p> <div class="color-header tooling"> <table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody> <tr><td><code>cargo init</code></td><td>Create a new project for the latest edition.</td></tr> <tr><td><code>cargo <span class="cargo-prefix">b</span>uild</code></td><td>Build the project in debug mode (<code>--<span class="cargo-prefix">r</span>elease</code> for all optimization).</td></tr> <tr><td><code>cargo <span class="cargo-prefix">c</span>heck</code></td><td>Check if project would compile (much faster).</td></tr> <tr><td><code>cargo <span class="cargo-prefix">t</span>est</code></td><td>Run tests for the project.</td></tr> <tr><td><code>cargo <span class="cargo-prefix">d</span>oc --open</code></td><td>Locally generate documentation for your code and dependencies.</td></tr> <tr><td><code>cargo <span class="cargo-prefix">r</span>un</code></td><td>Run your project, if a binary is produced (main.rs).</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>cargo run --bin b</code></td><td>Run binary <code>b</code>. Unifies features with other dependents (can be confusing).</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>cargo run -p w</code></td><td>Run main of sub-workspace <code>w</code>. Treats features more as you would expect.</td></tr> <tr><td><code>cargo tree</code></td><td>Show dependency graph.</td></tr> <tr><td><code>cargo +{nightly, stable} ...</code></td><td>Use given toolchain for command, e.g., for 'nightly only' tools.</td></tr> <tr><td><code>cargo +nightly ...</code></td><td>Some nightly-only commands (substitute <code>...</code> with command below)</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>build -Z timings</code></td><td>Show what crates caused your build to take so long, highly useful. <sup>🚧</sup> <sup>🔥</sup></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>rustc -- -Zunpretty=expanded</code></td><td>Show expanded macros. <sup>🚧</sup></td></tr> <tr><td><code>rustup doc</code></td><td>Open offline Rust documentation (incl. the books), good on a plane!</td></tr> </tbody></table> </div> <footnotes> <p>Here <code>cargo <span class="cargo-prefix">b</span>uild</code> means you can either type <code>cargo build</code> or just <code>cargo b</code>; and <code>--<span class="cargo-prefix">r</span>elease</code> means it can be replaced with <code>-r</code>.</p> </footnotes> <div>&nbsp;</div> <p>These are optional <code>rustup</code> components. Install them with <code>rustup component add [tool]</code>.</p> <div class="color-header tooling"> <table><thead><tr><th>Tool</th><th>Description</th></tr></thead><tbody> <tr><td><code>cargo clippy</code></td><td>Additional (<a href="https://rust-lang.github.io/rust-clippy/master/">lints</a>) catching common API misuses and unidiomatic code. <a href="https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust-clippy"><sup>🔗</sup></a></td></tr> <tr><td><code>cargo fmt</code></td><td>Automatic code formatter (<code>rustup component add rustfmt</code>). <a href="https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rustfmt"><sup>🔗</sup></a></td></tr> </tbody></table> </div> <div>&nbsp;</div> <p>A large number of additional cargo plugins <a href="https://crates.io/categories/development-tools::cargo-plugins?sort=downloads"><strong>can be found here</strong></a>.</p> <div>&nbsp;</div><h2 id="cross-compilation">Cross Compilation<sup id="target-cross-compilation" class="target"><a href="#cross-compilation">url</a></sup></h2>   <div style="overflow:auto"> <div style="min-width:100%;width:650px"> <p>🔘 Check <a href="https://doc.rust-lang.org/rustc/platform-support.html">target is supported</a>.</p> <p>🔘 Install target via <strong><code>rustup target install X</code></strong>.</p> <p>🔘 Install native toolchain (required to <em>link</em>, depends on target).</p> <p>Get from target vendor (Google, Apple, …), might not be available on all hosts (e.g., no iOS toolchain on Windows).</p> <p><strong>Some toolchains require additional build steps</strong> (e.g., Android's <code>make-standalone-toolchain.sh</code>).</p> <p>🔘 Update <strong><code>~/.cargo/config.toml</code></strong> like this:</p> <pre><code>[target.aarch64-linux-android]
linker = &quot;[PATH_TO_TOOLCHAIN]&#x2F;aarch64-linux-android&#x2F;bin&#x2F;aarch64-linux-android-clang&quot;
</code></pre> <p>or</p> <pre><code>[target.aarch64-linux-android]
linker = &quot;C:&#x2F;[PATH_TO_TOOLCHAIN]&#x2F;prebuilt&#x2F;windows-x86_64&#x2F;bin&#x2F;aarch64-linux-android21-clang.cmd&quot;
</code></pre> <p>🔘 Set <strong>environment variables</strong> (optional, wait until compiler complains before setting):</p> <pre><code>set CC=C:\[PATH_TO_TOOLCHAIN]\prebuilt\windows-x86_64\bin\aarch64-linux-android21-clang.cmd
set CXX=C:\[PATH_TO_TOOLCHAIN]\prebuilt\windows-x86_64\bin\aarch64-linux-android21-clang.cmd
set AR=C:\[PATH_TO_TOOLCHAIN]\prebuilt\windows-x86_64\bin\aarch64-linux-android-ar.exe
...
</code></pre> <p>Whether you set them depends on how compiler complains, not necessarily all are needed.</p> <blockquote> <p>Some platforms / configurations can be <strong>extremely sensitive</strong> how paths are specified (e.g., <code>\</code> vs <code>/</code>) and quoted.</p> </blockquote> <p>✔️ Compile with <strong><code>cargo build --target=X</code></strong></p>  </div> </div>   <div>&nbsp;</div><h2 id="tooling-directives">Tooling Directives<sup id="target-tooling-directives" class="target"><a href="#tooling-directives">url</a></sup></h2> <p>Special tokens embedded in source code used by tooling or preprocessing.</p> <tabs>  <tab> <input type="radio" id="tab-preprocessing-1" name="tab-group-preprocessing" checked> <label for="tab-preprocessing-1"><b>Macros</b></label> <panel><div class="color-header undefined-color-3"> <fixed-2-column class="color-header special_example">   <p>Inside a <strong>declarative</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch19-06-macros.html#declarative-macros-with-macro_rules-for-general-metaprogramming"><sup class="entry">BK</sup></a> <strong>macro by example</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch19-06-macros.html"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/macros.html#macro_rules"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/macros-by-example.html"><sup class="expert">REF</sup></a> <code>macro_rules!</code> implementation these work:</p> <table><thead><tr><th>Within Macros</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>$x:ty</code></td><td>Macro capture (here a type).</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>$x:item</code></td><td>An item, like a function, struct, module, etc.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>$x:block</code></td><td>A block <code>{}</code> of statements or expressions, e.g., <code>{ let x = 5; }</code></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>$x:stmt</code></td><td>A statement, e.g., <code>let x = 1 + 1;</code>, <code>String::new();</code> or <code>vec![];</code></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>$x:expr</code></td><td>An expression, e.g., <code>x</code>, <code>1 + 1</code>, <code>String::new()</code> or <code>vec![]</code></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>$x:pat</code></td><td>A pattern, e.g., <code>Some(t)</code>, <code>(17, 'a')</code> or <code>_</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>$x:ty</code></td><td>A type, e.g., <code>String</code>, <code>usize</code> or <code>Vec&lt;u8&gt;</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>$x:ident</code></td><td>An identifier, for example in <code>let x = 0;</code> the identifier is <code>x</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>$x:path</code></td><td>A path (e.g. <code>foo</code>, <code>::std::mem::replace</code>, <code>transmute::&lt;_, int&gt;</code>).</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>$x:literal</code></td><td>A literal (e.g. <code>3</code>, <code>&quot;foo&quot;</code>, <code>b&quot;bar&quot;</code>, etc.).</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>$x:lifetime</code></td><td>A lifetime (e.g. <code>'a</code>, <code>'static</code>, etc.).</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>$x:meta</code></td><td>A meta item; the things that go inside <code>#[...]</code> and <code>#![...]</code> attributes.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>$x:vis</code></td><td>A visibility modifier; <code>pub</code>, <code>pub(crate)</code>, etc.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>$x:tt</code></td><td>A single token tree, <a href="https://stackoverflow.com/a/40303308">see here</a> for more details.</td></tr> <tr><td><code>$crate</code></td><td>Special hygiene variable, crate where macros is defined. <sup>?</sup></td></tr> </tbody></table> </fixed-2-column> </div></panel></tab>  <tab> <input type="radio" id="tab-preprocessing-2" name="tab-group-preprocessing"> <label for="tab-preprocessing-2"><b>Documentation</b></label> <panel><div class="color-header undefined-color-2"> <fixed-2-column class="color-header special_example">  <p>Inside a <strong>doc comment</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch14-02-publishing-to-crates-io.html#making-useful-documentation-comments"><sup class="entry">BK</sup></a> <a href="https://rustwiki.org/zh-CN/rust-by-example/meta&#x2F;doc.html#documentation"><sup class="entry">EX</sup></a> <a href="https://rustwiki.org/zh-CN/reference/comments.html#doc-comments"><sup class="expert">REF</sup></a> these work:</p> <table><thead><tr><th>Within Doc Comments</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>```...```</code></td><td>Include a <a href="https://doc.rust-lang.org/rustdoc/documentation-tests.html"><strong>doc test</strong></a> (doc code running on <code>cargo test</code>).</td></tr> <tr><td><code>```X,Y ...```</code></td><td>Same, and include optional configurations; with <code>X</code>, <code>Y</code> being ...</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code style="color:grey">rust</code></td><td>Make it explicit test is written in Rust; implied by Rust tooling.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code style="color:grey;opacity:.3">-</code></td><td>Compile test. Run test. Fail if panic. <strong>Default behavior</strong>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code style="color:grey">should_panic</code></td><td>Compile test. Run test. Execution should panic. If not, fail test.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code style="color:grey">no_run</code></td><td>Compile test. Fail test if code can't be compiled, Don't run test.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code style="color:grey">compile_fail</code></td><td>Compile test but fail test if code <em>can</em> be compiled.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code style="color:grey">ignore</code></td><td>Do not compile. Do not run. Prefer option above instead.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code style="color:grey">edition2018</code></td><td>Execute code as Rust '18; default is '15.</td></tr> <tr><td><code>#</code></td><td>Hide line from documentation (<code>``` # use x::hidden; ```</code>).</td></tr> <tr><td><code>[`S`]</code></td><td>Create a link to struct, enum, trait, function, … <code>S</code>.</td></tr> <tr><td><code>[`S`](crate::S)</code></td><td>Paths can also be used, in the form of markdown links.</td></tr> </tbody></table> </fixed-2-column> </div></panel></tab>  <tab> <input type="radio" id="tab-preprocessing-7" name="tab-group-preprocessing"> <label for="tab-preprocessing-7"><b><code>#![globals]</code></b></label> <panel><div class="color-header undefined-color-3">  <fixed-3-column class="color-header special_example"> <p>Attributes affecting the whole crate or app:</p> <table><thead><tr><th>Opt-Out's</th><th>On</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>#![no_std]</code></td><td><code>C</code></td><td>Don't (automatically) import <strong><code>std</code></strong><a href="https://doc.rust-lang.org/std&#x2F;"><sup class="mid">STD</sup></a> ; use <strong><code>core</code></strong><a href="https://doc.rust-lang.org/core&#x2F;"><sup class="mid">STD</sup></a> instead. <a href="https://rustwiki.org/zh-CN/reference/names&#x2F;preludes.html#the-no_std-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#![no_implicit_prelude]</code></td><td><code>CM</code></td><td>Don't add <strong><code>prelude</code></strong><a href="https://doc.rust-lang.org/std&#x2F;prelude&#x2F;index.html"><sup class="mid">STD</sup></a>, need to manually import <code>None</code>, <code>Vec</code>, ... <a href="https://rustwiki.org/zh-CN/reference/names&#x2F;preludes.html#the-no_implicit_prelude-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#![no_main]</code></td><td><code>C</code></td><td>Don't emit <code>main()</code> in apps if you do that yourself. <a href="https://rustwiki.org/zh-CN/reference/crates-and-source-files.html#the-no_main-attribute"><sup class="expert">REF</sup></a></td></tr> </tbody></table>  <div>&nbsp;</div><table><thead><tr><th>Opt-In's</th><th>On</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>#![feature(a, b, c)]</code></td><td><code>C</code></td><td>Rely on features that may never get stabilized, <em>c.</em> <a href="https://doc.rust-lang.org/unstable-book/the-unstable-book.html"><strong>Unstable Book</strong></a>. <sup>🚧</sup></td></tr> </tbody></table> <div>&nbsp;</div><table><thead><tr><th>Builds</th><th>On</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>#![windows_subsystem = &quot;x&quot;]</code></td><td><code>C</code></td><td>On Windows, make a <code>console</code> or <code>windows</code> app. <a href="https://rustwiki.org/zh-CN/reference/runtime.html#the-windows_subsystem-attribute"><sup class="expert">REF</sup></a> <sup style="font-size:100%;position:relative;top:-4px">🝖</sup></td></tr> <tr><td><code>#![crate_name = &quot;x&quot;]</code></td><td><code>C</code></td><td>Specifiy current crate name, e.g., when not using <code>cargo</code>. <sup>?</sup> <a href="https://rustwiki.org/zh-CN/reference/crates-and-source-files.html#the-crate_name-attribute"><sup class="expert">REF</sup></a> <sup style="font-size:100%;position:relative;top:-4px">🝖</sup></td></tr> <tr><td><code>#![crate_type = &quot;bin&quot;]</code></td><td><code>C</code></td><td>Specifiy current crate type (<code>bin</code>, <code>lib</code>, <code>dylib</code>, <code>cdylib</code>, ...). <a href="https://rustwiki.org/zh-CN/reference/linkage.html"><sup class="expert">REF</sup></a> <sup style="font-size:100%;position:relative;top:-4px">🝖</sup></td></tr> <tr><td><code>#![recursion_limit = &quot;123&quot;]</code></td><td><code>C</code></td><td>Set <em>compile-time</em> recursion limit for deref, macros, ... <a href="https://rustwiki.org/zh-CN/reference/attributes&#x2F;limits.html#the-recursion_limit-attribute"><sup class="expert">REF</sup></a> <sup style="font-size:100%;position:relative;top:-4px">🝖</sup></td></tr> <tr><td><code>#![type_length_limit = &quot;456&quot;]</code></td><td><code>C</code></td><td>Limits maximum number of type substitutions. <a href="https://rustwiki.org/zh-CN/reference/attributes&#x2F;limits.html#the-type_length_limit-attribute"><sup class="expert">REF</sup></a> <sup style="font-size:100%;position:relative;top:-4px">🝖</sup></td></tr> </tbody></table> <div>&nbsp;</div><table><thead><tr><th>Handlers</th><th>On</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>#[panic_handler]</code></td><td><code>F</code></td><td>Make some <code>fn f(&amp;PanicInfo) -&gt; !</code> app's <strong>panic handler</strong>. <a href="https://rustwiki.org/zh-CN/reference/runtime.html#the-panic_handler-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[global_allocator]</code></td><td><code>S</code></td><td>Make static item impl. <code>GlobalAlloc</code> <a href="https://doc.rust-lang.org/alloc&#x2F;alloc&#x2F;trait.GlobalAlloc.html"><sup class="mid">STD</sup></a> <strong>global allocator</strong>. <a href="https://rustwiki.org/zh-CN/reference/runtime.html#the-global_allocator-attribute"><sup class="expert">REF</sup></a></td></tr> </tbody></table> </fixed-3-column> </div></panel></tab>  <tab> <input type="radio" id="tab-preprocessing-4" name="tab-group-preprocessing"> <label for="tab-preprocessing-4"><b><code>#[code]</code></b></label> <panel><div class="color-header undefined-color-3"> <p>Attributes primarily governing emitted code:</p> <fixed-3-column class="color-header special_example"> <table><thead><tr><th>Developer UX</th><th>On</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>#[non_exhaustive]</code></td><td><code>T</code></td><td>Future-proof <code>struct</code> or <code>enum</code>; hint it may grow in future. <a href="https://rustwiki.org/zh-CN/reference/attributes&#x2F;type_system.html#the-non_exhaustive-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[path = &quot;x.rs&quot;]</code></td><td><code>M</code></td><td>Get module from non-standard file. <a href="https://rustwiki.org/zh-CN/reference/items&#x2F;modules.html#the-path-attribute"><sup class="expert">REF</sup></a></td></tr> </tbody></table> <div>&nbsp;</div><table><thead><tr><th>Codegen</th><th>On</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>#[inline]</code></td><td><code>F</code></td><td>Nicely suggest compiler should inline function at call sites. <a href="https://rustwiki.org/zh-CN/reference/attributes&#x2F;codegen.html#the-inline-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[inline(always)]</code></td><td><code>F</code></td><td>Emphatically threaten compiler to inline call, or else. <a href="https://rustwiki.org/zh-CN/reference/attributes&#x2F;codegen.html#the-inline-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[inline(never)]</code></td><td><code>F</code></td><td>Instruct compiler to feel disappointed if it still inlines the function. <a href="https://rustwiki.org/zh-CN/reference/attributes&#x2F;codegen.html#the-inline-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[cold]</code></td><td><code>F</code></td><td>Hint that function probably isn't going to be called. <a href="https://rustwiki.org/zh-CN/reference/codegen.html#the-cold-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[target_feature(enable=&quot;x&quot;)]</code></td><td><code>F</code></td><td>Enable CPU feature (e.g., <code>avx2</code>) for code of <code>unsafe fn</code>. <a href="https://rustwiki.org/zh-CN/reference/attributes&#x2F;codegen.html#the-target_feature-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[track_caller]</code></td><td><code>F</code></td><td>Allows <code>fn</code> to find <strong><code>caller</code></strong><a href="https://doc.rust-lang.org/core&#x2F;panic&#x2F;struct.Location.html#method.caller"><sup class="mid">STD</sup></a> for better panic messages. <a href="https://rustwiki.org/zh-CN/reference/attributes&#x2F;codegen.html#the-track_caller-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[repr(X)]</code><sup>1</sup></td><td><code>T</code></td><td>Use another representation instead of the default <strong><code>rust</code></strong> <a href="https://rustwiki.org/zh-CN/reference/type-layout.html#the-default-representation"><sup class="expert">REF</sup></a> one:</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>#[repr(C)]</code></td><td><code>T</code></td><td>Use a C-compatible (f. FFI), predictable (f. <code>transmute</code>) layout. <a href="https://rustwiki.org/zh-CN/reference/type-layout.html#the-c-representation"><sup class="expert">REF</sup></a></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>#[repr(C, u8)]</code></td><td><code>enum</code></td><td>Give <code>enum</code> discriminant the specified type. <a href="https://rustwiki.org/zh-CN/reference/type-layout.html#the-c-representation"><sup class="expert">REF</sup></a></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>#[repr(transparent)]</code></td><td><code>T</code></td><td>Give single-element type same layout as contained field. <a href="https://rustwiki.org/zh-CN/reference/type-layout.html#the-transparent-representation"><sup class="expert">REF</sup></a></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>#[repr(packed(1))]</code></td><td><code>T</code></td><td>Lower alignment of struct and contained fields, mildly UB prone. <a href="https://rustwiki.org/zh-CN/reference/type-layout.html#the-alignment-modifiers"><sup class="expert">REF</sup></a></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>#[repr(align(8))]</code></td><td><code>T</code></td><td>Raise alignment of struct to given value, e.g., for SIMD types. <a href="https://rustwiki.org/zh-CN/reference/type-layout.html#the-alignment-modifiers"><sup class="expert">REF</sup></a></td></tr> </tbody></table>  <footnotes> <p><sup>1</sup> Some representation modifiers can be combined, e.g., <code>#[repr(C, packed(1))]</code>.</p> </footnotes> <div>&nbsp;</div><table><thead><tr><th>Linking</th><th>On</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>#[no_mangle]</code></td><td><code>*</code></td><td>Use item name directly as symbol name, instead of mangling. <a href="https://rustwiki.org/zh-CN/reference/abi.html#the-no_mangle-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[no_link]</code></td><td><code>X</code></td><td>Don't link <code>extern crate</code> when only wanting macros. <a href="https://rustwiki.org/zh-CN/reference/items&#x2F;extern-crates.html#the-no_link-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[link(name=&quot;x&quot;, kind=&quot;y&quot;)]</code></td><td><code>X</code></td><td>Native lib to link against when looking up symbol. <a href="https://rustwiki.org/zh-CN/reference/items&#x2F;external-blocks.html#the-link-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[link_name = &quot;foo&quot;]</code></td><td><code>F</code></td><td>Name of symbol to search for resolving <code>extern fn</code>. <a href="https://rustwiki.org/zh-CN/reference/items&#x2F;external-blocks.html#the-link_name-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[link_section = &quot;.sample&quot;]</code></td><td><code>FS</code></td><td>Section name of object file where item should be placed. <a href="https://rustwiki.org/zh-CN/reference/abi.html#the-link_section-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[export_name = &quot;foo&quot;]</code></td><td><code>FS</code></td><td>Export a <code>fn</code> or <code>static</code> under a different name. <a href="https://rustwiki.org/zh-CN/reference/abi.html#the-export_name-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[used]</code></td><td><code>S</code></td><td>Don't optimize away <code>static</code> variable despite it looking unused. <a href="https://rustwiki.org/zh-CN/reference/abi.html#the-used-attribute"><sup class="expert">REF</sup></a></td></tr> </tbody></table> </fixed-3-column> </div></panel></tab>  <tab> <input type="radio" id="tab-preprocessing-3" name="tab-group-preprocessing"> <label for="tab-preprocessing-3"><b><code>#[quality]</code></b></label> <panel><div class="color-header undefined-color-3"> <p>Attributes used by Rust tools to improve code quality:</p> <fixed-3-column class="color-header special_example"> <table><thead><tr><th>Code Patterns</th><th>On</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>#[allow(X)]</code></td><td><code>*</code></td><td>Instruct <code>rustc</code> / <code>clippy</code> to ... ignore class <code>X</code> of possible issues. <a href="https://rustwiki.org/zh-CN/reference/attributes&#x2F;diagnostics.html#lint-check-attributes"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[warn(X)]</code> <sup>1</sup></td><td><code>*</code></td><td>... emit a warning, mixes well with <code>clippy</code> lints. <sup>🔥</sup> <a href="https://rustwiki.org/zh-CN/reference/attributes&#x2F;diagnostics.html#lint-check-attributes"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[deny(X)]</code> <sup>1</sup></td><td><code>*</code></td><td>... fail compilation. <a href="https://rustwiki.org/zh-CN/reference/attributes&#x2F;diagnostics.html#lint-check-attributes"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[forbid(X)]</code> <sup>1</sup></td><td><code>*</code></td><td>... fail compilation and prevent subsequent <code>allow</code> overrides. <a href="https://rustwiki.org/zh-CN/reference/attributes&#x2F;diagnostics.html#lint-check-attributes"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[deprecated = &quot;msg&quot;]</code></td><td><code>*</code></td><td>Let your users know you made a design mistake. <a href="https://rustwiki.org/zh-CN/reference/diagnostics.html#the-deprecated-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[must_use = &quot;msg&quot;]</code></td><td><code>FTX</code></td><td>Makes compiler check return value is <em>processed</em> by caller. <sup>🔥</sup> <a href="https://rustwiki.org/zh-CN/reference/attributes&#x2F;diagnostics.html#the-must_use-attribute"><sup class="expert">REF</sup></a></td></tr> </tbody></table> <footnotes> <p><sup>1</sup> There is some debate which one is the <em>best</em> to ensure high quality crates. Actively maintained multi-dev crates probably benefit from more aggressive <code>deny</code> or <code>forbid</code> lints; less-regularly updated ones probably more from conservative use of <code>warn</code> (as future compiler or <code>clippy</code> updates may suddenly break otherwise working code with minor issues).</p> </footnotes> <div>&nbsp;</div></fixed-3-column> <fixed-3-column class="color-header special_example"> <table><thead><tr><th>Tests</th><th>On</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>#[test]</code></td><td><code>F</code></td><td>Marks the function as a test, run with <code>cargo test</code>. <sup>🔥</sup> <a href="https://rustwiki.org/zh-CN/reference/attributes&#x2F;testing.html#the-test-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[ignore = &quot;msg&quot;]</code></td><td><code>F</code></td><td>Compiles but does not execute some <code>#[test]</code> for now. <a href="https://rustwiki.org/zh-CN/reference/attributes&#x2F;testing.html#the-ignore-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[should_panic]</code></td><td><code>F</code></td><td>Test must <code>panic!()</code> to actually succeed. <a href="https://rustwiki.org/zh-CN/reference/attributes&#x2F;testing.html#the-ignore-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[bench]</code></td><td><code>F</code></td><td>Mark function in <code>bench/</code> as benchmark for <code>cargo bench</code>. <sup>🚧</sup> <a href="https://rustwiki.org/zh-CN/reference/"><sup class="expert">REF</sup></a></td></tr> </tbody></table> <div>&nbsp;</div><table><thead><tr><th>Formatting</th><th>On</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>#[rustfmt::skip]</code></td><td><code>*</code></td><td>Prevent <code>cargo fmt</code> from cleaning up item. <a href="https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rustfmt"><sup>🔗</sup></a></td></tr> <tr><td><code>#![rustfmt::skip::macros(x)]</code></td><td><code>CM</code></td><td>... from cleaning up macro <code>x</code>. <a href="https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rustfmt"><sup>🔗</sup></a></td></tr> <tr><td><code>#![rustfmt::skip::attributes(x)]</code></td><td><code>CM</code></td><td>... from cleaning up attribute <code>x</code>. <a href="https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rustfmt"><sup>🔗</sup></a></td></tr> </tbody></table> </fixed-3-column> <div>&nbsp;</div><fixed-3-column class="color-header extra-wide special_example"> <table><thead><tr><th>Documentation</th><th>On</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>#[doc = &quot;Explanation&quot;]</code></td><td><code>*</code></td><td>Same as adding a <code>///</code> doc comment. <a href="https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;rustdoc&#x2F;the-doc-attribute.html"><sup>🔗</sup></a></td></tr> <tr><td><code>#[doc(alias = &quot;other&quot;)]</code></td><td><code>*</code></td><td>Provide another name users can search for in the docs. <a href="https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust&#x2F;issues&#x2F;50146"><sup>🔗</sup></a></td></tr> <tr><td><code>#[doc(hidden)]</code></td><td><code>*</code></td><td>Prevent item from showing up in docs. <a href="https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;rustdoc&#x2F;the-doc-attribute.html#dochidden"><sup>🔗</sup></a></td></tr> <tr><td><code>#![doc(html_favicon_url = &quot;&quot;)]</code></td><td><code>C</code></td><td>Sets the <code>favicon</code> for the docs. <a href="https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;rustdoc&#x2F;the-doc-attribute.html#html_favicon_url"><sup>🔗</sup></a></td></tr> <tr><td><code>#![doc(html_logo_url = &quot;&quot;)]</code></td><td><code>C</code></td><td>The logo used in the docs. <a href="https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;rustdoc&#x2F;the-doc-attribute.html#html_logo_url"><sup>🔗</sup></a></td></tr> <tr><td><code>#![doc(html_playground_url = &quot;&quot;)]</code></td><td><code>C</code></td><td>Generates <code>Run</code> buttons and uses given service. <a href="https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;rustdoc&#x2F;the-doc-attribute.html#html_playground_url"><sup>🔗</sup></a></td></tr> <tr><td><code>#![doc(html_root_url = &quot;&quot;)]</code></td><td><code>C</code></td><td>Base URL for links to external crates. <a href="https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;rustdoc&#x2F;the-doc-attribute.html#html_root_url"><sup>🔗</sup></a></td></tr> <tr><td><code>#![doc(html_no_source)]</code></td><td><code>C</code></td><td>Prevents source from being included in docs. <a href="https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;rustdoc&#x2F;the-doc-attribute.html#html_no_source"><sup>🔗</sup></a></td></tr> </tbody></table>  </fixed-3-column> </div></panel></tab>  <tab> <input type="radio" id="tab-preprocessing-8" name="tab-group-preprocessing"> <label for="tab-preprocessing-8"><b><code>#[macros]</code></b></label> <panel><div class="color-header undefined-color-3"> <fixed-3-column class="color-header special_example"> <p>Attributes related to the creation and use of macros:</p> <table><thead><tr><th>Macros By Example</th><th>On</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>#[macro_export]</code></td><td><code>!</code></td><td>Export <code>macro_rules!</code> as <code>pub</code> on crate level <a href="https://rustwiki.org/zh-CN/reference/macros-by-example.html#path-based-scope"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[macro_use]</code></td><td><code>MX</code></td><td>Let macros persist past modules; or import from <code>extern crate</code>. <a href="https://rustwiki.org/zh-CN/reference/macros-by-example.html#the-macro_use-attribute"><sup class="expert">REF</sup></a></td></tr> </tbody></table> <div>&nbsp;</div><table><thead><tr><th>Proc Macros</th><th>On</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>#[proc_macro]</code></td><td><code>F</code></td><td>Mark <code>fn</code> as <strong>function-like</strong> procedural macro callable as <code>m!()</code>. <a href="https://rustwiki.org/zh-CN/reference/procedural-macros.html#function-like-procedural-macros"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[proc_macro_derive(Foo)]</code></td><td><code>F</code></td><td>Mark <code>fn</code> as <strong>derive macro</strong> which can <code>#[derive(Foo)]</code>. <a href="https://rustwiki.org/zh-CN/reference/procedural-macros.html#derive-macros"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[proc_macro_attribute]</code></td><td><code>F</code></td><td>Mark <code>fn</code> as <strong>attribute macro</strong> which can understand new <code>#[x]</code>. <a href="https://rustwiki.org/zh-CN/reference/procedural-macros.html#attribute-macros"><sup class="expert">REF</sup></a></td></tr> </tbody></table> <div>&nbsp;</div><table><thead><tr><th>Derives</th><th>On</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>#[derive(X)]</code></td><td><code>T</code></td><td>Let some proc macro provide a goodish <code>impl</code> of <code>trait X</code>. <sup>🔥</sup> <a href="https://rustwiki.org/zh-CN/reference/"><sup class="expert">REF</sup></a></td></tr> </tbody></table>  </fixed-3-column> </div></panel></tab>  <tab> <input type="radio" id="tab-preprocessing-5" name="tab-group-preprocessing"> <label for="tab-preprocessing-5"><b><code>#[cfg]</code></b></label> <panel><div class="color-header undefined-color-3"> <p>Attributes governing conditional compilation:</p> <fixed-3-column class="color-header extra-wide special_example"> <table><thead><tr><th>Config Attributes</th><th>On</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>#[cfg(X)]</code></td><td><code>*</code></td><td>Include item if configuration <code>X</code> holds. <a href="https://rustwiki.org/zh-CN/reference/conditional-compilation.html#the-cfg-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[cfg(all(X, Y, Z))]</code></td><td><code>*</code></td><td>Include item if all options hold. <a href="https://rustwiki.org/zh-CN/reference/conditional-compilation.html#conditional-compilation"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[cfg(any(X, Y, Z))]</code></td><td><code>*</code></td><td>Include item if at least one option holds. <a href="https://rustwiki.org/zh-CN/reference/conditional-compilation.html#conditional-compilation"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[cfg(not(X))]</code></td><td><code>*</code></td><td>Include item if <code>X</code> does not hold. <a href="https://rustwiki.org/zh-CN/reference/conditional-compilation.html#conditional-compilation"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[cfg_attr(X, foo = &quot;msg&quot;)]</code></td><td><code>*</code></td><td>Apply <code>#[foo = &quot;msg&quot;]</code> if configuration <code>X</code> holds. <a href="https://rustwiki.org/zh-CN/reference/conditional-compilation.html#the-cfg_attr-attribute"><sup class="expert">REF</sup></a></td></tr> </tbody></table> <div>&nbsp;</div> <blockquote> <p>⚠️ Note, options can generally be set multiple times, i.e., the same key can show up with multiple values. One can expect <code>#[cfg(target_feature = &quot;avx&quot;)]</code> <strong>and</strong> <code>#[cfg(target_feature = &quot;avx2&quot;)]</code> to be true at the same time.</p> </blockquote> <div>&nbsp;</div><table><thead><tr><th>Known Options</th><th>On</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>#[cfg(target_arch = &quot;x86_64&quot;)]</code></td><td><code>*</code></td><td>The CPU architecture crate is compiled for. <a href="https://rustwiki.org/zh-CN/reference/conditional-compilation.html#target_arch"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[cfg(target_feature = &quot;avx&quot;)]</code></td><td><code>*</code></td><td>Whether a particular class of instructions is available. <a href="https://rustwiki.org/zh-CN/reference/conditional-compilation.html#target_feature"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[cfg(target_os = &quot;macos&quot;)]</code></td><td><code>*</code></td><td>Operating system your code will run on. <a href="https://rustwiki.org/zh-CN/reference/conditional-compilation.html#target_os"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[cfg(target_family = &quot;unix&quot;)]</code></td><td><code>*</code></td><td>Family operating system belongs to. <a href="https://rustwiki.org/zh-CN/reference/conditional-compilation.html#target_family"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[cfg(target_env = &quot;msvc&quot;)]</code></td><td><code>*</code></td><td>How DLLs and functions are interfaced with on OS. <a href="https://rustwiki.org/zh-CN/reference/conditional-compilation.html#target_env"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[cfg(target_endian = &quot;little&quot;)]</code></td><td><code>*</code></td><td>Main reason your cool new zero-cost protocol fails. <a href="https://rustwiki.org/zh-CN/reference/conditional-compilation.html#target_endian"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[cfg(target_pointer_width = &quot;64&quot;)]</code></td><td><code>*</code></td><td>How many bits pointers, <code>usize</code> and CPU words have. <a href="https://rustwiki.org/zh-CN/reference/conditional-compilation.html#target_pointer_width"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[cfg(target_vendor = &quot;apple&quot;)]</code></td><td><code>*</code></td><td>Manufacturer of target. <a href="https://rustwiki.org/zh-CN/reference/conditional-compilation.html#target_vendor"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[cfg(debug_assertions)]</code></td><td><code>*</code></td><td>Whether <code>debug_assert!()</code> and friends would panic. <a href="https://rustwiki.org/zh-CN/reference/conditional-compilation.html#debug_assertions"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[cfg(proc_macro)]</code></td><td><code>*</code></td><td>Wheter crate compiled as proc macro. <a href="https://rustwiki.org/zh-CN/reference/conditional-compilation.html#proc_macro"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[cfg(test)]</code></td><td><code>*</code></td><td>Whether compiled with <code>cargo test</code>. <sup>🔥</sup> <a href="https://rustwiki.org/zh-CN/reference/conditional-compilation.html#test"><sup class="expert">REF</sup></a></td></tr> <tr><td><code>#[cfg(feature = &quot;serde&quot;)]</code></td><td><code>*</code></td><td>When your crate was compiled with feature <code>serde</code>. <sup>🔥</sup> <a href="https://rustwiki.org/zh-CN/reference/conditional-compilation.html#conditional-compilation"><sup class="expert">REF</sup></a></td></tr> </tbody></table> </fixed-3-column> </div></panel></tab>  <tab> <input type="radio" id="tab-preprocessing-6" name="tab-group-preprocessing"> <label for="tab-preprocessing-6"><b><code>build.rs</code></b></label> <panel><div class="color-header undefined-color-3"> <p>Environment variables and outputs related to the pre-build script.</p> <fixed-2-column class="color-header extra-wide special_example"> <table><thead><tr><th>Input Environment</th><th>Explanation <a href="https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;cargo&#x2F;reference&#x2F;environment-variables.html"><sup>🔗</sup></a></th></tr></thead><tbody> <tr><td><code>CARGO_FEATURE_X</code></td><td>Environment variable set for each feature <code>x</code> activated.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>CARGO_FEATURE_SERDE</code></td><td>If feature <code>serde</code> were enabled.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>CARGO_FEATURE_SOME_FEATURE</code></td><td>If feature <code>some-feature</code> were enabled; dash <code>-</code> converted to <code>_</code>.</td></tr> <tr><td><code>CARGO_CFG_X</code></td><td>Exposes cfg's; joins mult. opts. by <code>,</code> and converts <code>-</code> to <code>_</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>CARGO_CFG_TARGET_OS=macos</code></td><td>If <code>target_os</code> were set to <code>macos</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>CARGO_CFG_TARGET_FEATURE=avx,avx2</code></td><td>If <code>target_feature</code> were set to <code>avx</code> and <code>avx2</code>.</td></tr> <tr><td><code>OUT_DIR</code></td><td>Where output should be placed.</td></tr> <tr><td><code>TARGET</code></td><td>Target triple being compiled for.</td></tr> <tr><td><code>HOST</code></td><td>Host triple (running this build script).</td></tr> <tr><td><code>PROFILE</code></td><td>Can be <code>debug</code> or <code>release</code>.</td></tr> </tbody></table> <footnotes> <p>Available in <code>build.rs</code> via <code>env::var()?</code>. List not exhaustive.</p> </footnotes> </fixed-2-column> <fixed-2-column class="color-header extra-wide special_example"> <div>&nbsp;</div><table><thead><tr><th>Output String</th><th>Explanation <a href="https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;cargo&#x2F;reference&#x2F;build-scripts.html"><sup>🔗</sup></a></th></tr></thead><tbody> <tr><td><code>cargo:rerun-if-changed=PATH</code></td><td>(Only) run this <code>build.rs</code> again if <code>PATH</code> changed.</td></tr> <tr><td><code>cargo:rerun-if-env-changed=VAR</code></td><td>(Only) run this <code>build.rs</code> again if environment <code>VAR</code> changed.</td></tr> <tr><td><code>cargo:rustc-link-lib=[KIND=]NAME</code></td><td>Link native library as if via <code>-l</code> option.</td></tr> <tr><td><code>cargo:rustc-link-search=[KIND=]PATH</code></td><td>Search path for native library as if via <code>-L</code> option.</td></tr> <tr><td><code>cargo:rustc-flags=FLAGS</code></td><td>Add special flags to compiler. <sup>?</sup></td></tr> <tr><td><code>cargo:rustc-cfg=KEY[=&quot;VALUE&quot;]</code></td><td>Emit given <code>cfg</code> option to be used for later compilation.</td></tr> <tr><td><code>cargo:rustc-env=VAR=VALUE </code></td><td>Emit var accessible via <code>env!()</code> in crate during compilation.</td></tr> <tr><td><code>cargo:rustc-cdylib-link-arg=FLAG </code></td><td>When building a <code>cdylib</code>, pass linker flag.</td></tr> <tr><td><code>cargo:warning=MESSAGE</code></td><td>Emit compiler warning.</td></tr> </tbody></table> <footnotes> <p>Emitted from <code>build.rs</code> via <code>println!()</code>. List not exhaustive.</p> </footnotes> </fixed-2-column> </div></panel></tab> </tabs> <footnotes> <p>For the <em>On</em> column in attributes: <br> <code>C</code> means on crate level (usually given as <code>#![my_attr]</code> in the top level file). <br> <code>M</code> means on modules. <br> <code>F</code> means on functions. <br> <code>S</code> means on static. <br> <code>T</code> means on types. <br> <code>X</code> means something special. <br> <code>!</code> means on macros. <br> <code>*</code> means on almost any item. <br></p> </footnotes> <hr> <h1 id="working-with-types">Working with Types<sup id="target-working-with-types" class="target"><a href="#working-with-types">url</a></sup></h1> <h2 id="types-traits-generics">Types, Traits, Generics<sup id="target-types-traits-generics" class="target"><a href="#types-traits-generics">url</a></sup></h2> <p>Allowing users to <em>bring their own types</em> and avoid code duplication.</p> <tabs>  <tab> <input type="radio" id="tab-types-1" name="tab-group-types" checked> <label for="tab-types-1"><b>Types & Traits</b></label> <panel><div>  <generics-section id="ttg-types"> <header>Types</header> <description> <mini-zoo class="zoo"> <entry> <type class="primitive"><code>u8</code></type> </entry> <entry> <type class="composed"><code>String</code></type> </entry> <entry> <type class="composed"><code>Device</code></type> </entry> </mini-zoo> <ul> <li>Set of values with given semantics, layout, …</li> </ul> <mini-table> <table><thead><tr><th>Type</th><th>Values</th></tr></thead><tbody> <tr><td><code>u8</code></td><td><code>{ 0<sub>u8</sub>, 1<sub>u8</sub>, ..., 255<sub>u8</sub> }</code></td></tr> <tr><td><code>char</code></td><td><code>{ 'a', 'b', ... '🦀' }</code></td></tr> <tr><td><code>struct S(u8, char)</code></td><td><code>{ (0<sub>u8</sub>, 'a'), ... (255<sub>u8</sub>, '🦀') }</code></td></tr> </tbody></table> <p><subtitle>Sample types and sample values.</subtitle></p> </mini-table> </description> </generics-section>  <generics-section id="ttg-equivalence"> <header>Type Equivalence and Conversions</header> <description> <mini-zoo class="zoo"> <entry> <type class="primitive"><code>u8</code></type> </entry> <entry> <type class="primitive"><code>&u8</code></type> </entry> <entry> <type class="primitive"><code>&mut u8</code></type> </entry> <entry> <type class="primitive"><code>[u8; 1]</code></type> </entry> <entry> <type class="composed"><code>String</code></type> </entry> </mini-zoo>  <ul> <li>It may be obvious but <code>u8</code>, <code>&amp;u8</code>, <code>&amp;mut u8</code>, are entirely different from each other</li> <li>Any <code>t: T</code> only accepts values from exactly <code>T</code>, e.g., <ul> <li><code>f(0_u8)</code> can't be called with <code>f(&amp;0_u8)</code>,</li> <li><code>f(&amp;mut my_u8)</code> can't be called with <code>f(&amp;my_u8)</code>,</li> <li><code>f(0_u8)</code> can't be called with <code>f(0_i8)</code>.</li> </ul> </li> </ul> <blockquote> <p>Yes, <code>0 != 0</code> (in a mathematical sense) when it comes to types! In a language sense, the operation <code>==(0<sub>u8</sub>, 0<sub>u16</sub>)</code> just isn't defined to prevent happy little accidents.</p> </blockquote> <mini-table> <table><thead><tr><th>Type</th><th>Values</th></tr></thead><tbody> <tr><td><code>u8</code></td><td><code>{ 0<sub>u8</sub>, 1<sub>u8</sub>, ..., 255<sub>u8</sub> }</code></td></tr> <tr><td><code>u16</code></td><td><code>{ 0<sub>u16</sub>, 1<sub>u16</sub>, ..., 65_535<sub>u16</sub> }</code></td></tr> <tr><td><code>&amp;u8</code></td><td><code>{ 0xffaa<sub>&amp;u8</sub>, 0xffbb<sub>&amp;u8</sub>, ... }</code></td></tr> <tr><td><code>&amp;mut u8</code></td><td><code>{ 0xffaa<sub>&amp;mut u8</sub>, 0xffbb<sub>&amp;mut u8</sub>, ... }</code></td></tr> </tbody></table> <p><subtitle>How values differ between types.</subtitle></p> </mini-table> <ul> <li>However, Rust might sometimes help to <strong>convert between types</strong><sup>1</sup> <ul> <li><strong>casts</strong> manually convert values of types, <code>0_i8 as u8</code></li> <li><strong>coercions</strong> <a href="#language-sugar"><sup>↑</sup></a> automatically convert types if safe<sup>2</sup>, <code>let x: &amp;u8 = &amp;mut 0_u8;</code></li> </ul> </li> </ul> <footnotes> <p><sup>1</sup> Casts and coercions convert values from one set (e.g., <code>u8</code>) to another (e.g., <code>u16</code>), possibly adding CPU instructions to do so; and in such differ from <strong>subtyping</strong>, which would imply type and subtype are part of the same set (e.g., <code>u8</code> being subtype of <code>u16</code> and <code>0_u8</code> being the same as <code>0_u16</code>) where such a conversion would be purely a compile time check. Rust does not use subtyping for regular types (and <code>0_u8</code> <em>does</em> differ from <code>0_u16</code>) but sort-of for lifetimes. <a href="https:&#x2F;&#x2F;featherweightmusings.blogspot.com&#x2F;2014&#x2F;03&#x2F;subtyping-and-coercion-in-rust.html"><sup>🔗</sup></a></p> <p><sup>2</sup> Safety here is not just physical concept (e.g., <code>&amp;u8</code> can't be coerced to <code>&amp;u128</code>), but also whether 'history has shown that such a conversion would lead to programming errors'.</p> </footnotes> </description> </generics-section>  <generics-section id="ttg-impl-s"> <header>Implementations &mdash; <code>impl S { }</code></header> <description> <mini-zoo class="zoo"> <entry> <type class="primitive"><code>u8</code></type> <impl><code>impl { ... }</code></impl> </entry> <entry> <type class="composed"><code>String</code></type> <impl><code>impl { ... }</code></impl> </entry> <entry> <type class="composed"><code>Port</code></type> <impl><code>impl { ... }</code></impl> </entry> </mini-zoo> <pre><code>impl Port {
    fn f() { ... }
}
</code></pre> <ul> <li>Types usually come with implementation, e.g., <code>impl Port {}</code>, behavior <em>related</em> to type: <ul> <li><strong>associated functions</strong> <code>Port::new(80)</code></li> <li><strong>methods</strong> <code>port.close()</code></li> </ul> </li> </ul> <blockquote> <p>What's considered <em>related</em> is more philosophical than technical, nothing (except good taste) would prevent a <code>u8::play_sound()</code> from happening.</p> </blockquote> </description> </generics-section>  <generics-section id="ttg-traits"> <header>Traits &mdash; <code>trait T { }</code></header> <description> <mini-zoo class="zoo"> <entry> <trait-impl>⌾ <code>Copy</code></trait-impl> </entry> <entry> <trait-impl>⌾ <code>Clone</code></trait-impl> </entry> <entry> <trait-impl>⌾ <code>Sized</code></trait-impl> </entry> <entry> <trait-impl>⌾ <code>ShowHex</code></trait-impl> </entry> </mini-zoo> <ul> <li><strong>Traits</strong> ... <ul> <li>are way to &quot;abstract&quot; behavior,</li> <li>trait author declares semantically <em>this trait means X</em>,</li> <li>other can implement (&quot;subscribe to&quot;) that behavior for their type.</li> </ul> </li> <li>Think about trait as &quot;membership list&quot; for types:</li> </ul> <mini-table> <mini-table style="width:200px;display:inline-block"> <table> <thead> <tr><th>Copy Trait</th></tr> <tr class="subheader"><th><code>Self</code></th></tr> </thead> <tbody> <tr><td><code>u8</code></td></tr> <tr><td><code>u16</code></td></tr> <tr><td><code>...</code></td></tr> </tbody> </table> </mini-table> <mini-table style="width:200px;display:inline-block"> <table> <thead> <tr><th>Clone Trait</th></tr> <tr class="subheader"><th><code>Self</code></th></tr> </thead> <tbody> <tr><td><code>u8</code></td></tr> <tr><td><code>String</code></td></tr> <tr><td><code>...</code></td></tr> </tbody> </table> </mini-table> <mini-table style="width:200px;display:inline-block"> <table> <thead> <tr><th>Sized Trait</th></tr> <tr class="subheader"><th><code>Self</code></th></tr> </thead> <tbody> <tr><td><code>char</code></td></tr> <tr><td><code>Port</code></td></tr> <tr><td><code>...</code></td></tr> </tbody> </table> </mini-table> <p><subtitle>Traits as membership tables, <code>Self</code> refers to the type included.</subtitle></p> </mini-table> <ul> <li><strong>Whoever is part of that membership list will adhere to behavior of list.</strong></li> <li>Traits can also include associated methods, functions, ...</li> </ul> <pre><code>trait ShowHex {
    &#x2F;&#x2F; Must be implemented according to documentation.
    fn as_hex() -&gt; String;

    &#x2F;&#x2F; Provided by trait author.
    fn print_hex() {}
}
</code></pre> <mini-zoo class="zoo"> <entry> <trait-impl>⌾ <code>Copy</code></trait-impl> </entry> </mini-zoo> <pre><code>trait Copy { }
</code></pre> <ul> <li>Traits without methods often called <strong>marker traits</strong>.</li> <li><code>Copy</code> is example marker trait, meaning <em>memory may be copied bitwise</em>.</li> </ul> <mini-zoo class="zoo"> <entry> <trait-impl>⌾ <code>Sized</code></trait-impl> </entry> </mini-zoo> <ul> <li>Some traits entirely outside explicit control</li> <li><code>Sized</code> provided by compiler for types with <em>known size</em>; either this is, or isn't</li> </ul> </description> </generics-section>  <generics-section id="xxx"> <header>Implementing Traits for Types &mdash; <code>impl T for S { }</code></header> <description> <pre><code>impl ShowHex for Port { ... }
</code></pre> <ul> <li>Traits are implemented for types 'at some point'.</li> <li>Implementation <code>impl A for B</code> add type <code>B</code> to the trait membership list:</li> </ul> <mini-table> <mini-table style="width:200px;display:inline-block"> <table> <thead> <tr><th>ShowHex Trait</th></tr> <tr class="subheader"><th><code>Self</code></th></tr> </thead> <tbody> <tr><td><code>Port</code></td></tr> </tbody> </table> </mini-table> </mini-table> <ul> <li>Visually, you can think of the type getting a &quot;badge&quot; for its membership:</li> </ul> <mini-zoo class="zoo"> <entry> <type class="primitive"><code>u8</code></type> <impl><code>impl { ... }</code></impl> <trait-impl>⌾ <code>Sized</code></trait-impl> <trait-impl>⌾ <code>Clone</code></trait-impl> <trait-impl>⌾ <code>Copy</code></trait-impl> </entry> <entry> <type class="composed"><code>Device</code></type> <impl><code>impl { ... }</code></impl> <trait-impl>⌾ <code>Transport</code></trait-impl> </entry> <entry> <type class="composed"><code>Port</code></type> <impl><code>impl { ... }</code></impl> <trait-impl>⌾ <code>Sized</code></trait-impl> <trait-impl>⌾ <code>Clone</code></trait-impl> <trait-impl>⌾ <code>ShowHex</code></trait-impl> </entry> </mini-zoo> </description> </generics-section>  <generics-section id="xxx"> <header>Traits vs. Interfaces</header> <description> <mini-zoo class="zoo"> <person>👩‍🦰</person> <entry> <trait-impl>⌾ <code>Eat</code></trait-impl> </entry> </mini-zoo> <mini-zoo class="zoo" style="margin-left:10px"> <person>🧔</person> <entry> <type class="composed"><code>Venison</code></type> <trait-impl>⌾ <code>Eat</code></trait-impl> </entry> </mini-zoo> <mini-zoo class="zoo" style="margin-left:10px;width:130px"> <person></person> <entry> <code style="text-align:center;width:100%"></code> </entry> </mini-zoo> <mini-zoo class="zoo" style="margin-left:10px"> <person>🎅</person> <entry> <code>venison.eat()</code> </entry> </mini-zoo> <div>&nbsp;</div> <p><strong>Interfaces</strong></p> <ul> <li>In <strong>Java</strong>, Alice creates interface <code>Eat</code>.</li> <li>When Bob authors <code>Venison</code>, he must decide if <code>Venison</code> implements <code>Eat</code> or not.</li> <li>In other words, all membership must be exhaustively declared during type definition.</li> <li>When using <code>Venison</code>, Santa can make use of behavior provided by <code>Eat</code>:</li> </ul> <pre><code>&#x2F;&#x2F; Santa imports `Venison` to create it, can `eat()` if he wants.
import food.Venison;

new Venison(&quot;rudolph&quot;).eat();
</code></pre> <p><div>&nbsp;</div> <div>&nbsp;</div></p> <mini-zoo class="zoo"> <person>👩‍🦰</person> <entry> <trait-impl>⌾ <code>Eat</code></trait-impl> </entry> </mini-zoo> <mini-zoo class="zoo" style="margin-left:10px"> <person>🧔</person> <entry> <type class="composed"><code>Venison</code></type> </entry> </mini-zoo> <mini-zoo class="zoo" style="margin-left:10px"> <person>👩‍🦰</person> / <person>🧔</person> <entry> <type class="composed"><code>Venison</code></type> <code style="text-align:center;width:100%">+</code> <trait-impl>⌾ <code>Eat</code></trait-impl> </entry> </mini-zoo> <mini-zoo class="zoo" style="margin-left:10px"> <person>🎅</person> <entry> <code>venison.eat()</code> </entry> </mini-zoo> <div>&nbsp;</div> <p><strong>Traits</strong></p> <ul> <li>In <strong>Rust</strong>, Alice creates trait <code>Eat</code>.</li> <li>Bob creates type <code>Venison</code> and decides not to implement <code>Eat</code> (he might not even know about <code>Eat</code>).</li> <li>Someone<sup>*</sup> later decides adding <code>Eat</code> to <code>Venison</code> would be a really good idea.</li> <li>When using <code>Venison</code> Santa must import <code>Eat</code> separately:</li> </ul> <pre><code>&#x2F;&#x2F; Santa needs to import `Venison` to create it, and import `Eat` for trait method.
use food::Venison;
use tasks::Eat;

&#x2F;&#x2F; Ho ho ho
Venison::new(&quot;rudolph&quot;).eat();
</code></pre> <footnotes> <p><sup>*</sup> To prevent two persons from implementing <code>Eat</code> differently Rust limits that choice to either Alice or Bob; that is, an <code>impl Eat for Venison</code> may only happen in the crate of <code>Venison</code> or in the crate of <code>Eat</code>. For details see coherence. <sup>?</sup></p> </footnotes> </description> </generics-section> </div></panel></tab>  <tab> <input type="radio" id="tab-types-2" name="tab-group-types"> <label for="tab-types-2"><b>Generics</b></label> <panel><div>  <generics-section id="xxx"> <header>Type Constructors &mdash; <code>Vec&lt;&gt;</code></header> <description> <mini-zoo class="zoo"> <entry> <type class="composed"><code>Vec&lt;u8&gt;</code></type> </entry> <entry> <type class="composed"><code>Vec&lt;char&gt;</code></type> </entry> </mini-zoo> <ul> <li><code>Vec&lt;u8&gt;</code> is type &quot;vector of bytes&quot;; <code>Vec&lt;char&gt;</code> is type &quot;vector of chars&quot;, but what is <code>Vec&lt;&gt;</code>?</li> </ul> <mini-table> <table><thead><tr><th>Construct</th><th>Values</th></tr></thead><tbody> <tr><td><code>Vec&lt;u8&gt;</code></td><td><code>{ [], [1], [1, 2, 3], ... }</code></td></tr> <tr><td><code>Vec&lt;char&gt;</code></td><td><code>{ [], ['a'], ['x', 'y', 'z'], ... }</code></td></tr> <tr><td><code>Vec&lt;&gt;</code></td><td>-</td></tr> </tbody></table> <p><subtitle>Types vs type constructors.</subtitle></p> </mini-table> <mini-zoo class="zoo"> <entry> <type class="dotted generic"><code>Vec&lt;&gt;</code></type> </entry> </mini-zoo> <ul> <li><code>Vec&lt;&gt;</code> is no type, does not occupy memory, can't even be translated to code.</li> <li><code>Vec&lt;&gt;</code> is <strong>type constructor</strong>, a &quot;template&quot; or &quot;recipe to create types&quot; <ul> <li>allows 3<sup>rd</sup> party to construct concrete type via parameter,</li> <li>only then would this <code>Vec&lt;UserType&gt;</code> become real type itself.</li> </ul> </li> </ul> </description> </generics-section>  <generics-section id="xxx"> <header>Generic Parameters &mdash; <code>&lt;T&gt;</code></header> <description> <mini-zoo class="zoo"> <entry> <type class="dotted generic"><code>Vec&lt;T&gt;</code></type> </entry> <entry> <type class="dotted generic"><code>[T; 128]</code></type> </entry> <entry> <type class="dotted generic"><code>&T</code></type> </entry> <entry> <type class="dotted generic"><code>&mut T</code></type> </entry> <entry> <type class="dotted generic"><code>S&lt;T&gt;</code></type> </entry> </mini-zoo> <ul> <li>Parameter for <code>Vec&lt;&gt;</code> often named <code>T</code> therefore <code>Vec&lt;T&gt;</code>.</li> <li><code>T</code> &quot;variable name for type&quot; for user to plug in something specfic, <code>Vec&lt;f32&gt;</code>, <code>S&lt;u8&gt;</code>, …</li> </ul> <mini-table> <table><thead><tr><th>Type Constructor</th><th>Produces Family</th></tr></thead><tbody> <tr><td><code>struct Vec&lt;T&gt; {}</code></td><td><code>Vec&lt;u8&gt;</code>, <code>Vec&lt;f32&gt;</code>, <code>Vec&lt;Vec&lt;u8&gt;&gt;</code>, ...</td></tr> <tr><td><code>[T; 128]</code></td><td><code>[u8; 128]</code>, <code>[char; 128]</code>, <code>[Port; 128]</code> ...</td></tr> <tr><td><code>&amp;T</code></td><td><code>&amp;u8</code>, <code>&amp;u16</code>, <code>&amp;str</code>, ...</td></tr> </tbody></table> <p><subtitle>Type vs type constructors.</subtitle></p> </mini-table> <pre><code>&#x2F;&#x2F; S&lt;&gt; is type constructor with parameter T; user can supply any concrete type for T.
struct S&lt;T&gt; {
    x: T
}

&#x2F;&#x2F; Within &#x27;concrete&#x27; code an existing type must be given for T.
fn f() {
    let x: S&lt;f32&gt; = S::new(0_f32);
}

</code></pre> </description> </generics-section>  <generics-section id="xxx"> <header>Const Generics &mdash; <code>[T; N]</code> and <code>S&lt;const N: usize&gt;</code></header> <description> <mini-zoo class="zoo"> <entry> <type class="dotted generic"><code>[T; n]</code></type> </entry> <entry> <type class="dotted generic"><code>S&lt;const N&gt;</code></type> </entry> </mini-zoo> <ul> <li>Some type constructors not only accept specific type, but also <strong>specific constant</strong>.</li> <li><code>[T; n]</code> constructs array type holding <code>T</code> type <code>n</code> times.</li> <li>For custom types declared as <code>MyArray&lt;T, const N: usize&gt;</code>.</li> </ul> <mini-table> <table><thead><tr><th>Type Constructor</th><th>Produces Family</th></tr></thead><tbody> <tr><td><code>[u8; N]</code></td><td><code>[u8; 0]</code>, <code>[u8; 1]</code>, <code>[u8; 2]</code>, ...</td></tr> <tr><td><code>struct S&lt;const N: usize&gt; {}</code></td><td><code>S&lt;1&gt;</code>, <code>S&lt;6&gt;</code>, <code>S&lt;123&gt;</code>, ...</td></tr> </tbody></table> <p><subtitle>Type constructors based on constant.</subtitle></p> </mini-table> <pre><code>let x: [u8; 4]; &#x2F;&#x2F; &quot;array of 4 bytes&quot;
let y: [f32; 16]; &#x2F;&#x2F; &quot;array of 16 floats&quot;

&#x2F;&#x2F; `MyArray` is type constructor requiring concrete type `T` and
&#x2F;&#x2F; concrete usize `N` to construct specific type.
struct MyArray&lt;T, const N: usize&gt; {
    data: [T; N],
}
</code></pre> </description> </generics-section>    <generics-section id="xxx"> <header>Bounds (Simple) &mdash; <code>where T: X</code></header> <description> <mini-zoo class="zoo"> <person>🧔</person> <entry> <type class="dotted generic"><code>Num&lt;T&gt;</code></type> </entry> <narrow-entry> <code style="text-align:center;width:100%">→</code> </narrow-entry> <person>🎅</person> <entry> <type class="composed"><code>Num&lt;u8&gt;</code></type> </entry> <entry> <type class="composed"><code>Num&lt;f32&gt;</code></type> </entry> <entry> <type class="composed"><code>Num&lt;Cmplx&gt;</code></type> </entry> <narrow-entry> <code style="text-align:center;width:50px">&nbsp;</code> </narrow-entry> <entry> <type class="primitive"><code>u8</code></type> <trait-impl>⌾ <code>Absolute</code></trait-impl> <trait-impl>⌾ <code>Dim</code></trait-impl> <trait-impl>⌾ <code>Mul</code></trait-impl> </entry> <entry class="grayed"> <type class="composed"><code>Port</code></type> <trait-impl>⌾ <code>Clone</code></trait-impl> <trait-impl>⌾ <code>ShowHex</code></trait-impl> </entry> </mini-zoo> <ul> <li>If <code>T</code> can be any type, how can we <em>reason</em> about (write code) for such a <code>Num&lt;T&gt;</code>?</li> <li>Parameter <strong>bounds</strong>: <ul> <li>limit what types (<strong>trait bound</strong>) or values (<strong>const bound</strong> <sup>?</sup>) allowed,</li> <li>we now can make use of these limits!</li> </ul> </li> <li>Trait bounds act as &quot;membership check&quot;:</li> </ul> <mini-table> <div style="display:inline-block"> <pre><code>&#x2F;&#x2F; Type can only be constructed for some `T` if that
&#x2F;&#x2F; T is part of `Absolute` membership list.
struct Num&lt;T&gt; where T: Absolute {
    ...
}

</code></pre> </div> <mini-table style="width:200px;display:inline-block"> <table> <thead> <tr><th>Absolute Trait</th></tr> <tr class="subheader"><th><code>Self</code></th></tr> </thead> <tbody> <tr><td><code>u8</code></td></tr> <tr><td><code>u16</code></td></tr> <tr><td><code>...</code></td></tr> </tbody> </table> </mini-table> </mini-table>  <footnotes> <p>We add bounds to the struct here. In practice it's nicer add bounds to the respective impl blocks instead, see later this section.</p> </footnotes>  </description> </generics-section>  <generics-section id="xxx"> <header>Bounds (Compound) &mdash; <code>where T: X + Y</code></header> <description> <mini-zoo class="zoo"> <entry class="grayed"> <type class="primitive"><code>u8</code></type> <trait-impl>⌾ <code>Absolute</code></trait-impl> <trait-impl>⌾ <code>Dim</code></trait-impl> <trait-impl>⌾ <code>Mul</code></trait-impl> </entry> <entry class="grayed"> <type class="primitive"><code>f32</code></type> <trait-impl>⌾ <code>Absolute</code></trait-impl> <trait-impl>⌾ <code>Mul</code></trait-impl> </entry> <entry class="grayed"> <type class="primitive"><code>char</code></type> </entry> <entry> <type class="composed"><code>Cmplx</code></type> <trait-impl>⌾ <code>Absolute</code></trait-impl> <trait-impl>⌾ <code>Dim</code></trait-impl> <trait-impl>⌾ <code>Mul</code></trait-impl> <trait-impl>⌾ <code>DirName</code></trait-impl> <trait-impl>⌾ <code>TwoD</code></trait-impl> </entry> <entry class="grayed"> <type class="composed"><code>Car</code></type> <trait-impl>⌾ <code>DirName</code></trait-impl> </entry> </mini-zoo> <pre><code>struct S&lt;T&gt;
where
    T: Absolute + Dim + Mul + DirName + TwoD
{ ... }
</code></pre> <ul> <li>Long trait bounds can look intimidating.</li> <li>In practice, each <code>+ X</code> addition to a bound merely cuts down space of eligible types.</li> </ul> </description> </generics-section>  <generics-section id="xxx"> <header>Implementing Families &mdash; <code>impl&lt;&gt;</code></header> <description> <div>&nbsp;</div> <p>When we write:</p> <pre><code>impl&lt;T&gt; S&lt;T&gt; where T: Absolute + Dim + Mul {
    fn f(&amp;self, x: T) { ... };
}
</code></pre> <p>It can be read as:</p> <ul> <li>here is an implementation recipe for any type <code>T</code> (the <code>impl &lt;T&gt;</code> part),</li> <li>where that type must be member of the <code>Absolute + Dim + Mul</code> traits,</li> <li>you may add an implementation block to <code>S&lt;T&gt;</code>,</li> <li>containing the methods ...</li> </ul> <p>You can think of such <code>impl&lt;T&gt; ... {} </code> code as <strong>abstractly implementing a family of behaviors</strong>. Most notably, they allow 3<sup>rd</sup> parties to transparently materialize implementations similarly to how type constructors materialize types:</p> <pre><code>&#x2F;&#x2F; If compiler encounters this, it will
&#x2F;&#x2F; - check `0` and `x` fulfill the membership requirements of `T`
&#x2F;&#x2F; - create two new version of `f`, one for `char`, another one for `u32`.
&#x2F;&#x2F; - based on &quot;family implementation&quot; provided
s.f(0_u32);
s.f(&#x27;x&#x27;);
</code></pre> </description> </generics-section>  <generics-section id="xxx"> <header>Blanket Implementations &mdash; <code>impl&lt;T&gt X for T { ... }</code></header> <description> <div>&nbsp;</div> <p>Can also write &quot;family implementations&quot; so they apply trait to many types:</p> <pre><code>&#x2F;&#x2F; Also implements Serialize for any type if that type already implements ToHex
impl&lt;T&gt; Serialize for T where T: ToHex { ... }
</code></pre> <p>These are called <strong>blanket implementations</strong>.</p> <mini-table> <mini-table style="width:200px;display:inline-block"> <table> <thead> <tr><th>ToHex</th></tr> <tr class="subheader"><th><code>Self</code></th></tr> </thead> <tbody> <tr><td><code>Port</code></td></tr> <tr><td><code>Device</code></td></tr> <tr><td><code>...</code></td></tr> </tbody> </table> </mini-table> <div style="display:inline-block;width:100px"> <p>→ Whatever was in left table, may be added to right table, based on the following recipe (<code>impl</code>) →</p> </div> <mini-table style="width:200px;display:inline-block"> <table> <thead> <tr><th>Serialize Trait</th></tr> <tr class="subheader"><th><code>Self</code></th></tr> </thead> <tbody> <tr><td><code>u8</code></td></tr> <tr><td><code>Port</code></td></tr> <tr><td><code>...</code></td></tr> </tbody> </table> </mini-table> </mini-table> <p>They can be neat way to give foreign types functionality in a modular way if they just implement another interface.</p> </description> </generics-section> </div></panel></tab>  <tab> <input type="radio" id="tab-types-3" name="tab-group-types"> <label for="tab-types-3"><b>Advanced Concepts</b><sup style="font-size:100%;position:relative;top:-4px">🝖</sup></label> <panel><div>    <generics-section id="xxx"> <header>Trait Parameters &mdash; <code>Trait&lt;In&gt; { type Out; } </code></header> <description> <div>&nbsp;</div> <p>Notice how some traits can be &quot;attached&quot; multiple times, but others just once?</p> <mini-zoo class="zoo"> <entry style="left:300px;top:25px"> <type class="composed"><code>Port</code></type> <trait-impl>⌾ <code>From&lt;u8&gt;</code></trait-impl> <trait-impl>⌾ <code>From&lt;u16&gt;</code></trait-impl> </entry> <entry style="left:400px;top:25px"> <type class="composed"><code>Port</code></type> <trait-impl>⌾ <code>Deref</code></trait-impl> <associated-type class="grayed"><code>type u8;</code></associated-type> </entry> </mini-zoo>  <br> <div>&nbsp;</div> <p>Why is that?</p> <ul> <li>Traits themselves can be generic over two <strong>kinds of parameters</strong>: <ul> <li><code>trait From&lt;I&gt; {}</code></li> <li><code>trait Deref { type O; }</code></li> </ul> </li> <li>Remember we said traits are &quot;membership lists&quot; for types and called the list <code>Self</code>?</li> <li>Turns out, parameters <code>I</code> (for <strong>input</strong>) and <code>O</code> (for <strong>output</strong>) are just more <em>columns</em> to that trait's list:</li> </ul> <pre><code>impl From&lt;u8&gt; for u16 {}
impl From&lt;u16&gt; for u32 {}
impl Deref for Port { type O = u8; }
impl Deref for String { type O = str; }
</code></pre> <mini-table> <mini-table style="width:200px;display:inline-block"> <table> <thead> <tr><th colspan="2">From</th></tr> <tr class="subheader"><th><code>Self</code></th><th><code>I</code></th></tr> </thead> <tbody> <tr><td><code>u16</code></td><td><code>u8</code></td></tr> <tr><td><code>u32</code></td><td><code>u16</code></td></tr> <tr><td colspan="2"><code>...</code></td></tr> </tbody> </table> </mini-table> <mini-table style="width:200px;display:inline-block"> <table> <thead> <tr><th colspan="2">Deref</th></tr> <tr class="subheader"><th><code>Self</code></th><th><code>O</code></th></tr> </thead> <tbody> <tr><td><code>Port</code></td><td><code>u8</code></td></tr> <tr><td><code>String</code></td><td><code>str</code></td></tr> <tr><td colspan="2"><code>...</code></td></tr> </tbody> </table> </mini-table> <p><subtitle>Input and output parameters.</subtitle></p> </mini-table> <p>Now here's the twist,</p> <ul> <li><strong>any output <code>O</code> parameters must be uniquely determined by input parameters <code>I</code></strong>,</li> <li>(in the same way as a relation <code>X Y</code> would represent a function),</li> <li><code>Self</code> counts as an input.</li> </ul> <p>A more complex example:</p> <pre><code>trait Complex&lt;I1, I2&gt; {
    type O1;
    type O2;
}
</code></pre> <ul> <li>this creates a relation relation of types named <code>Complex</code>,</li> <li>with 3 inputs (<code>Self</code> is always one) and 2 outputs, and it holds <code>(Self, I1, I2) =&gt; (O1, O2)</code></li> </ul> <mini-table> <table> <thead> <tr><th colspan="5">Complex</th></tr> <tr class="subheader"><th><code>Self [I]</code></th><th><code>I1</code></th><th><code>I2</code></th><th><code>O1</code></th><th><code>O2</code></th></tr> </thead> <tbody> <tr><td><code>Player</code></td><td><code>u8</code></td><td><code>char</code></td><td><code>f32</code></td><td><code>f32</code></td></tr> <tr><td><code>EvilMonster</code></td><td><code>u16</code></td><td><code>str</code></td><td><code>u8</code></td><td><code>u8</code></td></tr> <tr><td><code>EvilMonster</code></td><td><code>u16</code></td><td><code>String</code></td><td><code>u8</code></td><td><code>u8</code></td></tr> <tr><td><code>NiceMonster</code></td><td><code>u16</code></td><td><code>String</code></td><td><code>u8</code></td><td><code>u8</code></td></tr> <tr><td><code>NiceMonster</code><sup><sup>🛑</sup></sup></td><td><code>u16</code></td><td><code>String</code></td><td><code>u8</code></td><td><code>u16</code></td></tr> </tbody> </table> <p><subtitle>Various trait implementations. The last one is not valid as <code>(NiceMonster, u16, String)</code> has <br> already uniquely determined the outputs.</subtitle></p> </mini-table> </description> </generics-section>  <generics-section id="xxx"> <header>Trait Authoring Considerations (Abstract)</header> <description> <mini-zoo class="zoo"> <person>👩‍🦰</person> <entry> <trait-impl class="dotted">⌾ <code>A&lt;I&gt;</code></trait-impl> </entry> </mini-zoo> <mini-zoo class="zoo" style="margin-left:10px"> <person>🧔</person> <entry> <type class="composed"><code>Car</code></type> </entry> </mini-zoo> <mini-zoo class="zoo" style="margin-left:10px"> <person>👩‍🦰</person> / <person>🧔</person> <entry> <type class="composed"><code>Car</code></type> <trait-impl class="dotted">⌾ <code>A&lt;I&gt;</code></trait-impl> </entry> </mini-zoo> <mini-zoo class="zoo" style="margin-left:10px"> <person>🎅</person> <entry> <code>car.a(0_u8)</code> <code>car.a(0_f32)</code> </entry> </mini-zoo> <br> <mini-zoo class="zoo"> <person>👩‍🦰</person> <entry> <trait-impl>⌾ <code>B</code></trait-impl> <associated-type><code>type O;</code></associated-type> </entry> </mini-zoo> <mini-zoo class="zoo" style="margin-left:10px"> <person>🧔</person> <entry> <type class="composed"><code>Car</code></type> </entry> </mini-zoo> <mini-zoo class="zoo" style="margin-left:10px"> <person>👩‍🦰</person> / <person>🧔</person> <entry> <type class="composed"><code>Car</code></type> <trait-impl>⌾ <code>B</code></trait-impl> <associated-type><code>T = u8;</code></associated-type> </entry> </mini-zoo> <mini-zoo class="zoo" style="margin-left:10px"> <person>🎅</person> <entry> <code>car.b(0_u8)</code> <code style="text-decoration:line-through">car.b(0_f32)</code> </entry> </mini-zoo> <ul> <li>Parameter choice (input vs. output) also determines who may be allowed to add members: <ul> <li><code>I</code> parameters allow &quot;familes of implementations&quot; be forwarded to user (Santa),</li> <li><code>O</code> parameters must be determined by trait implementor (Alice or Bob).</li> </ul> </li> </ul> <pre><code>trait A&lt;I&gt; { }
trait B { type O; }

&#x2F;&#x2F; Implementor adds (X, u32) to A.
impl A&lt;u32&gt; for X { }

&#x2F;&#x2F; Implementor adds family impl. (X, ...) to A, user can materialze.
impl&lt;T&gt; A&lt;T&gt; for Y { }

&#x2F;&#x2F; Implementor must decide specific entry (X, O) added to B.
impl B for X { type O = u32; }
</code></pre> <mini-table> <mini-table style="width:200px;display:inline-block"> <table> <thead> <tr><th colspan="2">A</th></tr> <tr class="subheader"><th><code>Self</code></th><th><code>I</code></th></tr> </thead> <tbody> <tr><td><code>X</code></td><td><code>u32</code></td></tr> <tr><td><code>Y</code></td><td><code>...</code></td></tr> </tbody> </table> <p><subtitle>Santa may add more members by providing his own type for <code>T</code>.</subtitle></p> </mini-table> <mini-table style="width:200px;display:inline-block"> <table> <thead> <tr><th colspan="2">B</th></tr> <tr class="subheader"><th><code>Self</code></th><th><code>O</code></th></tr> </thead> <tbody> <tr><td><code>Player</code></td><td><code>String</code></td></tr> <tr><td><code>X</code></td><td><code>u32</code></td></tr> </tbody> </table> <p><subtitle>For given set of inputs (here <code>Self</code>), implementor must pre-select <code>O</code>.</subtitle></p> </mini-table> </mini-table> </description> </generics-section>  <generics-section id="trait-authoring-examples"> <header>Trait Authoring Considerations (Example)</header> <description> <mini-zoo class="zoo"> <entry> <trait-impl>⌾ <code>Query</code></trait-impl> </entry> </mini-zoo> <mini-zoo class="zoo"> <narrow-entry> <code style="text-align:center;width:100%">vs.</code> </narrow-entry> </mini-zoo> <mini-zoo class="zoo"> <entry> <trait-impl class="dotted">⌾ <code>Query&lt;I&gt;</code></trait-impl> </entry> </mini-zoo> <mini-zoo class="zoo"> <narrow-entry> <code style="text-align:center;width:100%">vs.</code> </narrow-entry> </mini-zoo> <mini-zoo class="zoo"> <entry> <trait-impl>⌾ <code>Query</code></trait-impl> <associated-type><code>type O;</code></associated-type> </entry> </mini-zoo> <mini-zoo class="zoo"> <narrow-entry> <code style="text-align:center;width:100%">vs.</code> </narrow-entry> </mini-zoo> <mini-zoo class="zoo"> <entry> <trait-impl class="dotted">⌾ <code>Query&lt;I&gt;</code></trait-impl> <associated-type><code>type O;</code></associated-type> </entry> </mini-zoo> <div>&nbsp;</div> <p>Choice of parameters goes along with purpose trait has to fill.</p> <hr> <p><strong>No Additional Parameters</strong></p> <pre><code>trait Query {
    fn search(&amp;self, needle: &amp;str);
}

impl Query for PostgreSQL { ... }
impl Query for Sled { ... }

postgres.search(&quot;SELECT ...&quot;);
</code></pre> <mini-zoo class="zoo"> <person>👩‍🦰</person> <entry> <trait-impl>⌾ <code>Query</code></trait-impl> </entry> </mini-zoo> <mini-zoo class="zoo"> <narrow-entry> <code style="text-align:center;width:100%">→</code> </narrow-entry> </mini-zoo> <mini-zoo class="zoo"> <person>🧔</person> <entry> <type class="composed"><code>PostgreSQL</code></type> <trait-impl>⌾ <code>Query</code></trait-impl> </entry> </mini-zoo> <mini-zoo class="zoo"> <entry> <type class="composed"><code>Sled</code></type> <trait-impl>⌾ <code>Query</code></trait-impl> </entry> </mini-zoo> <div>&nbsp;</div> <p>Trait author assumes:</p> <ul> <li>neither implementor nor user need to customize API.</li> </ul> <div>&nbsp;</div><hr> <p><strong>Input Parameters</strong></p> <pre><code>trait Query&lt;I&gt; {
    fn search(&amp;self, needle: I);
}

impl Query&lt;&amp;str&gt; for PostgreSQL { ... }
impl Query&lt;String&gt; for PostgreSQL { ... }
impl&lt;T&gt; Query&lt;T&gt; for Sled where T: ToU8Slice { ... }

postgres.search(&quot;SELECT ...&quot;);
postgres.search(input.to_string());
sled.search(file);
</code></pre> <mini-zoo class="zoo"> <person>👩‍🦰</person> <entry> <trait-impl class="dotted">⌾ <code>Query&lt;I&gt;</code></trait-impl> </entry> </mini-zoo> <mini-zoo class="zoo"> <narrow-entry> <code style="text-align:center;width:100%">→</code> </narrow-entry> </mini-zoo> <mini-zoo class="zoo"> <person>🧔</person> <entry> <type class="composed"><code>PostgreSQL</code></type> <trait-impl>⌾ <code>Query&lt;&str&gt;</code></trait-impl> <trait-impl>⌾ <code>Query&lt;String&gt;</code></trait-impl> </entry> </mini-zoo> <mini-zoo class="zoo"> <entry> <type class="composed"><code>Sled</code></type> <trait-impl class="dotted">⌾ <code>Query&lt;T&gt;</code></trait-impl> <note><span style="margin-left:10px;display:inline-block;transform:rotate(90deg);font-size:100%">↲</span> where <code>T</code> is <code>ToU8Slice</code>.</note> </entry> </mini-zoo> <div>&nbsp;</div> <p>Trait author assumes:</p> <ul> <li>implementor would customize API in multiple ways for same <code>Self</code> type,</li> <li>users may want ability to decide for which <code>I</code>-types behavior should be possible.</li> </ul> <div>&nbsp;</div><hr> <p><strong>Output Parameters</strong></p> <pre><code>trait Query {
    type O;
    fn search(&amp;self, needle: Self::O);
}

impl Query for PostgreSQL { type O = String; ...}
impl Query for Sled { type O = Vec&lt;u8&gt;; ... }

postgres.search(&quot;SELECT ...&quot;.to_string());
sled.search(vec![0, 1, 2, 4]);
</code></pre> <mini-zoo class="zoo"> <person>👩‍🦰</person> <entry> <trait-impl>⌾ <code>Query</code></trait-impl> <associated-type><code>type O;</code></associated-type> </entry> </mini-zoo> <mini-zoo class="zoo"> <narrow-entry> <code style="text-align:center;width:100%">→</code> </narrow-entry> </mini-zoo> <mini-zoo class="zoo"> <person>🧔</person> <entry> <type class="composed"><code>PostgreSQL</code></type> <trait-impl>⌾ <code>Query</code></trait-impl> <associated-type><code>O = String;</code></associated-type> </entry> </mini-zoo> <mini-zoo class="zoo"> <entry> <type class="composed"><code>Sled</code></type> <trait-impl>⌾ <code>Query</code></trait-impl> <associated-type><code>O = Vec&lt;u8&gt;;</code></associated-type> </entry> </mini-zoo> <div>&nbsp;</div> <p>Trait author assumes:</p> <ul> <li>implementor would customize API for <code>Self</code> type (but in only one way),</li> <li>users do not need, or should not have, ability to influence customization for specific <code>Self</code>.</li> </ul> <blockquote> <p>As you can see here, the term <strong>input</strong> or <strong>output</strong> does <strong>not</strong> (necessarily) have anything to do with whether <code>I</code> or <code>O</code> are inputs or outputs to an actual function!</p> </blockquote> <div>&nbsp;</div><hr> <p><strong>Multiple In- and Output Parameters</strong></p> <pre><code>trait Query&lt;I&gt; {
    type O;
    fn search(&amp;self, needle: I) -&gt; Self::O;
}

impl Query&lt;&amp;str&gt; for PostgreSQL { type O = String; ... }
impl Query&lt;CString&gt; for PostgreSQL { type O = CString; ... }
impl&lt;T&gt; Query&lt;T&gt; for Sled where T: ToU8Slice { type O = Vec&lt;u8&gt;; ... }

postgres.search(&quot;SELECT ...&quot;).to_uppercase();
sled.search(&amp;[1, 2, 3, 4]).pop();
</code></pre> <mini-zoo class="zoo"> <person>👩‍🦰</person> <entry> <trait-impl class="dotted">⌾ <code>Query&lt;I&gt;</code></trait-impl> <associated-type><code>type O;</code></associated-type> </entry> </mini-zoo> <mini-zoo class="zoo"> <narrow-entry> <code style="text-align:center;width:100%">→</code> </narrow-entry> </mini-zoo> <mini-zoo class="zoo"> <person>🧔</person> <entry> <type class="composed"><code>PostgreSQL</code></type> <trait-impl>⌾ <code>Query&lt;&str&gt;</code></trait-impl> <associated-type><code>O = String;</code></associated-type> <trait-impl>⌾ <code>Query&lt;CString&gt;</code></trait-impl> <associated-type><code>O = CString;</code></associated-type> </entry> </mini-zoo> <mini-zoo class="zoo"> <entry> <type class="composed"><code>Sled</code></type> <trait-impl class="dotted">⌾ <code>Query&lt;T&gt;</code></trait-impl> <associated-type><code>O = Vec&lt;u8&gt;;</code></associated-type> <note><span style="margin-left:10px;display:inline-block;transform:rotate(90deg);font-size:100%">↲</span> where <code>T</code> is <code>ToU8Slice</code>.</note> </entry> </mini-zoo> <div>&nbsp;</div> <p>Like examples above, in particular trait author assumes:</p> <ul> <li>users may want ability to decide for which <code>I</code>-types ability should be possible,</li> <li>for given inputs, implementor should determine resulting output type.</li> </ul> </description> </generics-section>  <generics-section id="xxx"> <header>Dynamic / Zero Sized Types</header> <description> <mini-zoo class="zoo"> <entry> <type class="composed"><code>MostTypes</code></type> <trait-impl>⌾ <code>Sized</code></trait-impl> <note>Normal types.</note> </entry> </mini-zoo> <mini-zoo class="zoo"> <narrow-entry style="width:60px"> <code style="text-align:center;width:100%">vs.</code> </narrow-entry> </mini-zoo> <mini-zoo class="zoo"> <entry> <type class="zero"><code>Z</code></type> <trait-impl>⌾ <code>Sized</code></trait-impl> <note>Zero sized.</note> </entry> </mini-zoo> <mini-zoo class="zoo"> <narrow-entry style="width:60px"> <code style="text-align:center;width:100%">vs.</code> </narrow-entry> </mini-zoo> <mini-zoo class="zoo"> <entry> <type class="primitive"><code>str</code></type> <trait-impl class="grayed">⌾ <code style="text-decoration:line-through">Sized</code></trait-impl> <note>Dynamically sized.</note> </entry> </mini-zoo> <mini-zoo class="zoo"> <entry> <type class="primitive"><code>[u8]</code></type> <trait-impl class="grayed">⌾ <code style="text-decoration:line-through">Sized</code></trait-impl> </entry> </mini-zoo> <mini-zoo class="zoo"> <entry> <type class="primitive"><code>dyn Trait</code></type> <trait-impl class="grayed">⌾ <code style="text-decoration:line-through">Sized</code></trait-impl> </entry> </mini-zoo> <mini-zoo class="zoo"> <entry> <type class="primitive"><code>...</code></type> <trait-impl class="grayed">⌾ <code style="text-decoration:line-through">Sized</code></trait-impl> </entry> </mini-zoo> <ul> <li>A type <code>T</code> is <strong><code>Sized</code></strong> <a href="https://doc.rust-lang.org/std&#x2F;marker&#x2F;trait.Sized.html"><sup class="mid">STD</sup></a> if at compile time it is known how many bytes it occupies, <code>u8</code> and <code>&amp;[u8]</code> are, <code>[u8]</code> isn't.</li> <li>Being <code>Sized</code> means <code>impl Sized for T {}</code> holds. Happens automatically and cannot be user impl'ed.</li> <li>Types not <code>Sized</code> are called <strong>dynamically sized types</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch19-04-advanced-types.html#dynamically-sized-types-and-the-sized-trait"><sup class="entry">BK</sup></a> <a href="https://nomicon.purewhite.io/exotic-sizes.html#dynamically-sized-types-dsts"><sup class="expert">NOM</sup></a> <a href="https://rustwiki.org/zh-CN/reference/dynamically-sized-types.html#dynamically-sized-types"><sup class="expert">REF</sup></a> (DSTs), sometimes <strong>unsized</strong>.</li> <li>Types without data are called <strong>zero sized types</strong> <a href="https://nomicon.purewhite.io/exotic-sizes.html#zero-sized-types-zsts"><sup class="expert">NOM</sup></a> (ZSTs), do not occupy space.</li> </ul> <div class="cheats color-header sized"> <table><thead><tr><th>示例</th><th>说明</th></tr></thead><tbody> <tr><td><code>struct A { x: u8 }</code></td><td>Type <code>A</code> is sized, i.e., <code>impl Sized for A</code> holds, this is a 'regular' type.</td></tr> <tr><td><code>struct B { x: [u8] }</code></td><td>Since <code>[u8]</code> is a DST, <code>B</code> in turn becomes DST, i.e., does not <code>impl Sized</code>.</td></tr> <tr><td><code>struct C&lt;T&gt; { x: T }</code></td><td>Type params <strong>have</strong> implicit <code>T: Sized</code> bound, e.g., <code>C&lt;A&gt;</code> is valid, <code>C&lt;B&gt;</code> is not.</td></tr> <tr><td><code>struct D&lt;T: ?Sized&gt; { x: T }</code></td><td>Using <strong><code>?Sized</code></strong> <a href="https://rustwiki.org/zh-CN/reference/trait-bounds.html#sized"><sup class="expert">REF</sup></a> allows opt-out of that bound, i.e., <code>D&lt;B&gt;</code> is also valid.</td></tr> <tr><td><code>struct E;</code></td><td>Type <code>E</code> is zero-sized (and also sized) and will not consume memory.</td></tr> <tr><td><code>trait F { fn f(&amp;self); }</code></td><td>Traits <strong>do not have</strong> an implicit <code>Sized</code> bound, i.e., <code>impl F for B {}</code> is valid.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>trait F: Sized {}</code></td><td>Traits can however opt into <code>Sized</code> via supertraits.<a href="#functions-behavior"><sup>↑</sup></a></td></tr> <tr><td><code>trait G { fn g(self); }</code></td><td>For <code>Self</code>-like params DST <code>impl</code> may still fail as params can't go on stack.</td></tr> </tbody></table> </div> </description> </generics-section>  <generics-section id="xxx"> <header><code>?Sized</code></header> <description> <mini-zoo class="zoo"> <entry> <type class="dotted generic"><code>S&lt;T&gt;</code></type> </entry> <narrow-entry> <code style="text-align:center;width:100%">→</code> </narrow-entry> <entry> <type class="composed"><code>S&lt;u8&gt;</code></type> </entry> <entry> <type class="composed"><code>S&lt;char&gt;</code></type> </entry> <entry> <type class="composed grayed"><code>S&lt;str&gt;</code></type> </entry> </mini-zoo> <pre><code>struct S&lt;T&gt; { ... }
</code></pre> <ul> <li><code>T</code> can be any concrete type.</li> <li>However, there exists invisible default bound <code>T: Sized</code>, so <code>S&lt;str&gt;</code> is not possible out of box.</li> <li>Instead we have to add <code>T : ?Sized</code> to opt-out of that bound:</li> </ul> <mini-zoo class="zoo"> <entry> <type class="dotted generic"><code>S&lt;T&gt;</code></type> </entry> <narrow-entry> <code style="text-align:center;width:100%">→</code> </narrow-entry> <entry> <type class="composed"><code>S&lt;u8&gt;</code></type> </entry> <entry> <type class="composed"><code>S&lt;char&gt;</code></type> </entry> <entry> <type class="composed"><code>S&lt;str&gt;</code></type> </entry> </mini-zoo> <pre><code>struct S&lt;T&gt; where T: ?Sized { ... }
</code></pre> </description> </generics-section>  <generics-section id="xxx"> <header>Generics and Lifetimes &mdash; <code>&lt;'a&gt;</code></header> <description> <mini-zoo class="zoo"> <entry> <type class="dotted generic"><code>S&lt;'a&gt;</code></type> </entry> <entry> <type class="dotted generic"><code>&'a f32</code></type> </entry> <entry> <type class="dotted generic"><code>&'a mut u8</code></type> </entry> </mini-zoo> <ul> <li>Lifetimes act<sup>*</sup> like type parameters: <ul> <li>user must provide specific <code>'a</code> to instantiate type (compiler will help within methods),</li> <li>as <code>Vec&lt;f32&gt;</code> and <code>Vec&lt;u8&gt;</code> are different types, so are <code>S&lt;'p&gt;</code> and <code>S&lt;'q&gt;</code>,</li> <li>meaning you can't just assign value of type <code>S&lt;'a&gt;</code> to variable expecting <code>S&lt;'b&gt;</code> (exception: &quot;subtype&quot; relationship for lifetimes, e.g. <code>'a</code> outliving <code>'b</code>).</li> </ul> </li> </ul> <mini-zoo class="zoo"> <entry> <type class="dotted generic"><code>S&lt;'a&gt;</code></type> </entry> <narrow-entry> <code style="text-align:center;width:100%">→</code> </narrow-entry> <entry> <type class="composed"><code>S&lt;'auto&gt;</code></type> </entry> <entry> <type class="composed"><code>S&lt;'static&gt;</code></type> </entry> </mini-zoo> <ul> <li><code>'static</code> is only nameable instance of the <em>typespace</em> lifetimes.</li> </ul> <pre><code>&#x2F;&#x2F; `&#x27;a is free parameter here (user can pass any specific lifetime)
struct S&lt;&#x27;a&gt; {
    x: &amp;&#x27;a u32
}

&#x2F;&#x2F; In non-generic code, &#x27;static is the only nameable lifetime we can explicitly put in here.
let a: S&lt;&#x27;static&gt;;

&#x2F;&#x2F; Alternatively, in non-generic code we can (often must) omit &#x27;a and have Rust determine
&#x2F;&#x2F; the right value for &#x27;a automatically.
let b: S;
</code></pre> <footnotes> <p><sup>*</sup> There are subtle differences, for example you can create an explicit instance <code>0</code> of a type <code>u32</code>, but with the exception of <code>'static</code> you can't really create a lifetime, e.g., &quot;lines 80 - 100&quot;, the compiler will do that for you. <a href="https:&#x2F;&#x2F;medium.com&#x2F;nearprotocol&#x2F;understanding-rust-lifetimes-e813bcd405fa"><sup>🔗</sup></a></p> </footnotes> <blockquote> <p>Note to self and TODO: that analogy seems somewhat flawed, as if <code>S&lt;'a&gt;</code> is to <code>S&lt;'static&gt;</code> like <code>S&lt;T&gt;</code> is to <code>S&lt;u32&gt;</code>, then <code>'static</code> would be a <em>type</em>; but then what's the value of that type?</p> </blockquote> </description> </generics-section>         </div></panel></tab> </tabs> <footnotes> <p>Examples expand by clicking.</p> </footnotes> <h2 id="type-zoo">Type Zoo<sup id="target-type-zoo" class="target"><a href="#type-zoo">url</a></sup></h2> <p>A visual overview of types and traits in crates.</p>  <div style="overflow:auto"> <div style="min-width:100%;width:750px"> <zoo class="zoo">  <region style="height:310px">  <group style="left:6%;width:200px"> <entry style="left:100px;top:10%"> <type class="primitive"><code>u8</code></type> </entry> <entry style="left:20px;top:32%"> <type class="primitive"><code>u16</code></type> </entry> <entry style="left:30px;top:20%"> <type class="primitive"><code>f32</code></type> </entry> <entry style="left:0;top:7%"> <type class="primitive"><code>bool</code></type> </entry> <entry style="left:120px;top:32%"> <type class="primitive"><code>char</code></type> </entry> <label style="left:8px;top:43%">Primitive Types</label> </group>  <group style="left:50%;width:350px"> <entry style="left:110px;top:60px"> <type class="composed"><code>File</code></type> </entry> <entry style="left:180px;top:34%"> <type class="composed"><code>String</code></type> </entry> <entry style="left:230px;top:13%"> <type class="composed"><code>Builder</code></type> </entry> <label style="left:150px;top:43%">Composite Types</label> </group>  <group style="left:30px;top:53%;width:200px">  <entry style="left:50px;top:8%"> <type class="composed"><code>Vec&lt;T&gt;</code></type> </entry> <entry style="left:45px;top:9%"> <type class="composed"><code>Vec&lt;T&gt;</code></type> </entry> <entry style="left:40px;top:10%"> <type class="dotted generic"><code>Vec&lt;T&gt;</code></type> </entry>  <entry style="left:170px;top:2%"> <type class="primitive"><code>&'a T</code></type> </entry> <entry style="left:165px;top:3%"> <type class="primitive"><code>&'a T</code></type> </entry> <entry style="left:160px;top:4%"> <type class="dotted generic"><code>&'a T</code></type> </entry>  <entry style="left:140px;top:18%"> <type class="primitive"><code>&mut 'a T</code></type> </entry> <entry style="left:135px;top:19%"> <type class="primitive"><code>&mut 'a T</code></type> </entry> <entry style="left:130px;top:20%"> <type class="dotted generic"><code>&mut 'a T</code></type> </entry>  <entry style="left:40px;top:28%"> <type class="primitive"><code>[T; n]</code></type> </entry> <entry style="left:35px;top:29%"> <type class="primitive"><code>[T; n]</code></type> </entry> <entry style="left:30px;top:30%"> <type class="dotted generic"><code>[T; n]</code></type> </entry> <label style="left:80px;top:40%">Type Constructors</label> </group>  <group style="left:50%;top:53%;width:200px">  <entry style="left:10px;top:8%"> <function><code>Vec&lt;T&gt;</code></function> </entry> <entry style="left:5px;top:9%"> <function><code>Vec&lt;T&gt;</code></function> </entry> <entry style="left:0;top:10%"> <function class="dotted"><code>f&lt;T&gt;() {}</code></function> </entry>  <entry style="left:20px;top:24%"> <function><code>drop() {}</code></function> </entry> <label style="left:10px;top:40%">Functions</label> </group>    <group class="grayed" style="left:80%;top:53%;width:140px"> <entry style="left:5px;top:15%"> <macro><code>PI</code></macro> </entry> <entry style="left:0;top:28%"> <macro><code>dbg!</code></macro> </entry> <label style="left:20px;top:40%">Other</label> </group>  <group style="left:36%;width:30px"> <entry style="left:20px;top:20px"> <trait-impl>⌾ <code>Copy</code></trait-impl> </entry> <entry style="left:60px;top:90px"> <trait-impl>⌾ <code>Deref</code></trait-impl> <associated-type><code>type Tgt;</code></associated-type> </entry> <entry style="left:90px;top:50px"> <trait-impl>⌾ <code>From&lt;T&gt;</code></trait-impl> </entry> <entry style="left:85px;top:55px"> <trait-impl>⌾ <code>From&lt;T&gt;</code></trait-impl> </entry> <entry style="left:80px;top:60px"> <trait-impl class="dotted">⌾ <code>From&lt;T&gt;</code></trait-impl> </entry> <label style="left:60px;top:43%">Traits</label> </group> </region> <region-label>Items defined in upstream crates.</region-label>  <region class="your-crate" style="height:190px">  <group style="left:5px;width:200px"> <entry style="left:10px;top:25px"> <trait-impl>⌾ <code>Serialize</code></trait-impl> </entry> <entry style="left:30px;top:65px"> <trait-impl>⌾ <code>Transport</code></trait-impl> </entry> <entry style="left:15px;top:105px"> <trait-impl>⌾ <code>ShowHex</code></trait-impl> </entry>  </group>  <group style="left:150px;width:200px"> <entry style="left:0;top:25px"> <type class="composed"><code>Device</code></type> <trait-impl class="grayed">⌾ <code>From&lt;u8&gt;</code></trait-impl>  <note>Foreign trait impl. for local type.</note> </entry> <entry style="left:100px;top:25px"> <type class="composed grayed"><code>String</code></type> <trait-impl>⌾ <code>Serialize</code></trait-impl> <note>Local trait impl. for foreign type.</note> </entry> <entry style="left:200px;top:25px"> <type class="composed grayed"><code>String</code></type> <trait-impl class="grayed">⌾ <code>From&lt;u8&gt;</code></trait-impl> <note><sup>🛑</sup> Illegal, foreign trait for f. type.</note> </entry> <entry style="left:200px;top:110px"> <type class="composed grayed"><code>String</code></type> <trait-impl class="grayed">⌾ <code>From&lt;Port&gt;</code></trait-impl> <note>Exception: Legal if used type local.</note> </entry> <entry style="left:300px;top:25px"> <type class="composed"><code>Port</code></type> <trait-impl>⌾ <code>From&lt;u8&gt;</code></trait-impl> <trait-impl>⌾ <code>From&lt;u16&gt;</code></trait-impl> <note>Mult. impl. of trait with differing <b>IN</b> params.</note> </entry> <entry style="left:400px;top:25px"> <type class="composed"><code>Container</code></type> <trait-impl>⌾ <code>Deref</code></trait-impl> <associated-type class="grayed"><code>Tgt = u8;</code></associated-type> <trait-impl>⌾ <code>Deref</code></trait-impl> <associated-type class="grayed"><code>Tgt = f32;</code></associated-type> <note><sup>🛑</sup> Illegal impl. of trait with differing <b>OUT</b> params.</note> </entry> <entry style="left:510px;top:15px"> <type class="composed"><code>T</code></type> </entry> <entry style="left:505px;top:20px"> <type class="composed"><code>T</code></type> </entry> <entry style="left:500px;top:25px"> <type class="dotted generic"><code>T</code></type> <trait-impl>⌾ <code>ShowHex</code></trait-impl> <note>Blanket impl. of trait for any type.</note> </entry> </group> </region> <region-label>Your crate.</region-label>   </zoo> <footnotes> <p>A walk through the jungle of types, traits, and implementations that (might possibly) exist in your application.</p> </footnotes>  </div> </div> <h2 id="type-conversions">Type Conversions<sup id="target-type-conversions" class="target"><a href="#type-conversions">url</a></sup></h2> <p>How to get <code>B</code> when you have <code>A</code>?</p> <div class="color-header variance"> <tabs>  <tab> <input type="radio" id="tab-variance-1" name="tab-variance" checked> <label for="tab-variance-1"><b>Intro</b></label> <panel><div> <pre><code>fn f(x: A) -&gt; B {
    &#x2F;&#x2F; How can you obtain B from A?
}
</code></pre> <table><thead><tr><th>Method</th><th>Explanation</th></tr></thead><tbody> <tr><td><strong>Identity</strong></td><td>Trivial case, <code>B</code> <strong>is exactly</strong> <code>A</code>.</td></tr> <tr><td><strong>Computation</strong></td><td>Create and manipulate instance of <code>B</code> by <strong>writing code</strong> transforming data.</td></tr> <tr><td><strong>Casts</strong></td><td><strong>On-demand</strong> conversion between types where caution is advised.</td></tr> <tr><td><strong>Coercions</strong></td><td><strong>Automatic</strong> conversion within <em>'weakening ruleset'</em>.<sup>1</sup></td></tr> <tr><td><strong>Subtyping</strong></td><td><strong>Automatic</strong> conversion within <em>'same-layout-different-lifetimes ruleset'</em>.<sup>1</sup></td></tr> </tbody></table> <div>&nbsp;</div><footnotes> <p><sup>1</sup> While both convert <code>A</code> to <code>B</code>, <strong>coercions</strong> generally link to an <em>unrelated</em> <code>B</code> (a type &quot;one could reasonably expect to have different methods&quot;), while <strong>subtyping</strong> links to a <code>B</code> differing only in lifetimes.</p> </footnotes> </div></panel></tab>  <tab> <input type="radio" id="tab-variance-2" name="tab-variance"> <label for="tab-variance-2"><b>Computation (Traits)</b></label> <panel><div> <pre><code>fn f(x: A) -&gt; B {
    x.into()
}
</code></pre> <p><em>Bread and butter</em> way to get <code>B</code> from <code>A</code>. Some traits provide canonical, user-computable type relations:</p> <table><thead><tr><th>Trait</th><th>Example</th><th>Trait implies ...</th></tr></thead><tbody> <tr><td><code>impl From&lt;A&gt; for B {}</code></td><td><code>a.into()</code></td><td><em>Obvious</em>, always-valid relation.</td></tr> <tr><td><code>impl TryFrom&lt;A&gt; for B {}</code></td><td><code>a.try_into()?</code></td><td><em>Obvious</em>, sometimes-valid relation.</td></tr> <tr><td><code>impl Deref for A {}</code></td><td><code>*a</code></td><td><code>A</code> is smart pointer carrying <code>B</code>; also enables coercions.</td></tr> <tr><td><code>impl AsRef&lt;B&gt; for A {}</code></td><td><code>a.as_ref()</code></td><td><code>A</code> can be <em>viewed</em> as <code>B</code>.</td></tr> <tr><td><code>impl AsMut&lt;B&gt; for A {}</code></td><td><code>a.as_mut()</code></td><td><code>A</code> can be mutably viewed as <code>B</code>.</td></tr> <tr><td><code>impl Borrow&lt;B&gt; for A {}</code></td><td><code>a.borrow()</code></td><td><code>A</code> has borrowed <em>analog</em> <code>B</code> (behaving same under <code>Eq</code>, ...).</td></tr> <tr><td><code>impl ToOwned for A { ... }</code></td><td><code>a.to_owned()</code></td><td><code>A</code> has owned analog <code>B</code>.</td></tr> </tbody></table>  </div></panel></tab>  <tab> <input type="radio" id="tab-variance-3" name="tab-variance"> <label for="tab-variance-3"><b>Casts</b></label> <panel><div> <pre><code>fn f(x: A) -&gt; B {
    x as B
}
</code></pre> <p>Convert types <strong>with keyword <code>as</code></strong> if conversion <em>relatively obvious</em> but <strong>might cause issues</strong>. <a href="https://nomicon.purewhite.io/casts.html"><sup class="expert">NOM</sup></a></p> <table><thead><tr><th>A</th><th>B</th><th>示例</th><th>说明</th></tr></thead><tbody> <tr><td><code>Ptr</code></td><td><code>Ptr</code></td><td><code>device_ptr as *const u8</code></td><td>If <code>*A</code>, <code>*B</code> are <code>Sized</code>.</td></tr> <tr><td><code>Ptr</code></td><td><code>Integer</code></td><td><code>device_ptr as usize</code></td><td></td></tr> <tr><td><code>Integer</code></td><td><code>Ptr</code></td><td><code>my_usize as *const Device</code></td><td></td></tr> <tr><td><code>Number</code></td><td><code>Number</code></td><td><code>my_u8 as u16</code></td><td>Often surprising behavior. <a href="#numeric-types-ref"><sup>↑</sup></a></td></tr> <tr><td><code>enum</code> w/o fields</td><td><code>Integer</code></td><td><code>E::A as u8</code></td><td></td></tr> <tr><td><code>bool</code></td><td><code>Integer</code></td><td><code>true as u8</code></td><td></td></tr> <tr><td><code>char</code></td><td><code>Integer</code></td><td><code>'A' as u8</code></td><td></td></tr> <tr><td><code>&amp;[T; N]</code></td><td><code>*const T</code></td><td><code>my_ref as *const u8</code></td><td></td></tr> <tr><td><code>fn(...)</code></td><td><code>Ptr</code></td><td><code>f as *const u8</code></td><td>If <code>Ptr</code> is <code>Sized</code>.</td></tr> <tr><td><code>fn(...)</code></td><td><code>Integer</code></td><td><code>f as usize</code></td><td></td></tr> </tbody></table> <div>&nbsp;</div><footnote> <p>Where <code>Ptr</code>, <code>Integer</code>, <code>Number</code> are just used for brevity and actually mean:</p> <ul> <li><code>Ptr</code> any <code>*const T</code> or <code>*mut T</code>;</li> <li><code>Integer</code> any countable <code>u8</code> ... <code>i128</code>;</li> <li><code>Number</code> any <code>Integer</code>, <code>f32</code>, <code>f64</code>.</li> </ul> </footnote> <blockquote> <p><strong>Opinion</strong> <sup>💬</sup> — Casts, esp. <code>Number</code> - <code>Number</code>, can easily go wrong. If you are concerned with correctness, consider more explicit methods instead.</p> </blockquote> </div></panel></tab>  <tab> <input type="radio" id="tab-variance-4" name="tab-variance"> <label for="tab-variance-4"><b>Coercions</b></label> <panel><div> <pre><code>fn f(x: A) -&gt; B {
    x
}
</code></pre> <p>Automatically <strong>weaken</strong> type <code>A</code> to <code>B</code>; types can be <em>substantially</em><sup>1</sup> different. <a href="https://nomicon.purewhite.io/coercions.html"><sup class="expert">NOM</sup></a></p> <table><thead><tr><th>A</th><th>B</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>&amp;mut T</code></td><td><code>&amp;T</code></td><td><strong>Pointer weakening</strong>.</td></tr> <tr><td><code>&amp;mut T</code></td><td><code>*mut T</code></td><td>-</td></tr> <tr><td><code>&amp;T</code></td><td><code>*const T</code></td><td>-</td></tr> <tr><td><code>*mut T</code></td><td><code>*const T</code></td><td>-</td></tr> <tr><td><code>&amp;T</code></td><td><code>&amp;U</code></td><td><strong>Deref</strong>, if <code>impl Deref&lt;Target=U&gt; for T</code>.</td></tr> <tr><td><code>T</code></td><td><code>U</code></td><td><strong>Unsizing</strong>, if <code>impl CoerceUnsized&lt;U&gt; for T</code>.<sup>2</sup> <sup>🚧</sup></td></tr> <tr><td><code>T</code></td><td><code>V</code></td><td><strong>Transitivity</strong>, if <code>T</code> coerces to <code>U</code> and <code>U</code> to <code>V</code>.</td></tr> <tr><td><code>|x| x + x</code></td><td><code>fn(u8) -&gt; u8</code></td><td><strong>Non-capturing closure</strong>, to equivalent <code>fn</code> pointer.</td></tr> </tbody></table> <div>&nbsp;</div><footnote> <p><sup>1</sup> <em>Substantially</em> meaning one can regularly expect a coercion result <code>B</code> to be <em>an entirely different type</em> (i.e., have entirely different methods) than the original type <code>A</code>.</p> <p><sup>2</sup> Does not quite work in example above as unsized can't be on stack; imagine <code>f(x: &amp;A) -&gt; &amp;B</code> instead. Unsizing works by default for:</p> <ul> <li><code>[T; n]</code> to <code>[T]</code></li> <li><code>T</code> to <code>dyn Trait</code> if <code>impl Trait for T {}</code>.</li> <li><code>Foo&lt;..., T, ...&gt;</code> to <code>Foo&lt;..., U, ...&gt;</code> under arcane <a href="https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;nomicon&#x2F;coercions.html"><sup>🔗</sup></a> circumstances.</li> </ul> </footnote> </div></panel></tab>  <tab> <input type="radio" id="tab-variance-5" name="tab-variance"> <label for="tab-variance-5"><b>Subtyping</b></label> <panel><div> <pre><code>fn f(x: A) -&gt; B {
    x
}
</code></pre> <p>Automatically converts <code>A</code> to <code>B</code> for types <strong>only differing in lifetimes</strong> <a href="https://nomicon.purewhite.io/subtyping.html"><sup class="expert">NOM</sup></a> - subtyping <strong>examples</strong>:</p> <table><thead><tr><th>A<sup>(subtype)</sup></th><th>B<sup>(supertype)</sup></th><th>Explanation</th></tr></thead><tbody> <tr><td><code>&amp;'static u8</code></td><td><code>&amp;'a u8</code></td><td>Valid, <i>forever-</i>pointer is also <i>transient-</i>pointer.</td></tr> <tr><td><code>&amp;'a u8</code></td><td><code>&amp;'static u8</code></td><td><sup>🛑</sup> Invalid, transient should not be forever.</td></tr> <tr><td><code>&amp;'a &amp;'b u8</code></td><td><code>&amp;'a &amp;'b u8</code></td><td>Valid, same thing. <strong>But now things get interesting. Read on.</strong></td></tr> <tr><td><code>&amp;'a &amp;'static u8</code></td><td><code>&amp;'a &amp;'b u8</code></td><td>Valid, <code>&amp;'static u8</code> is also <code>&amp;'b u8</code>; <strong>covariant</strong> inside <code>&amp;</code>.</td></tr> <tr><td><code>&amp;'a mut &amp;'static u8</code></td><td><code>&amp;'a mut &amp;'b u8</code></td><td><sup>🛑</sup> Invalid and surprising; <strong>invariant</strong> inside <code>&amp;mut</code>.</td></tr> <tr><td><code>Box&lt;&amp;'a static&gt;</code></td><td><code>Box&lt;&amp;'a u8&gt;</code></td><td>Valid, box with forever is also box with transient; covariant.</td></tr> <tr><td><code>Box&lt;&amp;'a u8&gt;</code></td><td><code>Box&lt;&amp;'static u8&gt;</code></td><td><sup>🛑</sup> Invalid, box with transient may not be with forever.</td></tr> <tr><td><code>Box&lt;&amp;'a mut u8&gt;</code></td><td><code>Box&lt;&amp;'a u8&gt;</code></td><td><sup>🛑</sup> <sup>⚡</sup> Invalid, see table below, <code>&amp;mut u8</code> never <em>was a</em> <code>&amp;u8</code>.</td></tr> <tr><td><code>Cell&lt;&amp;'a static&gt;</code></td><td><code>Cell&lt;&amp;'a u8&gt;</code></td><td><sup>🛑</sup> Invalid, cells are <strong>never</strong> something else; invariant.</td></tr> <tr><td><code>fn(&amp;'static u8)</code></td><td><code>fn(&amp;'u8 u8)</code></td><td><sup>🛑</sup> If <code>fn</code> needs forever it may choke on transients; <strong>contravar.</strong></td></tr> <tr><td><code>fn(&amp;'a u8)</code></td><td><code>fn(&amp;'static u8)</code></td><td>But sth. that eats transients <strong>can be</strong>(!) sth. that eats forevers.</td></tr> <tr><td><code>for&lt;'r&gt; fn(&amp;'r u8)</code></td><td><code>fn(&amp;'a u8)</code></td><td>Higher-ranked type <code>for&lt;'r&gt; fn(&amp;'r u8)</code> is also <code>fn(&amp;'a u8).</code></td></tr> </tbody></table> <div>&nbsp;</div> <p>In contrast, these are <strong>not</strong><sup>🛑</sup> examples of subtyping:</p> <table><thead><tr><th>A</th><th>B</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>u16</code></td><td><code>u8</code></td><td><sup>🛑</sup> <strong>Obviously invalid</strong>; <code>u16</code> should never automatically be <code>u8</code>.</td></tr> <tr><td><code>u8</code></td><td><code>u16</code></td><td><sup>🛑</sup> Invalid <strong>by design</strong>; types w. different data still never subtype even if they <em>could</em>.</td></tr> <tr><td><code>&amp;'a mut u8</code></td><td><code>&amp;'a u8</code></td><td><sup>🛑</sup> Trojan horse, not subtyping; but coercion (still works, just not subtyping).</td></tr> </tbody></table> <div>&nbsp;</div></div></panel></tab>  <tab> <input type="radio" id="tab-variance-8" name="tab-variance"> <label for="tab-variance-8"><b>Variance</b></label> <panel><div> <pre><code>fn f(x: A) -&gt; B {
    x
}
</code></pre> <p>Automatically converts <code>A</code> to <code>B</code> for types <strong>only differing in lifetimes</strong> <a href="https://nomicon.purewhite.io/subtyping.html"><sup class="expert">NOM</sup></a> - subtyping <strong>variance rules</strong>:</p> <ul> <li>A longer lifetime <code>'a</code> that outlives a shorter <code>'b</code> is a subtype of <code>'b</code>.</li> <li>Implies <code>'static</code> is subtype of all other lifetimes <code>'a</code>.</li> <li>Whether types with parameters (e.g., <code>&amp;'a T</code>) are subtypes of each other the following variance table is used:</li> </ul> <table><thead><tr><th>Construct<sup>1</sup></th><th><code>'a</code></th><th><code>T</code></th><th><code>U</code></th></tr></thead><tbody> <tr><td><code>&amp;'a T</code></td><td>covariant</td><td>covariant</td><td></td></tr> <tr><td><code>&amp;'a mut T</code></td><td>covariant</td><td>invariant</td><td></td></tr> <tr><td><code>Box&lt;T&gt;</code></td><td></td><td>covariant</td><td></td></tr> <tr><td><code>Cell&lt;T&gt;</code></td><td></td><td>invariant</td><td></td></tr> <tr><td><code>fn(T) -&gt; U</code></td><td></td><td><strong>contra</strong>variant</td><td>covariant</td></tr> <tr><td><code>*const T</code></td><td></td><td>covariant</td><td></td></tr> <tr><td><code>*mut T</code></td><td></td><td>invariant</td><td></td></tr> </tbody></table> <footnotes> <p><strong>Covariant</strong> means if <code>A</code> is subtype of <code>B</code>, then <code>T[A]</code> is subtype of <code>T[B]</code>. <br> <strong>Contravariant</strong> means if <code>A</code> is subtype of <code>B</code>, then <strong><code>T[B]</code></strong> is subtype of <code>T[A]</code>. <br> <strong>Invariant</strong> means even if <code>A</code> is subtype of <code>B</code>, neither <code>T[A]</code> nor <code>T[B]</code> will be subtype of the other.<br></p>  <p><sup>1</sup> Compounds like <code>struct S&lt;T&gt; {}</code> obtain variance through their used fields, usually becoming invariant if multiple variances are mixed.<br></p> </footnotes> <blockquote> <p>💡 <strong>In other words</strong>, 'regular' types are never subtypes of each other (e.g., <code>u8</code> is not subtype of <code>u16</code>), and a <code>Box&lt;u32&gt;</code> would never be sub- or supertype of anything. However, generally a <code>Box&lt;A&gt;</code>, <em>can</em> be subtype of <code>Box&lt;B&gt;</code> (via covariance) if <code>A</code> is a subtype of <code>B</code>, which can only happen if <code>A</code> and <code>B</code> are 'sort of the same type that only differed in lifetimes', e.g., <code>A</code> being <code>&amp;'static u32</code> and <code>B</code> being <code>&amp;'a u32</code>.</p> </blockquote> </div></panel></tab> </tabs> </div> <div>&nbsp;</div> <hr> <h1 id="coding-guides">Coding Guides<sup id="target-coding-guides" class="target"><a href="#coding-guides">url</a></sup></h1> <h2 id="idiomatic-rust">Idiomatic Rust<sup id="target-idiomatic-rust" class="target"><a href="#idiomatic-rust">url</a></sup></h2> <p>If you are used to programming Java or C, consider these.</p> <div class="blue color-header"> <table><thead><tr><th>Idiom</th><th>Code</th></tr></thead><tbody> <tr><td><strong>Think in Expressions</strong></td><td><code>x = if x { a } else { b };</code></td></tr> <tr><td></td><td><code>x = loop { break 5 };</code></td></tr> <tr><td></td><td><code>fn f() -&gt; u32 { 0 }</code></td></tr> <tr><td><strong>Think in Iterators</strong></td><td><code>(1..10).map(f).collect()</code></td></tr> <tr><td></td><td><code>names.iter().filter(|x| x.starts_with(&quot;A&quot;))</code></td></tr> <tr><td><strong>Handle Absence with <code>?</code></strong></td><td><code>x = try_something()?;</code></td></tr> <tr><td></td><td><code>get_option()?.run()?</code></td></tr> <tr><td><strong>Use Strong Types</strong></td><td><code>enum E { Invalid, Valid { ... } }</code> over <code>ERROR_INVALID = -1</code></td></tr> <tr><td></td><td><code>enum E { Visible, Hidden }</code> over <code>visible: bool</code></td></tr> <tr><td></td><td><code>struct Charge(f32)</code> over <code>f32</code></td></tr> <tr><td><strong>Provide Builders</strong></td><td><code>Car::new(&quot;Model T&quot;).hp(20).build();</code></td></tr> <tr><td><strong>Split Implementations</strong></td><td>Generic types <code>S&lt;T&gt;</code> can have a separate <code>impl</code> per <code>T</code>.</td></tr> <tr><td></td><td>Rust doesn't have OO, but with separate <code>impl</code> you can get specialization.</td></tr> <tr><td><strong>Unsafe</strong></td><td>Avoid <code>unsafe {}</code>, often safer, faster solution without it. Exception: FFI.</td></tr> <tr><td><strong>Implement Traits</strong></td><td><code>#[derive(Debug, Copy, ...)]</code> and custom <code>impl</code> where needed.</td></tr> <tr><td><strong>Tooling</strong></td><td>With <a href="https://github.com/rust-lang/rust-clippy"><strong>clippy</strong></a> you can improve your code quality.</td></tr> <tr><td></td><td>Formatting with <a href="https://github.com/rust-lang/rustfmt"><strong>rustfmt</strong></a> helps others to read your code.</td></tr> <tr><td></td><td>Add <strong>unit tests</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch11-01-writing-tests.html"><sup class="entry">BK</sup></a> (<code>#[test]</code>) to ensure your code works.</td></tr> <tr><td></td><td>Add <strong>doc tests</strong> <a href="https://kaisery.github.io/trpl-zh-cn/ch14-02-publishing-to-crates-io.html"><sup class="entry">BK</sup></a> (<code>``` my_api::f() ```</code>) to ensure docs match code.</td></tr> <tr><td><strong>Documentation</strong></td><td>Annotate your APIs with doc comments that can show up on <a href="https://docs.rs"><strong>docs.rs</strong></a>.</td></tr> <tr><td></td><td>Don't forget to include a <strong>summary sentence</strong> and the <strong>Examples</strong> heading.</td></tr> <tr><td></td><td>If applicable: <strong>Panics</strong>, <strong>Errors</strong>, <strong>Safety</strong>, <strong>Abort</strong> and <strong>Undefined Behavior</strong>.</td></tr> </tbody></table> </div> <div>&nbsp;</div> <blockquote> <p>🔥 We <strong>highly</strong> recommend you also follow the <a href="https://rust-lang.github.io/api-guidelines/"><strong>API Guidelines</strong></a> (<a href="https://rust-lang.github.io/api-guidelines/checklist.html"><strong>Checklist</strong></a>) for any shared project! 🔥</p> </blockquote> <div>&nbsp;</div><h2 id="async-await-101">Async-Await 101<sup id="target-async-await-101" class="target"><a href="#async-await-101">url</a></sup></h2> <p>If you are familiar with async / await in C# or TypeScript, here are some things to keep in mind:</p> <tabs class="color-header orange">  <tab> <input type="radio" id="tab-async-1" name="tab-async" checked> <label for="tab-async-1"><b>Basics</b></label> <panel><div> <table><thead><tr><th>Construct</th><th>Explanation</th></tr></thead><tbody> <tr><td><code>async</code></td><td>Anything declared <code>async</code> always returns an <code>impl Future&lt;Output=_&gt;</code>. <a href="https://doc.rust-lang.org/std&#x2F;future&#x2F;trait.Future.html"><sup class="mid">STD</sup></a></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>async fn f() {}</code></td><td>Function <code>f</code> returns an <code>impl Future&lt;Output=()&gt;</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>async fn f() -&gt; S {}</code></td><td>Function <code>f</code> returns an <code>impl Future&lt;Output=S&gt;</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>async { x }</code></td><td>Transforms <code>{ x }</code> into an <code>impl Future&lt;Output=X&gt;</code>.</td></tr> <tr><td><code>let sm = f(); </code></td><td>Calling <code>f()</code> that is <code>async</code> will <strong>not</strong> execute <code>f</code>, but produce state machine <code>sm</code>. <sup>1</sup> <sup>2</sup></td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <code>sm = async { g() };</code></td><td>Likewise, does <strong>not</strong> execute the <code>{ g() }</code> block; produces state machine.</td></tr> <tr><td><code>runtime.block_on(sm);</code></td><td>Outside an <code>async {}</code>, schedules <code>sm</code> to actually run. Would execute <code>g()</code>. <sup>3</sup> <sup>4</sup></td></tr> <tr><td><code>sm.await</code></td><td>Inside an <code>async {}</code>, run <code>sm</code> until complete. Yield to runtime if <code>sm</code> not ready.</td></tr> </tbody></table> <footnotes> <p><sup>1</sup> Technically <code>async</code> transforms following code into anonymous, compiler-generated state machine type; <code>f()</code> instantiates that machine. <br> <sup>2</sup> The state machine always <code>impl Future</code>, possibly <code>Send</code> &amp; co, depending on types used inside <code>async</code>. <br> <sup>3</sup> State machine driven by worker thread invoking <code>Future::poll()</code> via runtime directly, or parent <code>.await</code> indirectly. <br> <sup>4</sup> Rust doesn't come with runtime, need external crate instead, e.g., <a href="https://github.com/async-rs/async-std">async-std</a> or <a href="https://crates.io/crates/tokio">tokio 0.2+</a>. Also, more helpers in <a href="https://github.com/rust-lang-nursery/futures-rs">futures crate</a>.</p> </footnotes> </div></panel></tab>  <tab> <input type="radio" id="tab-async-2" name="tab-async"> <label for="tab-async-2"><b>Execution Flow</b></label> <panel><div> <p>At each <code>x.await</code>, state machine passes control to subordinate state machine <code>x</code>. At some point a low-level state machine invoked via <code>.await</code> might not be ready. In that the case worker thread returns all the way up to runtime so it can drive another Future. Some time later the runtime:</p> <ul> <li><strong>might</strong> resume execution. It usually does, unless <code>sm</code> / <code>Future</code> dropped.</li> <li><strong>might</strong> resume with the previous worker <strong>or another</strong> worker thread (depends on runtime).</li> </ul> <p>Simplified diagram for code written inside an <code>async</code> block :</p>  <div style="overflow:auto"> <div style="min-width:100%;width:650px"> <pre><code>       consecutive_code();           consecutive_code();           consecutive_code();
START --------------------&gt; x.await --------------------&gt; y.await --------------------&gt; READY
&#x2F;&#x2F; ^                          ^     ^                               Future&lt;Output=X&gt; ready -^
&#x2F;&#x2F; Invoked via runtime        |     |
&#x2F;&#x2F; or an external .await      |     This might resume on another thread (next best available),
&#x2F;&#x2F;                            |     or NOT AT ALL if Future was dropped.
&#x2F;&#x2F;                            |
&#x2F;&#x2F;                            Execute `x`. If ready: just continue execution; if not, return
&#x2F;&#x2F;                            this thread to runtime.
</code></pre> </div> </div> </div></panel></tab>  <tab> <input type="radio" id="tab-async-3" name="tab-async"> <label for="tab-async-3"><b>Caveats</b></label> <panel><div> <p>With the execution flow in mind, some considerations when writing code inside an <code>async</code> construct:</p> <div class="color-header orange"> <table><thead><tr><th>Constructs <sup>1</sup></th><th>Explanation</th></tr></thead><tbody> <tr><td><code>sleep_or_block();</code></td><td>Definitely bad <sup>🛑</sup>, never halt current thread, clogs executor.</td></tr> <tr><td><code>set_TL(a); x.await; TL();</code></td><td>Definitely bad <sup>🛑</sup>, <code>await</code> may return from other thread, <a href="https://doc.rust-lang.org/std/macro.thread_local.html">thread local</a> invalid.</td></tr> <tr><td><code>s.no(); x.await; s.go();</code></td><td>Maybe bad <sup>🛑</sup>, <code>await</code> will <a href="http://www.randomhacks.net/2019/03/09/in-nightly-rust-await-may-never-return/">not return</a> if <code>Future</code> dropped while waiting. <sup>2</sup></td></tr> <tr><td><code>Rc::new(); x.await; rc();</code></td><td>Non-<code>Send</code> types prevent <code>impl Future</code> from being <code>Send</code>; less compatible.</td></tr> </tbody></table> </div> <footnotes> <p><sup>1</sup> Here we assume <code>s</code> is any non-local that could temporarily be put into an invalid state; <code>TL</code> is any thread local storage, and that the <code>async {}</code> containing the code is written without assuming executor specifics. <br> <sup>2</sup> Since <a href="https://doc.rust-lang.org/std/ops/trait.Drop.html">Drop</a> is run in any case when <code>Future</code> is dropped, consider using drop guard that cleans up / fixes application state if it has to be left in bad condition across <code>.await</code> points.</p> </footnotes> </div></panel></tab>  </tabs> <div>&nbsp;</div><h2 id="closures-in-apis">Closures in APIs<sup id="target-closures-in-apis" class="target"><a href="#closures-in-apis">url</a></sup></h2> <p>There is a subtrait relationship <code>Fn</code> : <code>FnMut</code> : <code>FnOnce</code>. That means a closure that implements <code>Fn</code> <a href="https://doc.rust-lang.org/std&#x2F;ops&#x2F;trait.Fn.html"><sup class="mid">STD</sup></a> also implements <code>FnMut</code> and <code>FnOnce</code>. Likewise a closure that implements <code>FnMut</code> <a href="https://doc.rust-lang.org/std&#x2F;ops&#x2F;trait.FnMut.html"><sup class="mid">STD</sup></a> also implements <code>FnOnce</code>. <a href="https://doc.rust-lang.org/std&#x2F;ops&#x2F;trait.FnOnce.html"><sup class="mid">STD</sup></a></p> <p>From a call site perspective that means:</p> <div class="color-header green"> <table><thead><tr><th>Signature</th><th>Function <code>g</code> can call …</th><th>Function <code>g</code> accepts …</th></tr></thead><tbody> <tr><td><code>g&lt;F: FnOnce()&gt;(f: F)</code></td><td>… <code>f()</code> once.</td><td><code>Fn</code>, <code>FnMut</code>, <code>FnOnce</code></td></tr> <tr><td><code>g&lt;F: FnMut()&gt;(mut f: F)</code></td><td>… <code>f()</code> multiple times.</td><td><code>Fn</code>, <code>FnMut</code></td></tr> <tr><td><code>g&lt;F: Fn()&gt;(f: F)</code></td><td>… <code>f()</code> multiple times.</td><td><code>Fn</code></td></tr> </tbody></table> </div> <footnotes> <p>Notice how <strong>asking</strong> for a <code>Fn</code> closure as a function is most restrictive for the caller; but <strong>having</strong> a <code>Fn</code> closure as a caller is most compatible with any function.</p> </footnotes> <div>&nbsp;</div> <p>From the perspective of someone defining a closure:</p> <div class="color-header green"> <table><thead><tr><th>Closure</th><th>Implements<sup>*</sup></th><th>Comment</th></tr></thead><tbody> <tr><td><code> || { moved_s; } </code></td><td><code>FnOnce</code></td><td>Caller must give up ownership of <code>moved_s</code>.</td></tr> <tr><td><code> || { &amp;mut s; } </code></td><td><code>FnOnce</code>, <code>FnMut</code></td><td>Allows <code>g()</code> to change caller's local state <code>s</code>.</td></tr> <tr><td><code> || { &amp;s; } </code></td><td><code>FnOnce</code>, <code>FnMut</code>, <code>Fn</code></td><td>May not mutate state; but can share and reuse <code>s</code>.</td></tr> </tbody></table> </div> <div class="footnotes"> <p><sup>*</sup> Rust <a href="https://doc.rust-lang.org/stable/reference/expressions/closure-expr.html">prefers capturing</a> by reference (resulting in the most &quot;compatible&quot; <code>Fn</code> closures from a caller perspective), but can be forced to capture its environment by copy or move via the <code>move || {}</code> syntax.</p> </div> <div>&nbsp;</div> <p>That gives the following advantages and disadvantages:</p> <div class="color-header green"> <table><thead><tr><th>Requiring</th><th>Advantage</th><th>Disadvantage</th></tr></thead><tbody> <tr><td><code>F: FnOnce</code></td><td><span class="good">Easy to satisfy as caller.</span></td><td><span class="bad">Single use only, <code>g()</code> may call <code>f()</code> just once.</span></td></tr> <tr><td><code>F: FnMut</code></td><td><span class="good">Allows <code>g()</code> to change caller state.</span></td><td><span class="bad">Caller may not reuse captures during <code>g()</code>.</span></td></tr> <tr><td><code>F: Fn</code></td><td><span class="good">Many can exist at same time.</span></td><td><span class="bad">Hardest to produce for caller.</span></td></tr> </tbody></table> </div> <div>&nbsp;</div>  <h2 id="unsafe-unsound-undefined">Unsafe, Unsound, Undefined<sup id="target-unsafe-unsound-undefined" class="target"><a href="#unsafe-unsound-undefined">url</a></sup></h2> <p>Unsafe leads to unsound. Unsound leads to undefined. Undefined leads to the dark side of the force.</p> <tabs>  <tab> <input type="radio" id="tab-unsafe-1" name="tab-unsafe" checked> <label for="tab-unsafe-1"><b>Unsafe Code</b></label> <panel><div> <p><strong>Unsafe Code</strong></p> <ul> <li>Code marked <code>unsafe</code> has special permissions, e.g., to deref raw pointers, or invoke other <code>unsafe</code> functions.</li> <li>Along come special <strong>promises the author <em>must</em> uphold to the compiler</strong>, and the compiler <em>will</em> trust you.</li> <li>By itself <code>unsafe</code> code is not bad, but dangerous, and needed for FFI or exotic data structures.</li> </ul> <div style="overflow:auto"> <div style="min-width:100%;width:650px"> <pre data-lang="rust" class="language-rust"><code class="language-rust" data-lang="rust">&#x2F;&#x2F; `x` must always point to race-free, valid, aligned, initialized u8 memory.
unsafe fn unsafe_f(x: *mut u8) {
    my_native_lib(x);
}
</code></pre> </div></div></div></panel></tab>  <tab> <input type="radio" id="tab-unsafe-2" name="tab-unsafe"> <label for="tab-unsafe-2"><b>Undefined Behavior</b></label> <panel><div> <p><strong>Undefined Behavior (UB)</strong></p> <ul> <li>As mentioned, <code>unsafe</code> code implies <a href="https://doc.rust-lang.org/stable/reference/behavior-considered-undefined.html">special promises</a> to the compiler (it wouldn't need be <code>unsafe</code> otherwise).</li> <li>Failure to uphold any promise makes compiler produce fallacious code, execution of which leads to UB.</li> <li>After triggering undefined behavior <em>anything</em> can happen. Insidiously, the effects may be 1) subtle, 2) manifest far away from the site of violation or 3) be visible only under certain conditions.</li> <li>A seemingly <em>working</em> program (incl. any number of unit tests) is no proof UB code might not fail on a whim.</li> <li>Code with UB is objectively dangerous, invalid and should never exist.</li> </ul> <div style="overflow:auto"> <div style="min-width:100%;width:650px"> <pre data-lang="rust" class="language-rust"><code class="language-rust" data-lang="rust">if should_be_true() {
   let r: &amp;u8 = unsafe { &amp;*ptr::null() };    &#x2F;&#x2F; Once this runs, ENTIRE app is undefined. Even if
} else {                                     &#x2F;&#x2F; line seemingly didn&#x27;t do anything, app might now run
    println!(&quot;the spanish inquisition&quot;);     &#x2F;&#x2F; both paths, corrupt database, or anything else.
}
</code></pre> </div></div></div></panel></tab>  <tab> <input type="radio" id="tab-unsafe-3" name="tab-unsafe"> <label for="tab-unsafe-3"><b>Unsound Code</b></label> <panel><div> <p><strong>Unsound Code</strong></p> <ul> <li>Any <em>safe</em> Rust that could (even only theoretically) produce UB for any user input is always <strong>unsound</strong>.</li> <li>As is <code>unsafe</code> code that may invoke UB on its own accord by violating above-mentioned promises.</li> <li>Unsound code is a stability and security risk, and violates basic assumption many Rust users have.</li> </ul> <div style="overflow:auto"> <div style="min-width:100%;width:650px"> <pre data-lang="rust" class="language-rust"><code class="language-rust" data-lang="rust">fn unsound_ref&lt;T&gt;(x: &amp;T) -&gt; &amp;u128 {      &#x2F;&#x2F; Signature looks safe to users. Happens to be
    unsafe { mem::transmute(x) }         &#x2F;&#x2F; ok if invoked with an &amp;u128, UB for practically
}                                        &#x2F;&#x2F; everything else.
</code></pre> </div></div></div></panel></tab> </tabs> <div>&nbsp;</div> <blockquote> <p><strong>Responsible use of Unsafe</strong> <sup>💬</sup></p> <ul> <li>Do not use <code>unsafe</code> unless you absolutely have to.</li> <li>Follow the <a href="https://doc.rust-lang.org/nightly/nomicon/">Nomicon</a>, <a href="https://rust-lang.github.io/unsafe-code-guidelines/">Unsafe Guidelines</a>, <strong>always</strong> uphold <strong>all</strong> safety invariants, and <strong>never</strong> invoke <a href="https://doc.rust-lang.org/stable/reference/behavior-considered-undefined.html">UB</a>.</li> <li>Minimize the use of <code>unsafe</code> and encapsulate it in small, sound modules that are easy to review.</li> <li>Never create unsound abstractions; if you can't encapsulate <code>unsafe</code> properly, don't do it.</li> <li>Each <code>unsafe</code> unit should be accompanied by plain-text reasoning outlining its safety.</li> </ul> </blockquote> <div>&nbsp;</div><h2 id="api-stability">API Stability<sup id="target-api-stability" class="target"><a href="#api-stability">url</a></sup></h2> <p>When updating an API, these changes can break client code.<a href="https://rust-lang.github.io/rfcs/1105-api-evolution.html"><sup class="expert">RFC</sup></a> Major changes (🔴) are <strong>definitely breaking</strong>, while minor changes (🟡) <strong>might be breaking</strong>:</p> <div class="api-stability color-header"> <div>&nbsp;</div><table><thead><tr><th>Crates</th></tr></thead><tbody> <tr><td>🔴 Making a crate that previously compiled for <em>stable</em> require <em>nightly</em>.</td></tr> <tr><td>🟡 Altering use of Cargo features (e.g., adding or removing features).</td></tr> </tbody></table> <div>&nbsp;</div><table><thead><tr><th>Modules</th></tr></thead><tbody> <tr><td>🔴 Renaming / moving / removing any public items.</td></tr> <tr><td>🟡 Adding new public items, as this might break code that does <code>use your_crate::*</code>.</td></tr> </tbody></table> <div>&nbsp;</div><table><thead><tr><th>Structs</th></tr></thead><tbody> <tr><td>🔴 Adding private field when all current fields public.</td></tr> <tr><td>🔴 Adding public field when no private field exists.</td></tr> <tr><td>🟡 Adding or removing private fields when at least one already exists (before and after the change).</td></tr> <tr><td>🟡 Going from a tuple struct with all private fields (with at least one field) to a normal struct, or vice versa.</td></tr> </tbody></table> <div>&nbsp;</div><table><thead><tr><th>Enums</th></tr></thead><tbody> <tr><td>🔴 Adding new variants; can be mitigated with early <code>#[non_exhaustive]</code> <a href="https://rustwiki.org/zh-CN/reference/attributes&#x2F;type_system.html#the-non_exhaustive-attribute"><sup class="expert">REF</sup></a></td></tr> <tr><td>🔴 Adding new fields to a variant.</td></tr> </tbody></table> <div>&nbsp;</div><table><thead><tr><th>Traits</th></tr></thead><tbody> <tr><td>🔴 Adding a non-defaulted item, breaks all existing <code>impl T for S {}</code>.</td></tr> <tr><td>🔴 Any non-trivial change to item signatures, will affect either consumers or implementors.</td></tr> <tr><td>🟡 Adding a defaulted item; might cause dispatch ambiguity with other existing trait.</td></tr> <tr><td>🟡 Adding a defaulted type parameter.</td></tr> </tbody></table> <div>&nbsp;</div><table><thead><tr><th>Traits</th></tr></thead><tbody> <tr><td>🔴 Implementing any &quot;fundamental&quot; trait, as <em>not</em> implementing a fundamental trait already was a promise.</td></tr> <tr><td>🟡 Implementing any non-fundamental trait; might also cause dispatch ambiguity.</td></tr> </tbody></table> <div>&nbsp;</div><table><thead><tr><th>Inherent Implementations</th></tr></thead><tbody> <tr><td>🟡 Adding any inherent items; might cause clients to prefer that over trait fn and produce compile error.</td></tr> </tbody></table> <div>&nbsp;</div><table><thead><tr><th>Signatures in Type Definitions</th></tr></thead><tbody> <tr><td>🔴 Tightening bounds (e.g., <code>&lt;T&gt;</code> to <code>&lt;T: Clone&gt;</code>).</td></tr> <tr><td>🟡 Loosening bounds.</td></tr> <tr><td>🟡 Adding defaulted type parameters.</td></tr> <tr><td>🟡 Generalizing to generics.</td></tr> </tbody></table> <table><thead><tr><th>Signatures in Functions</th></tr></thead><tbody> <tr><td>🔴 Adding / removing arguments.</td></tr> <tr><td>🟡 Introducing a new type parameter.</td></tr> <tr><td>🟡 Generalizing to generics.</td></tr> </tbody></table> <div>&nbsp;</div><table><thead><tr><th>Behavioral Changes</th></tr></thead><tbody> <tr><td>🔴 / 🟡 <em>Changing semantics might not cause compiler errors, but might make clients do wrong thing.</em></td></tr> </tbody></table> </div> <div>&nbsp;</div>  <noprint> <hr> <h1 id="misc">Misc<sup id="target-misc" class="target"><a href="#misc">url</a></sup></h1> <h2 id="links-services">Links &amp; Services<sup id="target-links-services" class="target"><a href="#links-services">url</a></sup></h2> <p>These are other great guides and tables.</p> <div class="color-header lavender">  <table><thead><tr><th>Cheat Sheets</th><th>Description</th></tr></thead><tbody> <tr><td><a href="https://github.com/ctjhoa/rust-learning">Rust Learning⭐</a></td><td>Probably the best collection of links about learning Rust.</td></tr> <tr><td><a href="https://github.com/JasonShin/functional-programming-jargon.rs">Functional Jargon in Rust</a></td><td>A collection of functional programming jargon explained in Rust.</td></tr> <tr><td><a href="http://cosmic.mearie.org/2014/01/periodic-table-of-rust-types">Periodic Table of Types</a></td><td>How various types and references correlate.</td></tr> <tr><td><a href="https://rufflewind.com/img/rust-futures-cheatsheet.html">Futures</a></td><td>How to construct and work with futures.</td></tr> <tr><td><a href="https://danielkeep.github.io/itercheat_baked.html">Rust Iterator Cheat Sheet</a></td><td>Summary of iterator-related methods from <code>std::iter</code> and <code>itertools</code>.</td></tr> <tr><td><a href="https://upsuper.github.io/rust-cheatsheet/">Type-Based Rust Cheat Sheet</a></td><td>Lists common types and how they convert.</td></tr> </tbody></table> </div> <div>&nbsp;</div> <p>All major Rust books developed by the community.</p> <div class="color-header lavender">  <table><thead><tr><th>Books ️📚</th><th>Description</th></tr></thead><tbody> <tr><td><a href="https://doc.rust-lang.org/stable/book/">The Rust Programming Language</a></td><td>Standard introduction to Rust, <strong>start here if you are new</strong>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <a href="https://rust-lang.github.io/api-guidelines/">API Guidelines</a></td><td>How to write idiomatic and re-usable Rust.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <a href="https://rust-lang.github.io/async-book/">Asynchronous Programming</a> <sup>🚧</sup></td><td>Explains <code>async</code> code, <code>Futures</code>, ...</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <a href="https://rust-unofficial.github.io/patterns//">Design Patterns</a></td><td>Idioms, Patterns, Anti-Patterns.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <a href="https://doc.rust-lang.org/nightly/edition-guide/">Edition Guide</a></td><td>Working with Rust 2015, Rust 2018, and beyond.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <a href="https://rustc-dev-guide.rust-lang.org/index.html">Guide to Rustc Development</a></td><td>Explains how the compiler works internally.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <a href="https://veykril.github.io/tlborm/introduction.html">Little Book of Rust Macros</a></td><td>Community's collective knowledge of Rust macros.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <a href="https://doc.rust-lang.org/stable/reference/">Reference</a> <sup>🚧</sup></td><td>Reference of the Rust language.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <a href="https://rust-lang.github.io/rfcs/">RFC Book</a></td><td>Look up accepted RFCs and how they change the language.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <a href="https://nnethercote.github.io/perf-book/">Performance Book</a></td><td>Techniques to improve the speed and memory usage.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <a href="https://rust-lang-nursery.github.io/rust-cookbook/">Rust Cookbook</a></td><td>Collection of simple examples that demonstrate good practices.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <a href="https://dhghomon.github.io/easy_rust/Chapter_3.html">Rust in Easy English</a></td><td>Explains concepts in simplified English, <strong>good alternative start</strong>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <a href="https://www.chiark.greenend.org.uk/%7Eianmdlvl/rust-polyglot/index.html">Rust for the Polyglot Programmer</a></td><td>A guide for the experienced programmer.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <a href="https://doc.rust-lang.org/stable/rustdoc/">Rustdoc Book</a></td><td>Tips how to customize <code>cargo doc</code> and <code>rustdoc</code>.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <a href="https://doc.rust-lang.org/nomicon/">Rustonomicon</a></td><td>Dark Arts of Advanced and Unsafe Rust Programming.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <a href="https://rust-lang.github.io/unsafe-code-guidelines/">Unsafe Code Guidelines</a> <sup>🚧</sup></td><td>Concise information about writing <code>unsafe</code> code.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <a href="https://doc.rust-lang.org/unstable-book/index.html">Unstable Book</a></td><td>Information about unstable items, e.g, <code>#![feature(...)]</code>.</td></tr> <tr><td><a href="https://doc.rust-lang.org/cargo/">The Cargo Book</a></td><td>How to use <code>cargo</code> and write <code>Cargo.toml</code>.</td></tr> <tr><td><a href="https://rust-lang-nursery.github.io/cli-wg/">The CLI Book</a></td><td>Information about creating CLI tools.</td></tr> <tr><td><a href="https://docs.rust-embedded.org/book/intro/index.html">The Embedded Book</a></td><td>Working with embedded and <code>#![no_std]</code> devices.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <a href="https://docs.rust-embedded.org/embedonomicon/">The Embedonomicon</a></td><td>First <code>#![no_std]</code> from scratch on a Cortex-M.</td></tr> <tr><td><a href="https://rustwasm.github.io/docs/book/">The WebAssembly Book</a></td><td>Working with the web and producing <code>.wasm</code> files.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <a href="https://rustwasm.github.io/docs/wasm-bindgen/">The <code>wasm-bindgen</code> Guide</a></td><td>How to bind Rust and JavaScript APIs in particular.</td></tr> </tbody></table> </div> <footnotes> <p>For more inofficial books see <a href="https://lborb.github.io/book/title-page.html">Little Book of Rust Books</a>.</p> </footnotes>   <div>&nbsp;</div> <p>Comprehensive lookup tables for common components.</p> <div class="color-header lavender">  <table><thead><tr><th>Tables 📋</th><th>Description</th></tr></thead><tbody> <tr><td><a href="https://github.com/rust-lang/rust/blob/master/RELEASES.md">Rust Changelog</a></td><td>See all the things that changed in a particular version.</td></tr> <tr><td><a href="https://forge.rust-lang.org/">Rust Forge</a></td><td>Lists release train and links for people working on the compiler.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <a href="https://doc.rust-lang.org/rustc/platform-support.html">Rust Platform Support</a></td><td>All supported platforms and their Tier.</td></tr> <tr><td><span class="hidemobile">&nbsp;&nbsp;&nbsp;&nbsp;</span> <a href="https://rust-lang.github.io/rustup-components-history/">Rust Component History</a></td><td>Check <strong>nightly</strong> status of various Rust tools for a platform.</td></tr> <tr><td><a href="https://rust-lang.github.io/rust-clippy/master/">ALL the Clippy Lints</a></td><td>All the <a href="https://github.com/rust-lang/rust-clippy"><strong>clippy</strong></a> lints you might be interested in.</td></tr> <tr><td><a href="https://rust-lang.github.io/rustfmt/">Configuring Rustfmt</a></td><td>All <a href="https://github.com/rust-lang/rustfmt"><strong>rustfmt</strong></a> options you can use in <code>.rustfmt.toml</code>.</td></tr> <tr><td><a href="https://doc.rust-lang.org/error-index.html">Compiler Error Index</a></td><td>Ever wondered what <code>E0404</code> means?</td></tr> </tbody></table> </div> <div>&nbsp;</div> <p>Online services which provide information or tooling.</p> <div class="color-header lavender">  <table><thead><tr><th>Services ⚙️</th><th>Description</th></tr></thead><tbody> <tr><td><a href="https://crates.io/">crates.io</a></td><td>All 3<sup>rd</sup> party libraries for Rust.</td></tr> <tr><td><a href="https://std.rs/">std.rs</a></td><td>Shortcut to <code>std</code> documentation.</td></tr> <tr><td><a href="https://docs.rs/">docs.rs</a></td><td>Documentation for 3<sup>rd</sup> party libraries, automatically generated from source.</td></tr> <tr><td><a href="https://lib.rs/">lib.rs</a></td><td>Unofficial overview of quality Rust libraries and applications.</td></tr> <tr><td><a href="https://caniuse.rs/">caniuse.rs</a></td><td>Check which Rust version introduced or stabilized a feature.</td></tr> <tr><td><a href="https://play.rust-lang.org/">Rust Playground</a></td><td>Try and share snippets of Rust code.</td></tr> <tr><td><a href="https://rust.extension.sh/">Rust Search Extension</a></td><td>Browser extension to search docs, crates, attributes, books, …</td></tr> </tbody></table> </div> <div>&nbsp;</div><h2 id="printing-pdf">Printing &amp; PDF<sup id="target-printing-pdf" class="target"><a href="#printing-pdf">url</a></sup></h2> <blockquote> <p>Want this Rust cheat sheet as a PDF? Download the <a href="https://s3.eu-central-1.amazonaws.com/cheats.rs/rust_cheat_sheet.pdf"><b>latest PDF here</b></a>. Alternatively, generate it yourself via <i>File &gt; Print</i> and then &quot;Save as PDF&quot; (works great in Chrome, has some issues in Firefox).</p> </blockquote> </noprint> <footer> <p><a href="https://xr.io">Ralf Biedert</a>, 2022 – <a href="https://cheats.rs">cheats.rs</a></p> <noprint> <p><a href="legal">Legal &amp; Privacy</a></p> </noprint> </footer> </div> </div> </div>     <script type="text/javascript">var _self="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},Prism=function(e){var t=/\blang(?:uage)?-([\w-]+)\b/i,n=0,a={manual:e.Prism&&e.Prism.manual,disableWorkerMessageHandler:e.Prism&&e.Prism.disableWorkerMessageHandler,util:{encode:function e(t){return t instanceof o?new o(t.type,e(t.content),t.alias):Array.isArray(t)?t.map(e):t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).slice(8,-1)},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++n}),e.__id},clone:function e(t,n){var o,r;switch(n=n||{},a.util.type(t)){case"Object":if(r=a.util.objId(t),n[r])return n[r];for(var l in o={},n[r]=o,t)t.hasOwnProperty(l)&&(o[l]=e(t[l],n));return o;case"Array":return r=a.util.objId(t),n[r]?n[r]:(o=[],n[r]=o,t.forEach((function(t,a){o[a]=e(t,n)})),o);default:return t}},getLanguage:function(e){for(;e&&!t.test(e.className);)e=e.parentElement;return e?(e.className.match(t)||[,"none"])[1].toLowerCase():"none"},currentScript:function(){if("undefined"==typeof document)return null;if("currentScript"in document)return document.currentScript;try{throw new Error}catch(a){var e=(/at [^(\r\n]*\((.*):.+:.+\)$/i.exec(a.stack)||[])[1];if(e){var t=document.getElementsByTagName("script");for(var n in t)if(t[n].src==e)return t[n]}return null}},isActive:function(e,t,n){for(var a="no-"+t;e;){var o=e.classList;if(o.contains(t))return!0;if(o.contains(a))return!1;e=e.parentElement}return!!n}},languages:{extend:function(e,t){var n=a.util.clone(a.languages[e]);for(var o in t)n[o]=t[o];return n},insertBefore:function(e,t,n,o){var r=(o=o||a.languages)[e],l={};for(var s in r)if(r.hasOwnProperty(s)){if(s==t)for(var i in n)n.hasOwnProperty(i)&&(l[i]=n[i]);n.hasOwnProperty(s)||(l[s]=r[s])}var d=o[e];return o[e]=l,a.languages.DFS(a.languages,(function(t,n){n===d&&t!=e&&(this[t]=l)})),l},DFS:function e(t,n,o,r){r=r||{};var l=a.util.objId;for(var s in t)if(t.hasOwnProperty(s)){n.call(t,s,t[s],o||s);var i=t[s],d=a.util.type(i);"Object"!==d||r[l(i)]?"Array"!==d||r[l(i)]||(r[l(i)]=!0,e(i,n,s,r)):(r[l(i)]=!0,e(i,n,null,r))}}},plugins:{},highlightAll:function(e,t){a.highlightAllUnder(document,e,t)},highlightAllUnder:function(e,t,n){var o={callback:n,container:e,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};a.hooks.run("before-highlightall",o),o.elements=Array.prototype.slice.apply(o.container.querySelectorAll(o.selector)),a.hooks.run("before-all-elements-highlight",o);for(var r,l=0;r=o.elements[l++];)a.highlightElement(r,!0===t,o.callback)},highlightElement:function(n,o,r){var l=a.util.getLanguage(n),s=a.languages[l];n.className=n.className.replace(t,"").replace(/\s+/g," ")+" language-"+l;var i=n.parentElement;i&&"pre"===i.nodeName.toLowerCase()&&(i.className=i.className.replace(t,"").replace(/\s+/g," ")+" language-"+l);var d={element:n,language:l,grammar:s,code:n.textContent};function c(e){d.highlightedCode=e,a.hooks.run("before-insert",d),d.element.innerHTML=d.highlightedCode,a.hooks.run("after-highlight",d),a.hooks.run("complete",d),r&&r.call(d.element)}if(a.hooks.run("before-sanity-check",d),!d.code)return a.hooks.run("complete",d),void(r&&r.call(d.element));if(a.hooks.run("before-highlight",d),d.grammar)if(o&&e.Worker){var u=new Worker(a.filename);u.onmessage=function(e){c(e.data)},u.postMessage(JSON.stringify({language:d.language,code:d.code,immediateClose:!0}))}else c(a.highlight(d.code,d.grammar,d.language));else c(a.util.encode(d.code))},highlight:function(e,t,n){var r={code:e,grammar:t,language:n};return a.hooks.run("before-tokenize",r),r.tokens=a.tokenize(r.code,r.grammar),a.hooks.run("after-tokenize",r),o.stringify(a.util.encode(r.tokens),r.language)},tokenize:function(e,t){var n=t.rest;if(n){for(var i in n)t[i]=n[i];delete t.rest}var d=new r;return l(d,d.head,e),function e(t,n,r,i,d,c){for(var u in r)if(r.hasOwnProperty(u)&&r[u]){var p=r[u];p=Array.isArray(p)?p:[p];for(var f=0;f<p.length;++f){if(c&&c.cause==u+","+f)return;var g=p[f],m=g.inside,h=!!g.lookbehind,b=!!g.greedy,y=0,_=g.alias;if(b&&!g.pattern.global){var S=g.pattern.toString().match(/[imsuy]*$/)[0];g.pattern=RegExp(g.pattern.source,S+"g")}for(var k=g.pattern||g,v=i.next,E=d;v!==n.tail&&!(c&&E>=c.reach);E+=v.value.length,v=v.next){var A=v.value;if(n.length>t.length)return;if(!(A instanceof o)){var T=1;if(b&&v!=n.tail.prev){if(k.lastIndex=E,!(O=k.exec(t)))break;var w=O.index+(h&&O[1]?O[1].length:0),I=O.index+O[0].length,x=E;for(x+=v.value.length;x<=w;)x+=(v=v.next).value.length;if(E=x-=v.value.length,v.value instanceof o)continue;for(var N=v;N!==n.tail&&(x<I||"string"==typeof N.value);N=N.next)T++,x+=N.value.length;T--,A=t.slice(E,x),O.index-=E}else{k.lastIndex=0;var O=k.exec(A)}if(O){h&&(y=O[1]?O[1].length:0);w=O.index+y;var P=O[0].slice(y),R=(I=w+P.length,A.slice(0,w)),L=A.slice(I),M=E+A.length;c&&M>c.reach&&(c.reach=M);var D=v.prev;R&&(D=l(n,D,R),E+=R.length),s(n,D,T),v=l(n,D,new o(u,m?a.tokenize(P,m):P,_,P)),L&&l(n,v,L),1<T&&e(t,n,r,v.prev,E,{cause:u+","+f,reach:M})}}}}}}(e,d,t,d.head,0),function(e){for(var t=[],n=e.head.next;n!==e.tail;)t.push(n.value),n=n.next;return t}(d)},hooks:{all:{},add:function(e,t){var n=a.hooks.all;n[e]=n[e]||[],n[e].push(t)},run:function(e,t){var n=a.hooks.all[e];if(n&&n.length)for(var o,r=0;o=n[r++];)o(t)}},Token:o};function o(e,t,n,a){this.type=e,this.content=t,this.alias=n,this.length=0|(a||"").length}function r(){var e={value:null,prev:null,next:null},t={value:null,prev:e,next:null};e.next=t,this.head=e,this.tail=t,this.length=0}function l(e,t,n){var a=t.next,o={value:n,prev:t,next:a};return t.next=o,a.prev=o,e.length++,o}function s(e,t,n){for(var a=t.next,o=0;o<n&&a!==e.tail;o++)a=a.next;(t.next=a).prev=t,e.length-=o}if(e.Prism=a,o.stringify=function e(t,n){if("string"==typeof t)return t;if(Array.isArray(t)){var o="";return t.forEach((function(t){o+=e(t,n)})),o}var r={type:t.type,content:e(t.content,n),tag:"span",classes:["token",t.type],attributes:{},language:n},l=t.alias;l&&(Array.isArray(l)?Array.prototype.push.apply(r.classes,l):r.classes.push(l)),a.hooks.run("wrap",r);var s="";for(var i in r.attributes)s+=" "+i+'="'+(r.attributes[i]||"").replace(/"/g,"&quot;")+'"';return"<"+r.tag+' class="'+r.classes.join(" ")+'"'+s+">"+r.content+"</"+r.tag+">"},!e.document)return e.addEventListener&&(a.disableWorkerMessageHandler||e.addEventListener("message",(function(t){var n=JSON.parse(t.data),o=n.language,r=n.code,l=n.immediateClose;e.postMessage(a.highlight(r,a.languages[o],o)),l&&e.close()}),!1)),a;var i=a.util.currentScript();function d(){a.manual||a.highlightAll()}if(i&&(a.filename=i.src,i.hasAttribute("data-manual")&&(a.manual=!0)),!a.manual){var c=document.readyState;"loading"===c||"interactive"===c&&i&&i.defer?document.addEventListener("DOMContentLoaded",d):window.requestAnimationFrame?window.requestAnimationFrame(d):window.setTimeout(d,16)}return a}(_self);"undefined"!=typeof module&&module.exports&&(module.exports=Prism),"undefined"!=typeof global&&(global.Prism=Prism),function(e){var t="\\b(?:BASH|BASHOPTS|BASH_ALIASES|BASH_ARGC|BASH_ARGV|BASH_CMDS|BASH_COMPLETION_COMPAT_DIR|BASH_LINENO|BASH_REMATCH|BASH_SOURCE|BASH_VERSINFO|BASH_VERSION|COLORTERM|COLUMNS|COMP_WORDBREAKS|DBUS_SESSION_BUS_ADDRESS|DEFAULTS_PATH|DESKTOP_SESSION|DIRSTACK|DISPLAY|EUID|GDMSESSION|GDM_LANG|GNOME_KEYRING_CONTROL|GNOME_KEYRING_PID|GPG_AGENT_INFO|GROUPS|HISTCONTROL|HISTFILE|HISTFILESIZE|HISTSIZE|HOME|HOSTNAME|HOSTTYPE|IFS|INSTANCE|JOB|LANG|LANGUAGE|LC_ADDRESS|LC_ALL|LC_IDENTIFICATION|LC_MEASUREMENT|LC_MONETARY|LC_NAME|LC_NUMERIC|LC_PAPER|LC_TELEPHONE|LC_TIME|LESSCLOSE|LESSOPEN|LINES|LOGNAME|LS_COLORS|MACHTYPE|MAILCHECK|MANDATORY_PATH|NO_AT_BRIDGE|OLDPWD|OPTERR|OPTIND|ORBIT_SOCKETDIR|OSTYPE|PAPERSIZE|PATH|PIPESTATUS|PPID|PS1|PS2|PS3|PS4|PWD|RANDOM|REPLY|SECONDS|SELINUX_INIT|SESSION|SESSIONTYPE|SESSION_MANAGER|SHELL|SHELLOPTS|SHLVL|SSH_AUTH_SOCK|TERM|UID|UPSTART_EVENTS|UPSTART_INSTANCE|UPSTART_JOB|UPSTART_SESSION|USER|WINDOWID|XAUTHORITY|XDG_CONFIG_DIRS|XDG_CURRENT_DESKTOP|XDG_DATA_DIRS|XDG_GREETER_DATA_DIR|XDG_MENU_PREFIX|XDG_RUNTIME_DIR|XDG_SEAT|XDG_SEAT_PATH|XDG_SESSION_DESKTOP|XDG_SESSION_ID|XDG_SESSION_PATH|XDG_SESSION_TYPE|XDG_VTNR|XMODIFIERS)\\b",n={environment:{pattern:RegExp("\\$"+t),alias:"constant"},variable:[{pattern:/\$?\(\([\s\S]+?\)\)/,greedy:!0,inside:{variable:[{pattern:/(^\$\(\([\s\S]+)\)\)/,lookbehind:!0},/^\$\(\(/],number:/\b0x[\dA-Fa-f]+\b|(?:\b\d+\.?\d*|\B\.\d+)(?:[Ee]-?\d+)?/,operator:/--?|-=|\+\+?|\+=|!=?|~|\*\*?|\*=|\/=?|%=?|<<=?|>>=?|<=?|>=?|==?|&&?|&=|\^=?|\|\|?|\|=|\?|:/,punctuation:/\(\(?|\)\)?|,|;/}},{pattern:/\$\((?:\([^)]+\)|[^()])+\)|`[^`]+`/,greedy:!0,inside:{variable:/^\$\(|^`|\)$|`$/}},{pattern:/\$\{[^}]+\}/,greedy:!0,inside:{operator:/:[-=?+]?|[!\/]|##?|%%?|\^\^?|,,?/,punctuation:/[\[\]]/,environment:{pattern:RegExp("(\\{)"+t),lookbehind:!0,alias:"constant"}}},/\$(?:\w+|[#?*!@$])/],entity:/\\(?:[abceEfnrtv\\"]|O?[0-7]{1,3}|x[0-9a-fA-F]{1,2}|u[0-9a-fA-F]{4}|U[0-9a-fA-F]{8})/};e.languages.bash={shebang:{pattern:/^#!\s*\/.*/,alias:"important"},comment:{pattern:/(^|[^"{\\$])#.*/,lookbehind:!0},"function-name":[{pattern:/(\bfunction\s+)\w+(?=(?:\s*\(?:\s*\))?\s*\{)/,lookbehind:!0,alias:"function"},{pattern:/\b\w+(?=\s*\(\s*\)\s*\{)/,alias:"function"}],"for-or-select":{pattern:/(\b(?:for|select)\s+)\w+(?=\s+in\s)/,alias:"variable",lookbehind:!0},"assign-left":{pattern:/(^|[\s;|&]|[<>]\()\w+(?=\+?=)/,inside:{environment:{pattern:RegExp("(^|[\\s;|&]|[<>]\\()"+t),lookbehind:!0,alias:"constant"}},alias:"variable",lookbehind:!0},string:[{pattern:/((?:^|[^<])<<-?\s*)(\w+?)\s*(?:\r?\n|\r)[\s\S]*?(?:\r?\n|\r)\2/,lookbehind:!0,greedy:!0,inside:n},{pattern:/((?:^|[^<])<<-?\s*)(["'])(\w+)\2\s*(?:\r?\n|\r)[\s\S]*?(?:\r?\n|\r)\3/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\](?:\\\\)*)(["'])(?:\\[\s\S]|\$\([^)]+\)|`[^`]+`|(?!\2)[^\\])*\2/,lookbehind:!0,greedy:!0,inside:n}],environment:{pattern:RegExp("\\$?"+t),alias:"constant"},variable:n.variable,function:{pattern:/(^|[\s;|&]|[<>]\()(?:add|apropos|apt|aptitude|apt-cache|apt-get|aspell|automysqlbackup|awk|basename|bash|bc|bconsole|bg|bzip2|cal|cat|cfdisk|chgrp|chkconfig|chmod|chown|chroot|cksum|clear|cmp|column|comm|composer|cp|cron|crontab|csplit|curl|cut|date|dc|dd|ddrescue|debootstrap|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|du|egrep|eject|env|ethtool|expand|expect|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|git|gparted|grep|groupadd|groupdel|groupmod|groups|grub-mkconfig|gzip|halt|head|hg|history|host|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|ip|jobs|join|kill|killall|less|link|ln|locate|logname|logrotate|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|lynx|make|man|mc|mdadm|mkconfig|mkdir|mke2fs|mkfifo|mkfs|mkisofs|mknod|mkswap|mmv|more|most|mount|mtools|mtr|mutt|mv|nano|nc|netstat|nice|nl|nohup|notify-send|npm|nslookup|op|open|parted|passwd|paste|pathchk|ping|pkill|pnpm|popd|pr|printcap|printenv|ps|pushd|pv|quota|quotacheck|quotactl|ram|rar|rcp|reboot|remsync|rename|renice|rev|rm|rmdir|rpm|rsync|scp|screen|sdiff|sed|sendmail|seq|service|sftp|sh|shellcheck|shuf|shutdown|sleep|slocate|sort|split|ssh|stat|strace|su|sudo|sum|suspend|swapon|sync|tac|tail|tar|tee|time|timeout|top|touch|tr|traceroute|tsort|tty|umount|uname|unexpand|uniq|units|unrar|unshar|unzip|update-grub|uptime|useradd|userdel|usermod|users|uudecode|uuencode|v|vdir|vi|vim|virsh|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yarn|yes|zenity|zip|zsh|zypper)(?=$|[)\s;|&])/,lookbehind:!0},keyword:{pattern:/(^|[\s;|&]|[<>]\()(?:if|then|else|elif|fi|for|while|in|case|esac|function|select|do|done|until)(?=$|[)\s;|&])/,lookbehind:!0},builtin:{pattern:/(^|[\s;|&]|[<>]\()(?:\.|:|break|cd|continue|eval|exec|exit|export|getopts|hash|pwd|readonly|return|shift|test|times|trap|umask|unset|alias|bind|builtin|caller|command|declare|echo|enable|help|let|local|logout|mapfile|printf|read|readarray|source|type|typeset|ulimit|unalias|set|shopt)(?=$|[)\s;|&])/,lookbehind:!0,alias:"class-name"},boolean:{pattern:/(^|[\s;|&]|[<>]\()(?:true|false)(?=$|[)\s;|&])/,lookbehind:!0},"file-descriptor":{pattern:/\B&\d\b/,alias:"important"},operator:{pattern:/\d?<>|>\||\+=|==?|!=?|=~|<<[<-]?|[&\d]?>>|\d?[<>]&?|&[>&]?|\|[&|]?|<=?|>=?/,inside:{"file-descriptor":{pattern:/^\d/,alias:"important"}}},punctuation:/\$?\(\(?|\)\)?|\.\.|[{}[\];\\]/,number:{pattern:/(^|\s)(?:[1-9]\d*|0)(?:[.,]\d+)?\b/,lookbehind:!0}};for(var a=["comment","function-name","for-or-select","assign-left","string","environment","function","keyword","builtin","boolean","file-descriptor","operator","punctuation","number"],o=n.variable[1].inside,r=0;r<a.length;r++)o[a[r]]=e.languages.bash[a[r]];e.languages.shell=e.languages.bash}(Prism),function(e){for(var t="/\\*(?:[^*/]|\\*(?!/)|/(?!\\*)|<self>)*\\*/",n=0;n<2;n++)t=t.replace(/<self>/g,(function(){return t}));t=t.replace(/<self>/g,(function(){return"[^\\s\\S]"})),e.languages.rust={comment:[{pattern:RegExp("(^|[^\\\\])"+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u{(?:[\da-fA-F]_*){1,6}|.)|[^\\\r\n\t'])'/,greedy:!0,alias:"string"},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|Self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:[ui](?:8|16|32|64|128|size)|f(?:32|64)|bool|char|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:\d(?:_?\d)*)?\.?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:[iu](?:8|16|32|64|size)?|f32|f64))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string}(Prism),function(e){function t(e){return e.replace(/__/g,(function(){return"(?:[\\w-]+|'[^'\n\r]*'|\"(?:\\\\.|[^\\\\\"\r\n])*\")"}))}Prism.languages.toml={comment:{pattern:/#.*/,greedy:!0},table:{pattern:RegExp(t("(^\\s*\\[\\s*(?:\\[\\s*)?)__(?:\\s*\\.\\s*__)*(?=\\s*\\])"),"m"),lookbehind:!0,greedy:!0,alias:"class-name"},key:{pattern:RegExp(t("(^\\s*|[{,]\\s*)__(?:\\s*\\.\\s*__)*(?=\\s*=)"),"m"),lookbehind:!0,greedy:!0,alias:"property"},string:{pattern:/"""(?:\\[\s\S]|[^\\])*?"""|'''[\s\S]*?'''|'[^'\n\r]*'|"(?:\\.|[^\\"\r\n])*"/,greedy:!0},date:[{pattern:/\b\d{4}-\d{2}-\d{2}(?:[T\s]\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|[+-]\d{2}:\d{2})?)?\b/i,alias:"number"},{pattern:/\b\d{2}:\d{2}:\d{2}(?:\.\d+)?\b/,alias:"number"}],number:/(?:\b0(?:x[\da-zA-Z]+(?:_[\da-zA-Z]+)*|o[0-7]+(?:_[0-7]+)*|b[10]+(?:_[10]+)*))\b|[-+]?\b\d+(?:_\d+)*(?:\.\d+(?:_\d+)*)?(?:[eE][+-]?\d+(?:_\d+)*)?\b|[-+]?\b(?:inf|nan)\b/,boolean:/\b(?:true|false)\b/,punctuation:/[.,=[\]{}]/}}(),"undefined"!=typeof self&&!self.Prism||"undefined"!=typeof global&&!global.Prism||Prism.hooks.add("wrap",(function(e){"keyword"===e.type&&e.classes.push("keyword-"+e.content)})),"undefined"!=typeof self&&self.Prism&&self.document&&document.createRange&&(Prism.plugins.KeepMarkup=!0,Prism.hooks.add("before-highlight",(function(e){if(e.element.children.length&&Prism.util.isActive(e.element,"keep-markup",!0)){var t=0,n=[],a=function(e,o){var r={};o||(r.clone=e.cloneNode(!1),r.posOpen=t,n.push(r));for(var l=0,s=e.childNodes.length;l<s;l++){var i=e.childNodes[l];1===i.nodeType?a(i):3===i.nodeType&&(t+=i.data.length)}o||(r.posClose=t)};a(e.element,!0),n&&n.length&&(e.keepMarkup=n)}})),Prism.hooks.add("after-highlight",(function(e){if(e.keepMarkup&&e.keepMarkup.length){var t=function(e,n){for(var a=0,o=e.childNodes.length;a<o;a++){var r=e.childNodes[a];if(1===r.nodeType){if(!t(r,n))return!1}else 3===r.nodeType&&(!n.nodeStart&&n.pos+r.data.length>n.node.posOpen&&(n.nodeStart=r,n.nodeStartPos=n.node.posOpen-n.pos),n.nodeStart&&n.pos+r.data.length>=n.node.posClose&&(n.nodeEnd=r,n.nodeEndPos=n.node.posClose-n.pos),n.pos+=r.data.length);if(n.nodeStart&&n.nodeEnd){var l=document.createRange();return l.setStart(n.nodeStart,n.nodeStartPos),l.setEnd(n.nodeEnd,n.nodeEndPos),n.node.clone.appendChild(l.extractContents()),l.insertNode(n.node.clone),l.detach(),!1}}return!0};e.keepMarkup.forEach((function(n){t(e.element,{node:n,pos:0})})),e.highlightedCode=e.element.innerHTML}})));const API_ENDPOINT="https://m1zur8nbrg.execute-api.eu-north-1.amazonaws.com",SURVEY_KEY="survey2020";let codes_rust=document.querySelectorAll("code:not(.ignore-auto)"),subtitle_index=0,all_tabs_expanded=!1;const SKIP_FIRST_N_SUBTITLES=2,subtitles=["2. 三月 2022","1cb520c","Same low price, 20% more content.","Recommended by 9 out of 10 dentists.","World's best cheat sheet according to its authors.","This site was tested on animals and got 4.5 stars.","Like Rust in a nutshell, for people with allergies.","All the things you ever wanted to know. And more.","A cargo-cult documentary.","Will the last person please switch on night mode?","A collaboration between Zoo Berlin and Olympia Typewriters.","Contains 140g of Rust per 100g of cheat sheet.","Prints best on Dunder Mifflin premium copy paper.","May contain R-rated content.","Your mission, should you choose to accept it: Put Rust on a Mars rover.",["This message will self-destruct in 5 seconds.",!1],["The self-destruct mechanism was written in JavaScript ...",!1],"Turned out the Señor Developer job wasn't much of a pay bump.","Testing Bekenstein's limit one entry a time.","The 7 naughty words you're not allowed to say on television:",["Undefined.",!1],["Runtime.",!1],["Inheritance.",!1],["Globals.",!1],["Unwrap.",!1],["Allocation.",!1],["RIIR ... (JK, we all just pretend we don't like that one.)",!1],"Good news is, after Rust, learning German will be <i>so</i> much easier.","Night mode is dark and full of errors.","^Z^Z^Z^Z^X^quit:help! ... how do I exit this thing?.","If it smells like rust and tastes like rust, it's probably not Rust.","In memoriam of the 1 Github star we lost April 1st, 2021. You will be missed.","The R in ASMR stands for Rust.","Chuck Norris doesn't fear concurrency. Concurrency fears Chuck Norris.","Teaching endianness since 1820.","Snugly fits two Bayeux tapestries.","If a programming language and a crab love each other very much ...","I, for one, welcome our new AI overlords.","As seen on interdimensional cable.","The catnip of cheat sheets.","I'm sure there's an X-File on the never type.","${jndi:ldap://rustup.rs}"],feedback_blacklist=["","behind-the-scenes","data-types","numeric-types-ref","textual-types-ref","standard-library","traits","tooling","coding-guides","misc"];function show_playground(e){let t=document.getElementById("hellostatic"),n=document.getElementById("helloplay"),a=document.getElementById("helloctrl"),o=document.getElementById("helloinfo");e?(t.style.display="none",o.style.display="block",n.innerHTML="<iframe src='https://play.rust-lang.org/' style='width:100%; height:500px;'></iframe>",a.innerHTML="<a href='javascript:show_playground(false);'>⏹️ Stop Editor</a>"):(t.style.display="block",o.style.display="none",n.innerHTML="",a.innerHTML="<a href='javascript:show_playground(true);'>▶️ Edit & Run</a>")}function get_browser_night_mode(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"night":"day"}function set_body_night_mode(e){let t=document.getElementsByTagName("body")[0];"night"===e?(t.classList.add("night-mode"),t.classList.remove("day-mode")):(t.classList.remove("night-mode"),t.classList.add("day-mode"))}function toggle_night_mode(){let e=storage_get("night-mode")||get_browser_night_mode();e="night"===e?"day":"night",storage_set("night-mode",e),set_body_night_mode(e)}function toggle_ligatures(){let e;document.getElementsByTagName("body")[0];"common-ligatures"===codes_rust[0].style.fontVariantLigatures?(e="none",storage_set("ligatures","no-ligatures")):(e="common-ligatures",storage_set("ligatures","ligatures")),codes_rust.forEach((t=>{t.style.fontVariantLigatures=e}))}function toggle_legend(){let e=document.querySelectorAll("symbol-legend.short")[0],t=document.querySelectorAll("symbol-legend.long")[0],n=document.querySelectorAll("blockquote.legend div a")[0];""==e.style.display||"block"==e.style.display?(e.style.display="none",t.style.display="block",n.text="➖"):(e.style.display="block",t.style.display="none",n.text="➕")}function toggle_expand_all(){let e=document.getElementById("expand_everything");if(all_tabs_expanded){let t=document.querySelectorAll("tab");for(let e of t)e.style.display="";let n=document.querySelectorAll("tab > panel");for(let e of n)e.style.display="";let a=document.querySelectorAll("tab > label");for(let e of a)e.style.display="",e.style.cursor="",e.style.marginTop="";let o=document.querySelectorAll("tab > input");for(let e of o)e.checked=!0;let r=document.querySelectorAll("lifetime-section > explanation");for(let e of r)e.style.display="none";let l=document.querySelectorAll("generics-section > description");for(let e of l)e.style.display="none";storage_set("expand_everything","false"),e.innerHTML="Expand all the things?",all_tabs_expanded=!1}else{let t=document.querySelectorAll("tab");for(let e of t)e.style.display="block";let n=document.querySelectorAll("tab > panel");for(let e of n)e.style.display="initial";let a=document.querySelectorAll("tab > label");for(let e of a)e.style.display="inline-block",e.style.cursor="initial",e.style.marginTop="10px";let o=document.querySelectorAll("tab > input");for(let e of o)e.checked=!1;let r=document.querySelectorAll("lifetime-section > explanation");for(let e of r)e.style.display="inherit";let l=document.querySelectorAll("generics-section > description");for(let e of l)e.style.display="inherit";storage_set("expand_everything","true"),e.innerHTML="Expanded ALL the things! <flip>🧹</flip>",all_tabs_expanded=!0}}function storage_set(e,t){localStorage&&localStorage.setItem(e,t)}function storage_get(e){return!!localStorage&&localStorage.getItem(e)}function set_survey(e){let t=document.getElementsByClassName("survey");for(let n of t)n.style.display=e;storage_set(SURVEY_KEY,e)}function advance_subtitle(e){let t=document.getElementById("subtitle"),n="UNDEFINED";if(e)n=subtitles[e],subtitle_index=e;else{let e=(subtitle_index+1)%subtitles.length;n=subtitles[e],!1===n[1]?(subtitle_index=e,n=n[0]):(e%=2,subtitle_index=e,n=subtitles[e])}t.innerHTML=n}function random_quote(){let e=!1;for(;!1===e;){let t=Math.random();e=2+Math.floor((subtitles.length-2)*t),!1===subtitles[e][1]&&(e=!1)}advance_subtitle(e)}function feedback_post(e,t,n){let a=new XMLHttpRequest;a.open("POST",API_ENDPOINT+e,!0),a.setRequestHeader("Content-Type","application/json; charset=UTF-8"),a.send(JSON.stringify(t)),a.onerror=e=>{n&&n("error")},a.onload=e=>{n&&n()}}function feedback_send_detailed(e){let t=document.getElementById(e),n=t.getAttribute("element-id"),a=t.querySelectorAll("textarea")[0];feedback_post("/feedback/detail",{text:a.value,section:n},(e=>{let n=t.querySelectorAll("result")[0];e?(n.innerHTML="Failed",n.style.color="red"):(a.value=null,n.innerHTML="Success",n.style.color="green",n.style.left="40px",n.style.opacity="0.0",setTimeout((()=>{n.innerHTML="",n.style.color="black",n.style.left="0px",n.style.opacity="1.0"}),500))}))}function feedback_send_mood(e,t){let n=document.getElementById(t),a=n.getAttribute("element-id"),o=n.querySelectorAll(`feedback-button.${e} feedback-feedback`)[0];o.style.visibility="inherit",o.style.top="-3em",o.style.opacity="0.0",feedback_post("/feedback/mood",{mood:e,section:a}),setTimeout((()=>{o.style.visibility="hidden",o.style.top="-0.5em",o.style.opacity="0.5"}),300)}function feedback_detail_visibility(e,t){document.getElementById(e).querySelectorAll("feedback-form")[0].style.display=t}function feedback_quick_submit(e){event.ctrlKey&&13==event.keyCode&&feedback_send_detailed(e)}function feedback_attach_buttons(e){for(let t of e){let e=document.getElementsByTagName(t);for(let t of e){let e=t.id,n="feedback-"+e,a=document.createElement("feedback");feedback_blacklist.includes(e)||(a.setAttribute("element-id",e),a.id=n,a.innerHTML=`\n                <button-row>\n                    <feedback-button class="good" onmouseover="feedback_detail_visibility('${n}', 'none')" onclick="javascript:feedback_send_mood('good', '${n}');"><feedback-feedback>💗</feedback-feedback><the-button>😊</the-button></feedback-button>\n                    <feedback-button class="bad" onmouseover="feedback_detail_visibility('${n}', 'none')" onclick="javascript:feedback_send_mood('bad', '${n}');"><feedback-feedback>💩</feedback-feedback><the-button>👿</the-button></feedback-button>\n                    <feedback-button onmouseover="feedback_detail_visibility('${n}', 'inherit')"><the-button>✏️</the-button></feedback-button>\n                </button-row>\n                <feedback-form>\n                    <textarea maxlength="2048" onkeydown="javascript:feedback_quick_submit('${n}', this);" placeholder="Tell us more!"></textarea>\n                    <hint>See <a href="/legal">privacy policy</a>; also <b>CTRL-ENTER</b> submits. </hint>\n                    <controls>\n                        <result></result>\n                        <a href="javascript:feedback_send_detailed('${n}');">Submit</a>\n                    </controls>\n                </feedback-form>\n            `,a.onmouseleave=()=>{setTimeout((()=>{document.querySelectorAll(`#${n}:hover`).length>0||feedback_detail_visibility(n,"none")}),150)},t.appendChild(a))}}}function memory_bars_expand_on_click(){let e=document.querySelectorAll("memory-row");for(let t of e)t.onclick=e=>{let t=e.target.closest("lifetime-section").getElementsByTagName("explanation")[0];t&&(t.style.display&&"none"!=t.style.display?t.style.display="none":t.style.display="inherit")}}function generics_section_expand_on_click(){let e=document.querySelectorAll("generics-section > header");for(let t of e)t.onclick=e=>{let n=t.parentElement.querySelector("description");n.style.display&&"none"!=n.style.display?(console.log(2),n.style.display="none"):(console.log(1),n.style.display="inherit")}}codes_rust.forEach((e=>{e.className="language-rust"})),window.onload=()=>{try{if("#_print"==window.location.hash)toggle_ligatures(),toggle_expand_all(),set_body_night_mode("day");else{let e=storage_get("ligatures"),t=storage_get("expand_everything"),n=storage_get("night-mode")||get_browser_night_mode();feedback_attach_buttons(["h2","h3","h4"]),Math.random()<.15&&random_quote(),"ligatures"===e&&toggle_ligatures(),"true"===t&&toggle_expand_all(),set_body_night_mode(n),memory_bars_expand_on_click(),generics_section_expand_on_click()}}catch(e){console.log(e)}};</script> </body></html>